(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))m(v);new MutationObserver(v=>{for(const b of v)if(b.type==="childList")for(const y of b.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&m(y)}).observe(document,{childList:!0,subtree:!0});function f(v){const b={};return v.integrity&&(b.integrity=v.integrity),v.referrerPolicy&&(b.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?b.credentials="include":v.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function m(v){if(v.ep)return;v.ep=!0;const b=f(v);fetch(v.href,b)}})();function vt(){}function Bs(l,t){for(const f in t)l[f]=t[f];return l}function cr(l){return l()}function $i(){return Object.create(null)}function Pt(l){l.forEach(cr)}function Ze(l){return typeof l=="function"}function xt(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let He;function Be(l,t){return He||(He=document.createElement("a")),He.href=t,l===He.href}function Rs(l){return Object.keys(l).length===0}function Wi(l,...t){if(l==null)return vt;const f=l.subscribe(...t);return f.unsubscribe?()=>f.unsubscribe():f}function Pe(l){let t;return Wi(l,f=>t=f)(),t}function kt(l,t,f){l.$$.on_destroy.push(Wi(t,f))}function Re(l,t,f,m){if(l){const v=hr(l,t,f,m);return l[0](v)}}function hr(l,t,f,m){return l[1]&&m?Bs(f.ctx.slice(),l[1](m(t))):f.ctx}function Le(l,t,f,m){if(l[2]&&m){const v=l[2](m(f));if(t.dirty===void 0)return v;if(typeof v=="object"){const b=[],y=Math.max(t.dirty.length,v.length);for(let h=0;h<y;h+=1)b[h]=t.dirty[h]|v[h];return b}return t.dirty|v}return t.dirty}function je(l,t,f,m,v,b){if(v){const y=hr(t,f,m,b);l.p(y,v)}}function We(l){if(l.ctx.length>32){const t=[],f=l.ctx.length/32;for(let m=0;m<f;m++)t[m]=-1;return t}return-1}function jt(l){return l??""}function Ht(l,t,f){return l.set(f),t}function j(l,t){l.appendChild(t)}function ht(l,t,f){l.insertBefore(t,f||null)}function lt(l){l.parentNode&&l.parentNode.removeChild(l)}function Jt(l,t){for(let f=0;f<l.length;f+=1)l[f]&&l[f].d(t)}function V(l){return document.createElement(l)}function zt(l){return document.createTextNode(l)}function ot(){return zt(" ")}function Zt(){return zt("")}function rt(l,t,f,m){return l.addEventListener(t,f,m),()=>l.removeEventListener(t,f,m)}function Qt(l){return function(t){return t.preventDefault(),l.call(this,t)}}function me(l){return function(t){return t.stopPropagation(),l.call(this,t)}}function Ls(l){return function(t){t.target===this&&l.call(this,t)}}function k(l,t,f){f==null?l.removeAttribute(t):l.getAttribute(t)!==f&&l.setAttribute(t,f)}function js(l){return Array.from(l.childNodes)}function Oe(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function Dt(l,t,f,m){f===null?l.style.removeProperty(t):l.style.setProperty(t,f,m?"important":"")}function Lt(l,t,f){l.classList[f?"add":"remove"](t)}function Ws(l,t,{bubbles:f=!1,cancelable:m=!1}={}){const v=document.createEvent("CustomEvent");return v.initCustomEvent(l,f,m,t),v}function St(l,t){return new l(t)}let Ne;function Ie(l){Ne=l}function Ni(){if(!Ne)throw new Error("Function called outside component initialization");return Ne}function Ee(l){Ni().$$.on_mount.push(l)}function ur(l){Ni().$$.on_destroy.push(l)}function Ns(){const l=Ni();return(t,f,{cancelable:m=!1}={})=>{const v=l.$$.callbacks[t];if(v){const b=Ws(t,f,{cancelable:m});return v.slice().forEach(y=>{y.call(l,b)}),!b.defaultPrevented}return!0}}function zs(l,t){const f=l.$$.callbacks[t.type];f&&f.slice().forEach(m=>m.call(this,t))}const Se=[],Ct=[];let Te=[];const bi=[],Hs=Promise.resolve();let Ci=!1;function Xs(){Ci||(Ci=!0,Hs.then(fr))}function wi(l){Te.push(l)}function Xt(l){bi.push(l)}const ni=new Set;let Ce=0;function fr(){if(Ce!==0)return;const l=Ne;do{try{for(;Ce<Se.length;){const t=Se[Ce];Ce++,Ie(t),Ys(t.$$)}}catch(t){throw Se.length=0,Ce=0,t}for(Ie(null),Se.length=0,Ce=0;Ct.length;)Ct.pop()();for(let t=0;t<Te.length;t+=1){const f=Te[t];ni.has(f)||(ni.add(f),f())}Te.length=0}while(Se.length);for(;bi.length;)bi.pop()();Ci=!1,ni.clear(),Ie(l)}function Ys(l){if(l.fragment!==null){l.update(),Pt(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(wi)}}function Us(l){const t=[],f=[];Te.forEach(m=>l.indexOf(m)===-1?t.push(m):f.push(m)),f.forEach(m=>m()),Te=t}const Ve=new Set;let de;function Ft(){de={r:0,c:[],p:de}}function Bt(){de.r||Pt(de.c),de=de.p}function dt(l,t){l&&l.i&&(Ve.delete(l),l.i(t))}function gt(l,t,f,m){if(l&&l.o){if(Ve.has(l))return;Ve.add(l),de.c.push(()=>{Ve.delete(l),m&&(f&&l.d(1),m())}),l.o(t)}else m&&m()}const zi=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Mt(l,t,f){const m=l.$$.props[t];m!==void 0&&(l.$$.bound[m]=f,f(l.$$.ctx[m]))}function bt(l){l&&l.c()}function _t(l,t,f,m){const{fragment:v,after_update:b}=l.$$;v&&v.m(t,f),m||wi(()=>{const y=l.$$.on_mount.map(cr).filter(Ze);l.$$.on_destroy?l.$$.on_destroy.push(...y):Pt(y),l.$$.on_mount=[]}),b.forEach(wi)}function yt(l,t){const f=l.$$;f.fragment!==null&&(Us(f.after_update),Pt(f.on_destroy),f.fragment&&f.fragment.d(t),f.on_destroy=f.fragment=null,f.ctx=[])}function Vs(l,t){l.$$.dirty[0]===-1&&(Se.push(l),Xs(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Et(l,t,f,m,v,b,y,h=[-1]){const e=Ne;Ie(l);const c=l.$$={fragment:null,ctx:[],props:b,update:vt,not_equal:v,bound:$i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(e?e.$$.context:[])),callbacks:$i(),dirty:h,skip_bound:!1,root:t.target||e.$$.root};y&&y(c.root);let o=!1;if(c.ctx=f?f(l,t.props||{},(n,r,...i)=>{const a=i.length?i[0]:r;return c.ctx&&v(c.ctx[n],c.ctx[n]=a)&&(!c.skip_bound&&c.bound[n]&&c.bound[n](a),o&&Vs(l,n)),r}):[],c.update(),o=!0,Pt(c.before_update),c.fragment=m?m(c.ctx):!1,t.target){if(t.hydrate){const n=js(t.target);c.fragment&&c.fragment.l(n),n.forEach(lt)}else c.fragment&&c.fragment.c();t.intro&&dt(l.$$.fragment),_t(l,t.target,t.anchor,t.customElement),fr()}Ie(e)}class At{$destroy(){yt(this,1),this.$destroy=vt}$on(t,f){if(!Ze(f))return vt;const m=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return m.push(f),()=>{const v=m.indexOf(f);v!==-1&&m.splice(v,1)}}$set(t){this.$$set&&!Rs(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Gs="/assets/dev-ku-7a7072be.png";function qs(l){if(l.__esModule)return l;var t=l.default;if(typeof t=="function"){var f=function m(){if(this instanceof m){var v=[null];v.push.apply(v,arguments);var b=Function.bind.apply(t,v);return new b}return t.apply(this,arguments)};f.prototype=t.prototype}else f={};return Object.defineProperty(f,"__esModule",{value:!0}),Object.keys(l).forEach(function(m){var v=Object.getOwnPropertyDescriptor(l,m);Object.defineProperty(f,m,v.get?v:{enumerable:!0,get:function(){return l[m]}})}),f}var oe={};const Ks={},Js=Object.freeze(Object.defineProperty({__proto__:null,default:Ks},Symbol.toStringTag,{value:"Module"})),ri=qs(Js);(function(l){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.3.0"};if(l.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var f=ri,m=new f.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=m.document,t.jsdomImplForWrapper=ri.implForWrapper,t.nodeCanvas=ri.Canvas,t.window=m,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function h(i,a){if(this.__eventListeners[i]){var u=this.__eventListeners[i];a?u[u.indexOf(a)]=!1:t.util.array.fill(u,!1)}}function e(i,a){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var u in i)this.on(u,i[u]);else this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(a);return this}function c(i,a){var u=function(){a.apply(this,arguments),this.off(i,u)}.bind(this);this.on(i,u)}function o(i,a){if(arguments.length===1)for(var u in i)c.call(this,u,i[u]);else c.call(this,i,a);return this}function n(i,a){if(!this.__eventListeners)return this;if(arguments.length===0)for(i in this.__eventListeners)h.call(this,i);else if(arguments.length===1&&typeof arguments[0]=="object")for(var u in i)h.call(this,u,i[u]);else h.call(this,i,a);return this}function r(i,a){if(!this.__eventListeners)return this;var u=this.__eventListeners[i];if(!u)return this;for(var s=0,d=u.length;s<d;s++)u[s]&&u[s].call(this,a||{});return this.__eventListeners[i]=u.filter(function(g){return g!==!1}),this}t.Observable={fire:r,on:e,once:o,off:n}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var h=0,e=arguments.length;h<e;h++)this._onObjectAdded(arguments[h]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(h,e,c){var o=this._objects;return c?o[e]=h:o.splice(e,0,h),this._onObjectAdded&&this._onObjectAdded(h),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var h=this._objects,e,c=!1,o=0,n=arguments.length;o<n;o++)e=h.indexOf(arguments[o]),e!==-1&&(c=!0,h.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(h,e){for(var c=this.getObjects(),o=0,n=c.length;o<n;o++)h.call(e,c[o],o,c);return this},getObjects:function(h){return typeof h>"u"?this._objects.concat():this._objects.filter(function(e){return e.type===h})},item:function(h){return this._objects[h]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(h,e){return this._objects.indexOf(h)>-1?!0:e?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(h,!0)}):!1},complexity:function(){return this._objects.reduce(function(h,e){return h+=e.complexity?e.complexity():0,h},0)}},t.CommonMethods={_setOptions:function(h){for(var e in h)this.set(e,h[e])},_initGradient:function(h,e){h&&h.colorStops&&!(h instanceof t.Gradient)&&this.set(e,new t.Gradient(h))},_initPattern:function(h,e,c){h&&h.source&&!(h instanceof t.Pattern)?this.set(e,new t.Pattern(h,c)):c&&c()},_setObject:function(h){for(var e in h)this._set(e,h[e])},set:function(h,e){return typeof h=="object"?this._setObject(h):this._set(h,e),this},_set:function(h,e){this[h]=e},toggle:function(h){var e=this.get(h);return typeof e=="boolean"&&this.set(h,!e),this},get:function(h){return this[h]}},function(h){var e=Math.sqrt,c=Math.atan2,o=Math.pow,n=Math.PI/180,r=Math.PI/2;t.util={cos:function(i){if(i===0)return 1;i<0&&(i=-i);var a=i/r;switch(a){case 1:case 3:return 0;case 2:return-1}return Math.cos(i)},sin:function(i){if(i===0)return 0;var a=i/r,u=1;switch(i<0&&(u=-1),a){case 1:return u;case 2:return 0;case 3:return-u}return Math.sin(i)},removeFromArray:function(i,a){var u=i.indexOf(a);return u!==-1&&i.splice(u,1),i},getRandomInt:function(i,a){return Math.floor(Math.random()*(a-i+1))+i},degreesToRadians:function(i){return i*n},radiansToDegrees:function(i){return i/n},rotatePoint:function(i,a,u){var s=new t.Point(i.x-a.x,i.y-a.y),d=t.util.rotateVector(s,u);return new t.Point(d.x,d.y).addEquals(a)},rotateVector:function(i,a){var u=t.util.sin(a),s=t.util.cos(a),d=i.x*s-i.y*u,g=i.x*u+i.y*s;return{x:d,y:g}},createVector:function(i,a){return new t.Point(a.x-i.x,a.y-i.y)},calcAngleBetweenVectors:function(i,a){return Math.acos((i.x*a.x+i.y*a.y)/(Math.hypot(i.x,i.y)*Math.hypot(a.x,a.y)))},getHatVector:function(i){return new t.Point(i.x,i.y).multiply(1/Math.hypot(i.x,i.y))},getBisector:function(i,a,u){var s=t.util.createVector(i,a),d=t.util.createVector(i,u),g=t.util.calcAngleBetweenVectors(s,d),p=t.util.calcAngleBetweenVectors(t.util.rotateVector(s,g),d),_=g*(p===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(s,_)),angle:g}},projectStrokeOnPoints:function(i,a,u){var s=[],d=a.strokeWidth/2,g=a.strokeUniform?new t.Point(1/a.scaleX,1/a.scaleY):new t.Point(1,1),p=function(_){var C=d/Math.hypot(_.x,_.y);return new t.Point(_.x*C*g.x,_.y*C*g.y)};return i.length<=1||i.forEach(function(_,C){var w=new t.Point(_.x,_.y),S,O;C===0?(O=i[C+1],S=u?p(t.util.createVector(O,w)).addEquals(w):i[i.length-1]):C===i.length-1?(S=i[C-1],O=u?p(t.util.createVector(S,w)).addEquals(w):i[0]):(S=i[C-1],O=i[C+1]);var I=t.util.getBisector(w,S,O),X=I.vector,Q=I.angle,tt,Y;if(a.strokeLineJoin==="miter"&&(tt=-d/Math.sin(Q/2),Y=new t.Point(X.x*tt*g.x,X.y*tt*g.y),Math.hypot(Y.x,Y.y)/d<=a.strokeMiterLimit)){s.push(w.add(Y)),s.push(w.subtract(Y));return}tt=-d*Math.SQRT2,Y=new t.Point(X.x*tt*g.x,X.y*tt*g.y),s.push(w.add(Y)),s.push(w.subtract(Y))}),s},transformPoint:function(i,a,u){return u?new t.Point(a[0]*i.x+a[2]*i.y,a[1]*i.x+a[3]*i.y):new t.Point(a[0]*i.x+a[2]*i.y+a[4],a[1]*i.x+a[3]*i.y+a[5])},makeBoundingBoxFromPoints:function(i,a){if(a)for(var u=0;u<i.length;u++)i[u]=t.util.transformPoint(i[u],a);var s=[i[0].x,i[1].x,i[2].x,i[3].x],d=t.util.array.min(s),g=t.util.array.max(s),p=g-d,_=[i[0].y,i[1].y,i[2].y,i[3].y],C=t.util.array.min(_),w=t.util.array.max(_),S=w-C;return{left:d,top:C,width:p,height:S}},invertTransform:function(i){var a=1/(i[0]*i[3]-i[1]*i[2]),u=[a*i[3],-a*i[1],-a*i[2],a*i[0]],s=t.util.transformPoint({x:i[4],y:i[5]},u,!0);return u[4]=-s.x,u[5]=-s.y,u},toFixed:function(i,a){return parseFloat(Number(i).toFixed(a))},parseUnit:function(i,a){var u=/\D{0,2}$/.exec(i),s=parseFloat(i);switch(a||(a=t.Text.DEFAULT_SVG_FONT_SIZE),u[0]){case"mm":return s*t.DPI/25.4;case"cm":return s*t.DPI/2.54;case"in":return s*t.DPI;case"pt":return s*t.DPI/72;case"pc":return s*t.DPI/72*12;case"em":return s*a;default:return s}},falseFunction:function(){return!1},getKlass:function(i,a){return i=t.util.string.camelize(i.charAt(0).toUpperCase()+i.slice(1)),t.util.resolveNamespace(a)[i]},getSvgAttributes:function(i){var a=["instantiated_by_use","style","id","class"];switch(i){case"linearGradient":a=a.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":a=a.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":a=a.concat(["offset","stop-color","stop-opacity"]);break}return a},resolveNamespace:function(i){if(!i)return t;var a=i.split("."),u=a.length,s,d=h||t.window;for(s=0;s<u;++s)d=d[a[s]];return d},loadImage:function(i,a,u,s){if(!i){a&&a.call(u,i);return}var d=t.util.createImage(),g=function(){a&&a.call(u,d,!1),d=d.onload=d.onerror=null};d.onload=g,d.onerror=function(){t.log("Error loading "+d.src),a&&a.call(u,null,!0),d=d.onload=d.onerror=null},i.indexOf("data")!==0&&s!==void 0&&s!==null&&(d.crossOrigin=s),i.substring(0,14)==="data:image/svg"&&(d.onload=null,t.util.loadImageInDom(d,g)),d.src=i},loadImageInDom:function(i,a){var u=t.document.createElement("div");u.style.width=u.style.height="1px",u.style.left=u.style.top="-100%",u.style.position="absolute",u.appendChild(i),t.document.querySelector("body").appendChild(u),i.onload=function(){a(),u.parentNode.removeChild(u),u=null}},enlivenObjects:function(i,a,u,s){i=i||[];var d=[],g=0,p=i.length;function _(){++g===p&&a&&a(d.filter(function(C){return C}))}if(!p){a&&a(d);return}i.forEach(function(C,w){if(!C||!C.type){_();return}var S=t.util.getKlass(C.type,u);S.fromObject(C,function(O,I){I||(d[w]=O),s&&s(C,O,I),_()})})},enlivenObjectEnlivables:function(i,a,u){var s=t.Object.ENLIVEN_PROPS.filter(function(d){return!!i[d]});t.util.enlivenObjects(s.map(function(d){return i[d]}),function(d){var g={};s.forEach(function(p,_){g[p]=d[_],a&&(a[p]=d[_])}),u&&u(g)})},enlivenPatterns:function(i,a){i=i||[];function u(){++d===g&&a&&a(s)}var s=[],d=0,g=i.length;if(!g){a&&a(s);return}i.forEach(function(p,_){p&&p.source?new t.Pattern(p,function(C){s[_]=C,u()}):(s[_]=p,u())})},groupSVGElements:function(i,a,u){var s;return i&&i.length===1?(typeof u<"u"&&(i[0].sourcePath=u),i[0]):(a&&(a.width&&a.height?a.centerPoint={x:a.width/2,y:a.height/2}:(delete a.width,delete a.height)),s=new t.Group(i,a),typeof u<"u"&&(s.sourcePath=u),s)},populateWithProperties:function(i,a,u){if(u&&Array.isArray(u))for(var s=0,d=u.length;s<d;s++)u[s]in i&&(a[u[s]]=i[u[s]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(i){var a=t.util.createCanvasElement();return a.width=i.width,a.height=i.height,a.getContext("2d").drawImage(i,0,0),a},toDataURL:function(i,a,u){return i.toDataURL("image/"+a,u)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(i,a,u){return[i[0]*a[0]+i[2]*a[1],i[1]*a[0]+i[3]*a[1],i[0]*a[2]+i[2]*a[3],i[1]*a[2]+i[3]*a[3],u?0:i[0]*a[4]+i[2]*a[5]+i[4],u?0:i[1]*a[4]+i[3]*a[5]+i[5]]},qrDecompose:function(i){var a=c(i[1],i[0]),u=o(i[0],2)+o(i[1],2),s=e(u),d=(i[0]*i[3]-i[2]*i[1])/s,g=c(i[0]*i[2]+i[1]*i[3],u);return{angle:a/n,scaleX:s,scaleY:d,skewX:g/n,skewY:0,translateX:i[4],translateY:i[5]}},calcRotateMatrix:function(i){if(!i.angle)return t.iMatrix.concat();var a=t.util.degreesToRadians(i.angle),u=t.util.cos(a),s=t.util.sin(a);return[u,s,-s,u,0,0]},calcDimensionsMatrix:function(i){var a=typeof i.scaleX>"u"?1:i.scaleX,u=typeof i.scaleY>"u"?1:i.scaleY,s=[i.flipX?-a:a,0,0,i.flipY?-u:u,0,0],d=t.util.multiplyTransformMatrices,g=t.util.degreesToRadians;return i.skewX&&(s=d(s,[1,0,Math.tan(g(i.skewX)),1],!0)),i.skewY&&(s=d(s,[1,Math.tan(g(i.skewY)),0,1],!0)),s},composeMatrix:function(i){var a=[1,0,0,1,i.translateX||0,i.translateY||0],u=t.util.multiplyTransformMatrices;return i.angle&&(a=u(a,t.util.calcRotateMatrix(i))),(i.scaleX!==1||i.scaleY!==1||i.skewX||i.skewY||i.flipX||i.flipY)&&(a=u(a,t.util.calcDimensionsMatrix(i))),a},resetObjectTransform:function(i){i.scaleX=1,i.scaleY=1,i.skewX=0,i.skewY=0,i.flipX=!1,i.flipY=!1,i.rotate(0)},saveObjectTransform:function(i){return{scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,angle:i.angle,left:i.left,flipX:i.flipX,flipY:i.flipY,top:i.top}},isTransparent:function(i,a,u,s){s>0&&(a>s?a-=s:a=0,u>s?u-=s:u=0);var d=!0,g,p,_=i.getImageData(a,u,s*2||1,s*2||1),C=_.data.length;for(g=3;g<C&&(p=_.data[g],d=p<=0,d!==!1);g+=4);return _=null,d},parsePreserveAspectRatioAttribute:function(i){var a="meet",u="Mid",s="Mid",d=i.split(" "),g;return d&&d.length&&(a=d.pop(),a!=="meet"&&a!=="slice"?(g=a,a="meet"):d.length&&(g=d.pop())),u=g!=="none"?g.slice(1,4):"none",s=g!=="none"?g.slice(5,8):"none",{meetOrSlice:a,alignX:u,alignY:s}},clearFabricFontCache:function(i){i=(i||"").toLowerCase(),i?t.charWidthsCache[i]&&delete t.charWidthsCache[i]:t.charWidthsCache={}},limitDimsByArea:function(i,a){var u=Math.sqrt(a*i),s=Math.floor(a/u);return{x:Math.floor(u),y:s}},capValue:function(i,a,u){return Math.max(i,Math.min(a,u))},findScaleToFit:function(i,a){return Math.min(a.width/i.width,a.height/i.height)},findScaleToCover:function(i,a){return Math.max(a.width/i.width,a.height/i.height)},matrixToSVG:function(i){return"matrix("+i.map(function(a){return t.util.toFixed(a,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(i,a){var u=t.util.invertTransform(a),s=t.util.multiplyTransformMatrices(u,i.calcOwnMatrix());t.util.applyTransformToObject(i,s)},addTransformToObject:function(i,a){t.util.applyTransformToObject(i,t.util.multiplyTransformMatrices(a,i.calcOwnMatrix()))},applyTransformToObject:function(i,a){var u=t.util.qrDecompose(a),s=new t.Point(u.translateX,u.translateY);i.flipX=!1,i.flipY=!1,i.set("scaleX",u.scaleX),i.set("scaleY",u.scaleY),i.skewX=u.skewX,i.skewY=u.skewY,i.angle=u.angle,i.setPositionByOrigin(s,"center","center")},sizeAfterTransform:function(i,a,u){var s=i/2,d=a/2,g=[{x:-s,y:-d},{x:s,y:-d},{x:-s,y:d},{x:s,y:d}],p=t.util.calcDimensionsMatrix(u),_=t.util.makeBoundingBoxFromPoints(g,p);return{x:_.width,y:_.height}},mergeClipPaths:function(i,a){var u=i,s=a;u.inverted&&!s.inverted&&(u=a,s=i),t.util.applyTransformToObject(s,t.util.multiplyTransformMatrices(t.util.invertTransform(u.calcTransformMatrix()),s.calcTransformMatrix()));var d=u.inverted&&s.inverted;return d&&(u.inverted=s.inverted=!1),new t.Group([u],{clipPath:s,inverted:d})},hasStyleChanged:function(i,a,u){return u=u||!1,i.fill!==a.fill||i.stroke!==a.stroke||i.strokeWidth!==a.strokeWidth||i.fontSize!==a.fontSize||i.fontFamily!==a.fontFamily||i.fontWeight!==a.fontWeight||i.fontStyle!==a.fontStyle||i.textBackgroundColor!==a.textBackgroundColor||i.deltaY!==a.deltaY||u&&(i.overline!==a.overline||i.underline!==a.underline||i.linethrough!==a.linethrough)},stylesToArray:function(u,a){for(var u=t.util.object.clone(u,!0),s=a.split(`
`),d=-1,g={},p=[],_=0;_<s.length;_++){if(!u[_]){d+=s[_].length;continue}for(var C=0;C<s[_].length;C++){d++;var w=u[_][C];if(w&&Object.keys(w).length>0){var S=t.util.hasStyleChanged(g,w,!0);S?p.push({start:d,end:d+1,style:w}):p[p.length-1].end++}g=w||{}}}return p},stylesFromArray:function(i,a){if(!Array.isArray(i))return i;for(var u=a.split(`
`),s=-1,d=0,g={},p=0;p<u.length;p++)for(var _=0;_<u[p].length;_++)s++,i[d]&&i[d].start<=s&&s<i[d].end&&(g[p]=g[p]||{},g[p][_]=Object.assign({},i[d].style),s===i[d].end-1&&d++);return g}}}(l),function(){var h=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function o(T,A,P,D,z,E,x,M,L,K,H){var Z=t.util.cos(T),B=t.util.sin(T),nt=t.util.cos(A),W=t.util.sin(A),R=P*z*nt-D*E*W+x,G=D*z*nt+P*E*W+M,J=K+L*(-P*z*B-D*E*Z),N=H+L*(-D*z*B+P*E*Z),$=R+L*(P*z*W+D*E*nt),it=G+L*(D*z*W-P*E*nt);return["C",J,N,$,it,R,G]}function n(T,A,P,D,z,E,x){var M=Math.PI,L=x*M/180,K=t.util.sin(L),H=t.util.cos(L),Z=0,B=0;P=Math.abs(P),D=Math.abs(D);var nt=-H*T*.5-K*A*.5,W=-H*A*.5+K*T*.5,R=P*P,G=D*D,J=W*W,N=nt*nt,$=R*G-R*J-G*N,it=0;if($<0){var mt=Math.sqrt(1-$/(R*G));P*=mt,D*=mt}else it=(z===E?-1:1)*Math.sqrt($/(R*J+G*N));var at=it*P*W/D,F=-it*D*nt/P,ct=H*at-K*F+T*.5,q=K*at+H*F+A*.5,pt=r(1,0,(nt-at)/P,(W-F)/D),Ot=r((nt-at)/P,(W-F)/D,(-nt-at)/P,(-W-F)/D);E===0&&Ot>0?Ot-=2*M:E===1&&Ot<0&&(Ot+=2*M);for(var wt=Math.ceil(Math.abs(Ot/M*2)),Wt=[],It=Ot/wt,he=8/3*Math.sin(It/4)*Math.sin(It/4)/Math.sin(It/2),Ae=pt+It,Kt=0;Kt<wt;Kt++)Wt[Kt]=o(pt,Ae,H,K,P,D,ct,q,he,Z,B),Z=Wt[Kt][5],B=Wt[Kt][6],pt=Ae,Ae+=It;return Wt}function r(T,A,P,D){var z=Math.atan2(A,T),E=Math.atan2(D,P);return E>=z?E-z:2*Math.PI-(z-E)}function i(T,A,P,D,z,E,x,M){var L;if(t.cachesBoundsOfCurve&&(L=h.call(arguments),t.boundsOfCurveCache[L]))return t.boundsOfCurveCache[L];var K=Math.sqrt,H=Math.min,Z=Math.max,B=Math.abs,nt=[],W=[[],[]],R,G,J,N,$,it,mt,at;G=6*T-12*P+6*z,R=-3*T+9*P-9*z+3*x,J=3*P-3*T;for(var F=0;F<2;++F){if(F>0&&(G=6*A-12*D+6*E,R=-3*A+9*D-9*E+3*M,J=3*D-3*A),B(R)<1e-12){if(B(G)<1e-12)continue;N=-J/G,0<N&&N<1&&nt.push(N);continue}mt=G*G-4*J*R,!(mt<0)&&(at=K(mt),$=(-G+at)/(2*R),0<$&&$<1&&nt.push($),it=(-G-at)/(2*R),0<it&&it<1&&nt.push(it))}for(var ct,q,pt=nt.length,Ot=pt,wt;pt--;)N=nt[pt],wt=1-N,ct=wt*wt*wt*T+3*wt*wt*N*P+3*wt*N*N*z+N*N*N*x,W[0][pt]=ct,q=wt*wt*wt*A+3*wt*wt*N*D+3*wt*N*N*E+N*N*N*M,W[1][pt]=q;W[0][Ot]=T,W[1][Ot]=A,W[0][Ot+1]=x,W[1][Ot+1]=M;var Wt=[{x:H.apply(null,W[0]),y:H.apply(null,W[1])},{x:Z.apply(null,W[0]),y:Z.apply(null,W[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[L]=Wt),Wt}function a(T,A,P){for(var D=P[1],z=P[2],E=P[3],x=P[4],M=P[5],L=P[6],K=P[7],H=n(L-T,K-A,D,z,x,M,E),Z=0,B=H.length;Z<B;Z++)H[Z][1]+=T,H[Z][2]+=A,H[Z][3]+=T,H[Z][4]+=A,H[Z][5]+=T,H[Z][6]+=A;return H}function u(T){var A=0,P=0,D=T.length,z=0,E=0,x,M,L,K=[],H,Z,B;for(M=0;M<D;++M){switch(L=!1,x=T[M].slice(0),x[0]){case"l":x[0]="L",x[1]+=A,x[2]+=P;case"L":A=x[1],P=x[2];break;case"h":x[1]+=A;case"H":x[0]="L",x[2]=P,A=x[1];break;case"v":x[1]+=P;case"V":x[0]="L",P=x[1],x[1]=A,x[2]=P;break;case"m":x[0]="M",x[1]+=A,x[2]+=P;case"M":A=x[1],P=x[2],z=x[1],E=x[2];break;case"c":x[0]="C",x[1]+=A,x[2]+=P,x[3]+=A,x[4]+=P,x[5]+=A,x[6]+=P;case"C":Z=x[3],B=x[4],A=x[5],P=x[6];break;case"s":x[0]="S",x[1]+=A,x[2]+=P,x[3]+=A,x[4]+=P;case"S":H==="C"?(Z=2*A-Z,B=2*P-B):(Z=A,B=P),A=x[3],P=x[4],x[0]="C",x[5]=x[3],x[6]=x[4],x[3]=x[1],x[4]=x[2],x[1]=Z,x[2]=B,Z=x[3],B=x[4];break;case"q":x[0]="Q",x[1]+=A,x[2]+=P,x[3]+=A,x[4]+=P;case"Q":Z=x[1],B=x[2],A=x[3],P=x[4];break;case"t":x[0]="T",x[1]+=A,x[2]+=P;case"T":H==="Q"?(Z=2*A-Z,B=2*P-B):(Z=A,B=P),x[0]="Q",A=x[1],P=x[2],x[1]=Z,x[2]=B,x[3]=A,x[4]=P;break;case"a":x[0]="A",x[6]+=A,x[7]+=P;case"A":L=!0,K=K.concat(a(A,P,x)),A=x[6],P=x[7];break;case"z":case"Z":A=z,P=E;break}L||K.push(x),H=x[0]}return K}function s(T,A,P,D){return Math.sqrt((P-T)*(P-T)+(D-A)*(D-A))}function d(T){return T*T*T}function g(T){return 3*T*T*(1-T)}function p(T){return 3*T*(1-T)*(1-T)}function _(T){return(1-T)*(1-T)*(1-T)}function C(T,A,P,D,z,E,x,M){return function(L){var K=d(L),H=g(L),Z=p(L),B=_(L);return{x:x*K+z*H+P*Z+T*B,y:M*K+E*H+D*Z+A*B}}}function w(T,A,P,D,z,E,x,M){return function(L){var K=1-L,H=3*K*K*(P-T)+6*K*L*(z-P)+3*L*L*(x-z),Z=3*K*K*(D-A)+6*K*L*(E-D)+3*L*L*(M-E);return Math.atan2(Z,H)}}function S(T){return T*T}function O(T){return 2*T*(1-T)}function I(T){return(1-T)*(1-T)}function X(T,A,P,D,z,E){return function(x){var M=S(x),L=O(x),K=I(x);return{x:z*M+P*L+T*K,y:E*M+D*L+A*K}}}function Q(T,A,P,D,z,E){return function(x){var M=1-x,L=2*M*(P-T)+2*x*(z-P),K=2*M*(D-A)+2*x*(E-D);return Math.atan2(K,L)}}function tt(T,A,P){var D={x:A,y:P},z,E=0,x;for(x=1;x<=100;x+=1)z=T(x/100),E+=s(D.x,D.y,z.x,z.y),D=z;return E}function Y(T,A){for(var P=0,D=0,z=T.iterator,E={x:T.x,y:T.y},x,M,L=.01,K=T.angleFinder,H;D<A&&L>1e-4;)x=z(P),H=P,M=s(E.x,E.y,x.x,x.y),M+D>A?(P-=L,L/=2):(E=x,P+=L,D+=M);return x.angle=K(H),x}function U(T){for(var A=0,P=T.length,D,z=0,E=0,x=0,M=0,L=[],K,H,Z,B=0;B<P;B++){switch(D=T[B],H={x:z,y:E,command:D[0]},D[0]){case"M":H.length=0,x=z=D[1],M=E=D[2];break;case"L":H.length=s(z,E,D[1],D[2]),z=D[1],E=D[2];break;case"C":K=C(z,E,D[1],D[2],D[3],D[4],D[5],D[6]),Z=w(z,E,D[1],D[2],D[3],D[4],D[5],D[6]),H.iterator=K,H.angleFinder=Z,H.length=tt(K,z,E),z=D[5],E=D[6];break;case"Q":K=X(z,E,D[1],D[2],D[3],D[4]),Z=Q(z,E,D[1],D[2],D[3],D[4]),H.iterator=K,H.angleFinder=Z,H.length=tt(K,z,E),z=D[3],E=D[4];break;case"Z":case"z":H.destX=x,H.destY=M,H.length=s(z,E,x,M),z=x,E=M;break}A+=H.length,L.push(H)}return L.push({length:A,x:z,y:E}),L}function et(T,A,P){P||(P=U(T));for(var D=0;A-P[D].length>0&&D<P.length-2;)A-=P[D].length,D++;var z=P[D],E=A/z.length,x=z.command,M=T[D],L;switch(x){case"M":return{x:z.x,y:z.y,angle:0};case"Z":case"z":return L=new t.Point(z.x,z.y).lerp(new t.Point(z.destX,z.destY),E),L.angle=Math.atan2(z.destY-z.y,z.destX-z.x),L;case"L":return L=new t.Point(z.x,z.y).lerp(new t.Point(M[1],M[2]),E),L.angle=Math.atan2(M[2]-z.y,M[1]-z.x),L;case"C":return Y(z,A);case"Q":return Y(z,A)}}function st(T){var A=[],P=[],D,z,E=t.rePathCommand,x="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",M="("+x+")"+t.commaWsp,L="([01])"+t.commaWsp+"?",K=M+"?"+M+"?"+M+L+L+M+"?("+x+")",H=new RegExp(K,"g"),Z,B,nt;if(!T||!T.match)return A;nt=T.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var W=0,R,G=nt.length;W<G;W++){D=nt[W],B=D.slice(1).trim(),P.length=0;var J=D.charAt(0);if(R=[J],J.toLowerCase()==="a")for(var N;N=H.exec(B);)for(var $=1;$<N.length;$++)P.push(N[$]);else for(;Z=E.exec(B);)P.push(Z[0]);for(var $=0,it=P.length;$<it;$++)z=parseFloat(P[$]),isNaN(z)||R.push(z);var mt=e[J.toLowerCase()],at=c[J]||J;if(R.length-1>mt)for(var F=1,ct=R.length;F<ct;F+=mt)A.push([J].concat(R.slice(F,F+mt))),J=at;else A.push(R)}return A}function ft(T,A){var P=[],D,z=new t.Point(T[0].x,T[0].y),E=new t.Point(T[1].x,T[1].y),x=T.length,M=1,L=0,K=x>2;for(A=A||0,K&&(M=T[2].x<E.x?-1:T[2].x===E.x?0:1,L=T[2].y<E.y?-1:T[2].y===E.y?0:1),P.push(["M",z.x-M*A,z.y-L*A]),D=1;D<x;D++){if(!z.eq(E)){var H=z.midPointFrom(E);P.push(["Q",z.x,z.y,H.x,H.y])}z=T[D],D+1<T.length&&(E=T[D+1])}return K&&(M=z.x>T[D-2].x?1:z.x===T[D-2].x?0:-1,L=z.y>T[D-2].y?1:z.y===T[D-2].y?0:-1),P.push(["L",z.x+M*A,z.y+L*A]),P}function ut(T,A,P){return P&&(A=t.util.multiplyTransformMatrices(A,[1,0,0,1,-P.x,-P.y])),T.map(function(D){for(var z=D.slice(0),E={},x=1;x<D.length-1;x+=2)E.x=D[x],E.y=D[x+1],E=t.util.transformPoint(E,A),z[x]=E.x,z[x+1]=E.y;return z})}t.util.joinPath=function(T){return T.map(function(A){return A.join(" ")}).join(" ")},t.util.parsePath=st,t.util.makePathSimpler=u,t.util.getSmoothPathFromPoints=ft,t.util.getPathSegmentsInfo=U,t.util.getBoundsOfCurve=i,t.util.getPointOnPath=et,t.util.transformPath=ut}(),function(){var h=Array.prototype.slice;function e(i,a){for(var u=h.call(arguments,2),s=[],d=0,g=i.length;d<g;d++)s[d]=u.length?i[d][a].apply(i[d],u):i[d][a].call(i[d]);return s}function c(i,a){return r(i,a,function(u,s){return u>=s})}function o(i,a){return r(i,a,function(u,s){return u<s})}function n(i,a){for(var u=i.length;u--;)i[u]=a;return i}function r(i,a,u){if(!(!i||i.length===0)){var s=i.length-1,d=a?i[s][a]:i[s];if(a)for(;s--;)u(i[s][a],d)&&(d=i[s][a]);else for(;s--;)u(i[s],d)&&(d=i[s]);return d}}t.util.array={fill:n,invoke:e,min:o,max:c}}(),function(){function h(c,o,n){if(n)if(!t.isLikelyNode&&o instanceof Element)c=o;else if(o instanceof Array){c=[];for(var r=0,i=o.length;r<i;r++)c[r]=h({},o[r],n)}else if(o&&typeof o=="object")for(var a in o)a==="canvas"||a==="group"?c[a]=null:o.hasOwnProperty(a)&&(c[a]=h({},o[a],n));else c=o;else for(var a in o)c[a]=o[a];return c}function e(c,o){return h({},c,o)}t.util.object={extend:h,clone:e},t.util.object.extend(t.util,t.Observable)}(),function(){function h(r){return r.replace(/-+(.)?/g,function(i,a){return a?a.toUpperCase():""})}function e(r,i){return r.charAt(0).toUpperCase()+(i?r.slice(1):r.slice(1).toLowerCase())}function c(r){return r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(r){var i=0,a,u=[];for(i=0,a;i<r.length;i++)(a=n(r,i))!==!1&&u.push(a);return u}function n(r,i){var a=r.charCodeAt(i);if(isNaN(a))return"";if(a<55296||a>57343)return r.charAt(i);if(55296<=a&&a<=56319){if(r.length<=i+1)throw"High surrogate without following low surrogate";var u=r.charCodeAt(i+1);if(56320>u||u>57343)throw"High surrogate without following low surrogate";return r.charAt(i)+r.charAt(i+1)}if(i===0)throw"Low surrogate without preceding high surrogate";var s=r.charCodeAt(i-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:h,capitalize:e,escapeXml:c,graphemeSplit:o}}(),function(){var h=Array.prototype.slice,e=function(){},c=function(){for(var a in{toString:1})if(a==="toString")return!1;return!0}(),o=function(a,u,s){for(var d in u)d in a.prototype&&typeof a.prototype[d]=="function"&&(u[d]+"").indexOf("callSuper")>-1?a.prototype[d]=function(g){return function(){var p=this.constructor.superclass;this.constructor.superclass=s;var _=u[g].apply(this,arguments);if(this.constructor.superclass=p,g!=="initialize")return _}}(d):a.prototype[d]=u[d],c&&(u.toString!==Object.prototype.toString&&(a.prototype.toString=u.toString),u.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=u.valueOf))};function n(){}function r(a){for(var u=null,s=this;s.constructor.superclass;){var d=s.constructor.superclass.prototype[a];if(s[a]!==d){u=d;break}s=s.constructor.superclass.prototype}return u?arguments.length>1?u.apply(this,h.call(arguments,1)):u.call(this):console.log("tried to callSuper "+a+", method not found in prototype chain",this)}function i(){var a=null,u=h.call(arguments,0);typeof u[0]=="function"&&(a=u.shift());function s(){this.initialize.apply(this,arguments)}s.superclass=a,s.subclasses=[],a&&(n.prototype=a.prototype,s.prototype=new n,a.subclasses.push(s));for(var d=0,g=u.length;d<g;d++)o(s,u[d],a);return s.prototype.initialize||(s.prototype.initialize=e),s.prototype.constructor=s,s.prototype.callSuper=r,s}t.util.createClass=i}(),function(){var h=!!t.document.createElement("div").attachEvent,e=["touchstart","touchmove","touchend"];t.util.addListener=function(o,n,r,i){o&&o.addEventListener(n,r,h?!1:i)},t.util.removeListener=function(o,n,r,i){o&&o.removeEventListener(n,r,h?!1:i)};function c(o){var n=o.changedTouches;return n&&n[0]?n[0]:o}t.util.getPointer=function(o){var n=o.target,r=t.util.getScrollLeftTop(n),i=c(o);return{x:i.clientX+r.left,y:i.clientY+r.top}},t.util.isTouchEvent=function(o){return e.indexOf(o.type)>-1||o.pointerType==="touch"}}(),function(){function h(i,a){var u=i.style;if(!u)return i;if(typeof a=="string")return i.style.cssText+=";"+a,a.indexOf("opacity")>-1?r(i,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):i;for(var s in a)if(s==="opacity")r(i,a[s]);else{var d=s==="float"||s==="cssFloat"?typeof u.styleFloat>"u"?"cssFloat":"styleFloat":s;u.setProperty(d,a[s])}return i}var e=t.document.createElement("div"),c=typeof e.style.opacity=="string",o=typeof e.style.filter=="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,r=function(i){return i};c?r=function(i,a){return i.style.opacity=a,i}:o&&(r=function(i,a){var u=i.style;return i.currentStyle&&!i.currentStyle.hasLayout&&(u.zoom=1),n.test(u.filter)?(a=a>=.9999?"":"alpha(opacity="+a*100+")",u.filter=u.filter.replace(n,a)):u.filter+=" alpha(opacity="+a*100+")",i}),t.util.setStyle=h}(),function(){var h=Array.prototype.slice;function e(_){return typeof _=="string"?t.document.getElementById(_):_}var c,o=function(_){return h.call(_,0)};try{c=o(t.document.childNodes)instanceof Array}catch{}c||(o=function(_){for(var C=new Array(_.length),w=_.length;w--;)C[w]=_[w];return C});function n(_,C){var w=t.document.createElement(_);for(var S in C)S==="class"?w.className=C[S]:S==="for"?w.htmlFor=C[S]:w.setAttribute(S,C[S]);return w}function r(_,C){_&&(" "+_.className+" ").indexOf(" "+C+" ")===-1&&(_.className+=(_.className?" ":"")+C)}function i(_,C,w){return typeof C=="string"&&(C=n(C,w)),_.parentNode&&_.parentNode.replaceChild(C,_),C.appendChild(_),C}function a(_){for(var C=0,w=0,S=t.document.documentElement,O=t.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===t.document?(C=O.scrollLeft||S.scrollLeft||0,w=O.scrollTop||S.scrollTop||0):(C+=_.scrollLeft||0,w+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:C,top:w}}function u(_){var C,w=_&&_.ownerDocument,S={left:0,top:0},O={left:0,top:0},I,X={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!w)return O;for(var Q in X)O[X[Q]]+=parseInt(s(_,Q),10)||0;return C=w.documentElement,typeof _.getBoundingClientRect<"u"&&(S=_.getBoundingClientRect()),I=a(_),{left:S.left+I.left-(C.clientLeft||0)+O.left,top:S.top+I.top-(C.clientTop||0)+O.top}}var s;t.document.defaultView&&t.document.defaultView.getComputedStyle?s=function(_,C){var w=t.document.defaultView.getComputedStyle(_,null);return w?w[C]:void 0}:s=function(_,C){var w=_.style[C];return!w&&_.currentStyle&&(w=_.currentStyle[C]),w},function(){var _=t.document.documentElement.style,C="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function w(O){return typeof O.onselectstart<"u"&&(O.onselectstart=t.util.falseFunction),C?O.style[C]="none":typeof O.unselectable=="string"&&(O.unselectable="on"),O}function S(O){return typeof O.onselectstart<"u"&&(O.onselectstart=null),C?O.style[C]="":typeof O.unselectable=="string"&&(O.unselectable=""),O}t.util.makeElementUnselectable=w,t.util.makeElementSelectable=S}();function d(_){var C=t.jsdomImplForWrapper(_);return C._canvas||C._image}function g(_){if(t.isLikelyNode){var C=t.jsdomImplForWrapper(_);C&&(C._image=null,C._canvas=null,C._currentSrc=null,C._attributes=null,C._classList=null)}}function p(_,C){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=C}t.util.setImageSmoothing=p,t.util.getById=e,t.util.toArray=o,t.util.addClass=r,t.util.makeElement=n,t.util.wrapElement=i,t.util.getScrollLeftTop=a,t.util.getElementOffset=u,t.util.getNodeCanvas=d,t.util.cleanUpJsdomNode=g}(),function(){function h(o,n){return o+(/\?/.test(o)?"&":"?")+n}function e(){}function c(o,n){n||(n={});var r=n.method?n.method.toUpperCase():"GET",i=n.onComplete||function(){},a=new t.window.XMLHttpRequest,u=n.body||n.parameters;return a.onreadystatechange=function(){a.readyState===4&&(i(a),a.onreadystatechange=e)},r==="GET"&&(u=null,typeof n.parameters=="string"&&(o=h(o,n.parameters))),a.open(r,o,!0),(r==="POST"||r==="PUT")&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(u),a}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var h=t.util.object.extend,e=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var d=this.splice(0);return d.forEach(function(g){g.cancel()}),d},cancelByCanvas:function(d){if(!d)return[];var g=this.filter(function(p){return typeof p.target=="object"&&p.target.canvas===d});return g.forEach(function(p){p.cancel()}),g},cancelByTarget:function(d){var g=this.findAnimationsByTarget(d);return g.forEach(function(p){p.cancel()}),g},findAnimationIndex:function(d){return this.indexOf(this.findAnimation(d))},findAnimation:function(d){return this.find(function(g){return g.cancel===d})},findAnimationsByTarget:function(d){return d?this.filter(function(g){return g.target===d}):[]}});function o(){return!1}function n(d,g,p,_){return-p*Math.cos(d/_*(Math.PI/2))+p+g}function r(d){d||(d={});var g=!1,p,_=function(){var C=t.runningAnimations.indexOf(p);return C>-1&&t.runningAnimations.splice(C,1)[0]};return p=h(e(d),{cancel:function(){return g=!0,_()},currentValue:"startValue"in d?d.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(p),u(function(C){var w=C||+new Date,S=d.duration||500,O=w+S,I,X=d.onChange||o,Q=d.abort||o,tt=d.onComplete||o,Y=d.easing||n,U="startValue"in d?d.startValue.length>0:!1,et="startValue"in d?d.startValue:0,st="endValue"in d?d.endValue:100,ft=d.byValue||(U?et.map(function(ut,T){return st[T]-et[T]}):st-et);d.onStart&&d.onStart(),function ut(T){I=T||+new Date;var A=I>O?S:I-w,P=A/S,D=U?et.map(function(E,x){return Y(A,et[x],ft[x],S)}):Y(A,et,ft,S),z=Math.abs(U?(D[0]-et[0])/ft[0]:(D-et)/ft);if(p.currentValue=U?D.slice():D,p.completionRate=z,p.durationRate=P,!g){if(Q(D,z,P)){_();return}if(I>O){p.currentValue=U?st.slice():st,p.completionRate=1,p.durationRate=1,X(U?st.slice():st,1,1),tt(st,1,1),_();return}else X(D,z,P),u(ut)}}(w)}),p.cancel}var i=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(d){return t.window.setTimeout(d,1e3/60)},a=t.window.cancelAnimationFrame||t.window.clearTimeout;function u(){return i.apply(t.window,arguments)}function s(){return a.apply(t.window,arguments)}t.util.animate=r,t.util.requestAnimFrame=u,t.util.cancelAnimFrame=s,t.runningAnimations=c}(),function(){function h(c,o,n){var r="rgba("+parseInt(c[0]+n*(o[0]-c[0]),10)+","+parseInt(c[1]+n*(o[1]-c[1]),10)+","+parseInt(c[2]+n*(o[2]-c[2]),10);return r+=","+(c&&o?parseFloat(c[3]+n*(o[3]-c[3])):1),r+=")",r}function e(c,o,n,r){var i=new t.Color(c).getSource(),a=new t.Color(o).getSource(),u=r.onComplete,s=r.onChange;return r=r||{},t.util.animate(t.util.object.extend(r,{duration:n||500,startValue:i,endValue:a,byValue:a,easing:function(d,g,p,_){var C=r.colorEasing?r.colorEasing(d,_):1-Math.cos(d/_*(Math.PI/2));return h(g,p,C)},onComplete:function(d,g,p){if(u)return u(h(a,a,0),g,p)},onChange:function(d,g,p){if(s){if(Array.isArray(d))return s(h(d,d,0),g,p);s(d,g,p)}}}))}t.util.animateColor=e}(),function(){function h(T,A,P,D){return T<Math.abs(A)?(T=A,D=P/4):A===0&&T===0?D=P/(2*Math.PI)*Math.asin(1):D=P/(2*Math.PI)*Math.asin(A/T),{a:T,c:A,p:P,s:D}}function e(T,A,P){return T.a*Math.pow(2,10*(A-=1))*Math.sin((A*P-T.s)*(2*Math.PI)/T.p)}function c(T,A,P,D){return P*((T=T/D-1)*T*T+1)+A}function o(T,A,P,D){return T/=D/2,T<1?P/2*T*T*T+A:P/2*((T-=2)*T*T+2)+A}function n(T,A,P,D){return P*(T/=D)*T*T*T+A}function r(T,A,P,D){return-P*((T=T/D-1)*T*T*T-1)+A}function i(T,A,P,D){return T/=D/2,T<1?P/2*T*T*T*T+A:-P/2*((T-=2)*T*T*T-2)+A}function a(T,A,P,D){return P*(T/=D)*T*T*T*T+A}function u(T,A,P,D){return P*((T=T/D-1)*T*T*T*T+1)+A}function s(T,A,P,D){return T/=D/2,T<1?P/2*T*T*T*T*T+A:P/2*((T-=2)*T*T*T*T+2)+A}function d(T,A,P,D){return-P*Math.cos(T/D*(Math.PI/2))+P+A}function g(T,A,P,D){return P*Math.sin(T/D*(Math.PI/2))+A}function p(T,A,P,D){return-P/2*(Math.cos(Math.PI*T/D)-1)+A}function _(T,A,P,D){return T===0?A:P*Math.pow(2,10*(T/D-1))+A}function C(T,A,P,D){return T===D?A+P:P*(-Math.pow(2,-10*T/D)+1)+A}function w(T,A,P,D){return T===0?A:T===D?A+P:(T/=D/2,T<1?P/2*Math.pow(2,10*(T-1))+A:P/2*(-Math.pow(2,-10*--T)+2)+A)}function S(T,A,P,D){return-P*(Math.sqrt(1-(T/=D)*T)-1)+A}function O(T,A,P,D){return P*Math.sqrt(1-(T=T/D-1)*T)+A}function I(T,A,P,D){return T/=D/2,T<1?-P/2*(Math.sqrt(1-T*T)-1)+A:P/2*(Math.sqrt(1-(T-=2)*T)+1)+A}function X(T,A,P,D){var z=1.70158,E=0,x=P;if(T===0)return A;if(T/=D,T===1)return A+P;E||(E=D*.3);var M=h(x,P,E,z);return-e(M,T,D)+A}function Q(T,A,P,D){var z=1.70158,E=0,x=P;if(T===0)return A;if(T/=D,T===1)return A+P;E||(E=D*.3);var M=h(x,P,E,z);return M.a*Math.pow(2,-10*T)*Math.sin((T*D-M.s)*(2*Math.PI)/M.p)+M.c+A}function tt(T,A,P,D){var z=1.70158,E=0,x=P;if(T===0)return A;if(T/=D/2,T===2)return A+P;E||(E=D*(.3*1.5));var M=h(x,P,E,z);return T<1?-.5*e(M,T,D)+A:M.a*Math.pow(2,-10*(T-=1))*Math.sin((T*D-M.s)*(2*Math.PI)/M.p)*.5+M.c+A}function Y(T,A,P,D,z){return z===void 0&&(z=1.70158),P*(T/=D)*T*((z+1)*T-z)+A}function U(T,A,P,D,z){return z===void 0&&(z=1.70158),P*((T=T/D-1)*T*((z+1)*T+z)+1)+A}function et(T,A,P,D,z){return z===void 0&&(z=1.70158),T/=D/2,T<1?P/2*(T*T*(((z*=1.525)+1)*T-z))+A:P/2*((T-=2)*T*(((z*=1.525)+1)*T+z)+2)+A}function st(T,A,P,D){return P-ft(D-T,0,P,D)+A}function ft(T,A,P,D){return(T/=D)<1/2.75?P*(7.5625*T*T)+A:T<2/2.75?P*(7.5625*(T-=1.5/2.75)*T+.75)+A:T<2.5/2.75?P*(7.5625*(T-=2.25/2.75)*T+.9375)+A:P*(7.5625*(T-=2.625/2.75)*T+.984375)+A}function ut(T,A,P,D){return T<D/2?st(T*2,0,P,D)*.5+A:ft(T*2-D,0,P,D)*.5+P*.5+A}t.util.ease={easeInQuad:function(T,A,P,D){return P*(T/=D)*T+A},easeOutQuad:function(T,A,P,D){return-P*(T/=D)*(T-2)+A},easeInOutQuad:function(T,A,P,D){return T/=D/2,T<1?P/2*T*T+A:-P/2*(--T*(T-2)-1)+A},easeInCubic:function(T,A,P,D){return P*(T/=D)*T*T+A},easeOutCubic:c,easeInOutCubic:o,easeInQuart:n,easeOutQuart:r,easeInOutQuart:i,easeInQuint:a,easeOutQuint:u,easeInOutQuint:s,easeInSine:d,easeOutSine:g,easeInOutSine:p,easeInExpo:_,easeOutExpo:C,easeInOutExpo:w,easeInCirc:S,easeOutCirc:O,easeInOutCirc:I,easeInElastic:X,easeOutElastic:Q,easeInOutElastic:tt,easeInBack:Y,easeOutBack:U,easeInOutBack:et,easeInBounce:st,easeOutBounce:ft,easeInOutBounce:ut}}(),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.extend,o=e.util.object.clone,n=e.util.toFixed,r=e.util.parseUnit,i=e.util.multiplyTransformMatrices,a=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],u=["symbol","image","marker","pattern","view","svg"],s=["pattern","defs","symbol","metadata","clipPath","mask","desc"],d=["symbol","g","a","svg","clipPath","defs"],g={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},p={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",C="clip-path";e.svgValidTagNamesRegEx=O(a),e.svgViewBoxElementsRegEx=O(u),e.svgInvalidAncestorsRegEx=O(s),e.svgValidParentsRegEx=O(d),e.cssRules={},e.gradientDefs={},e.clipPaths={};function w(E){return E in g?g[E]:E}function S(E,x,M,L){var K=Array.isArray(x),H;if((E==="fill"||E==="stroke")&&x==="none")x="";else{if(E==="strokeUniform")return x==="non-scaling-stroke";if(E==="strokeDashArray")x==="none"?x=null:x=x.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(E==="transformMatrix")M&&M.transformMatrix?x=i(M.transformMatrix,e.parseTransformAttribute(x)):x=e.parseTransformAttribute(x);else if(E==="visible")x=x!=="none"&&x!=="hidden",M&&M.visible===!1&&(x=!1);else if(E==="opacity")x=parseFloat(x),M&&typeof M.opacity<"u"&&(x*=M.opacity);else if(E==="textAnchor")x=x==="start"?"left":x==="end"?"right":"center";else if(E==="charSpacing")H=r(x,L)/L*1e3;else if(E==="paintFirst"){var Z=x.indexOf("fill"),B=x.indexOf("stroke"),x="fill";(Z>-1&&B>-1&&B<Z||Z===-1&&B>-1)&&(x="stroke")}else{if(E==="href"||E==="xlink:href"||E==="font")return x;if(E==="imageSmoothing")return x==="optimizeQuality";H=K?x.map(r):r(x,L)}}return!K&&isNaN(H)?x:H}function O(E){return new RegExp("^("+E.join("|")+")\\b","i")}function I(E){for(var x in p)if(!(typeof E[p[x]]>"u"||E[x]==="")){if(typeof E[x]>"u"){if(!e.Object.prototype[x])continue;E[x]=e.Object.prototype[x]}if(E[x].indexOf("url(")!==0){var M=new e.Color(E[x]);E[x]=M.setAlpha(n(M.getAlpha()*E[p[x]],2)).toRgba()}}return E}function X(E,x){var M,L=[],K,H,Z;for(H=0,Z=x.length;H<Z;H++)M=x[H],K=E.getElementsByTagName(M),L=L.concat(Array.prototype.slice.call(K));return L}e.parseTransformAttribute=function(){function E(F,ct){var q=e.util.cos(ct[0]),pt=e.util.sin(ct[0]),Ot=0,wt=0;ct.length===3&&(Ot=ct[1],wt=ct[2]),F[0]=q,F[1]=pt,F[2]=-pt,F[3]=q,F[4]=Ot-(q*Ot-pt*wt),F[5]=wt-(pt*Ot+q*wt)}function x(F,ct){var q=ct[0],pt=ct.length===2?ct[1]:ct[0];F[0]=q,F[3]=pt}function M(F,ct,q){F[q]=Math.tan(e.util.degreesToRadians(ct[0]))}function L(F,ct){F[4]=ct[0],ct.length===2&&(F[5]=ct[1])}var K=e.iMatrix,H=e.reNum,Z=e.commaWsp,B="(?:(skewX)\\s*\\(\\s*("+H+")\\s*\\))",nt="(?:(skewY)\\s*\\(\\s*("+H+")\\s*\\))",W="(?:(rotate)\\s*\\(\\s*("+H+")(?:"+Z+"("+H+")"+Z+"("+H+"))?\\s*\\))",R="(?:(scale)\\s*\\(\\s*("+H+")(?:"+Z+"("+H+"))?\\s*\\))",G="(?:(translate)\\s*\\(\\s*("+H+")(?:"+Z+"("+H+"))?\\s*\\))",J="(?:(matrix)\\s*\\(\\s*("+H+")"+Z+"("+H+")"+Z+"("+H+")"+Z+"("+H+")"+Z+"("+H+")"+Z+"("+H+")\\s*\\))",N="(?:"+J+"|"+G+"|"+R+"|"+W+"|"+B+"|"+nt+")",$="(?:"+N+"(?:"+Z+"*"+N+")*)",it="^\\s*(?:"+$+"?)\\s*$",mt=new RegExp(it),at=new RegExp(N,"g");return function(F){var ct=K.concat(),q=[];if(!F||F&&!mt.test(F))return ct;F.replace(at,function(Ot){var wt=new RegExp(N).exec(Ot).filter(function(he){return!!he}),Wt=wt[1],It=wt.slice(2).map(parseFloat);switch(Wt){case"translate":L(ct,It);break;case"rotate":It[0]=e.util.degreesToRadians(It[0]),E(ct,It);break;case"scale":x(ct,It);break;case"skewX":M(ct,It,2);break;case"skewY":M(ct,It,1);break;case"matrix":ct=It;break}q.push(ct.concat()),ct=K.concat()});for(var pt=q[0];q.length>1;)q.shift(),pt=e.util.multiplyTransformMatrices(pt,q[0]);return pt}}();function Q(E,x){var M,L;E.replace(/;\s*$/,"").split(";").forEach(function(K){var H=K.split(":");M=H[0].trim().toLowerCase(),L=H[1].trim(),x[M]=L})}function tt(E,x){var M,L;for(var K in E)typeof E[K]>"u"||(M=K.toLowerCase(),L=E[K],x[M]=L)}function Y(E,x){var M={};for(var L in e.cssRules[x])if(U(E,L.split(" ")))for(var K in e.cssRules[x][L])M[K]=e.cssRules[x][L][K];return M}function U(E,x){var M,L=!0;return M=st(E,x.pop()),M&&x.length&&(L=et(E,x)),M&&L&&x.length===0}function et(E,x){for(var M,L=!0;E.parentNode&&E.parentNode.nodeType===1&&x.length;)L&&(M=x.pop()),E=E.parentNode,L=st(E,M);return x.length===0}function st(E,x){var M=E.nodeName,L=E.getAttribute("class"),K=E.getAttribute("id"),H,Z;if(H=new RegExp("^"+M,"i"),x=x.replace(H,""),K&&x.length&&(H=new RegExp("#"+K+"(?![a-zA-Z\\-]+)","i"),x=x.replace(H,"")),L&&x.length)for(L=L.split(" "),Z=L.length;Z--;)H=new RegExp("\\."+L[Z]+"(?![a-zA-Z\\-]+)","i"),x=x.replace(H,"");return x.length===0}function ft(E,x){var M;if(E.getElementById&&(M=E.getElementById(x)),M)return M;var L,K,H,Z=E.getElementsByTagName("*");for(K=0,H=Z.length;K<H;K++)if(L=Z[K],x===L.getAttribute("id"))return L}function ut(E){for(var x=X(E,["use","svg:use"]),M=0;x.length&&M<x.length;){var L=x[M],K=L.getAttribute("xlink:href")||L.getAttribute("href");if(K===null)return;var H=K.slice(1),Z=L.getAttribute("x")||0,B=L.getAttribute("y")||0,nt=ft(E,H).cloneNode(!0),W=(nt.getAttribute("transform")||"")+" translate("+Z+", "+B+")",R,G=x.length,J,N,$,it,mt=e.svgNS;if(A(nt),/^svg$/i.test(nt.nodeName)){var at=nt.ownerDocument.createElementNS(mt,"g");for(N=0,$=nt.attributes,it=$.length;N<it;N++)J=$.item(N),at.setAttributeNS(mt,J.nodeName,J.nodeValue);for(;nt.firstChild;)at.appendChild(nt.firstChild);nt=at}for(N=0,$=L.attributes,it=$.length;N<it;N++)J=$.item(N),!(J.nodeName==="x"||J.nodeName==="y"||J.nodeName==="xlink:href"||J.nodeName==="href")&&(J.nodeName==="transform"?W=J.nodeValue+" "+W:nt.setAttribute(J.nodeName,J.nodeValue));nt.setAttribute("transform",W),nt.setAttribute("instantiated_by_use","1"),nt.removeAttribute("id"),R=L.parentNode,R.replaceChild(nt,L),x.length===G&&M++}}var T=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function A(E){if(!e.svgViewBoxElementsRegEx.test(E.nodeName))return{};var x=E.getAttribute("viewBox"),M=1,L=1,K=0,H=0,Z,B,nt,W,R=E.getAttribute("width"),G=E.getAttribute("height"),J=E.getAttribute("x")||0,N=E.getAttribute("y")||0,$=E.getAttribute("preserveAspectRatio")||"",it=!x||!(x=x.match(T)),mt=!R||!G||R==="100%"||G==="100%",at=it&&mt,F={},ct="",q=0,pt=0;if(F.width=0,F.height=0,F.toBeParsed=at,it&&(J||N)&&E.parentNode&&E.parentNode.nodeName!=="#document"&&(ct=" translate("+r(J)+" "+r(N)+") ",nt=(E.getAttribute("transform")||"")+ct,E.setAttribute("transform",nt),E.removeAttribute("x"),E.removeAttribute("y")),at)return F;if(it)return F.width=r(R),F.height=r(G),F;if(K=-parseFloat(x[1]),H=-parseFloat(x[2]),Z=parseFloat(x[3]),B=parseFloat(x[4]),F.minX=K,F.minY=H,F.viewBoxWidth=Z,F.viewBoxHeight=B,mt?(F.width=Z,F.height=B):(F.width=r(R),F.height=r(G),M=F.width/Z,L=F.height/B),$=e.util.parsePreserveAspectRatioAttribute($),$.alignX!=="none"&&($.meetOrSlice==="meet"&&(L=M=M>L?L:M),$.meetOrSlice==="slice"&&(L=M=M>L?M:L),q=F.width-Z*M,pt=F.height-B*M,$.alignX==="Mid"&&(q/=2),$.alignY==="Mid"&&(pt/=2),$.alignX==="Min"&&(q=0),$.alignY==="Min"&&(pt=0)),M===1&&L===1&&K===0&&H===0&&J===0&&N===0)return F;if((J||N)&&E.parentNode.nodeName!=="#document"&&(ct=" translate("+r(J)+" "+r(N)+") "),nt=ct+" matrix("+M+" 0 0 "+L+" "+(K*M+q)+" "+(H*L+pt)+") ",E.nodeName==="svg"){for(W=E.ownerDocument.createElementNS(e.svgNS,"g");E.firstChild;)W.appendChild(E.firstChild);E.appendChild(W)}else W=E,W.removeAttribute("x"),W.removeAttribute("y"),nt=W.getAttribute("transform")+nt;return W.setAttribute("transform",nt),F}function P(E,x){for(;E&&(E=E.parentNode);)if(E.nodeName&&x.test(E.nodeName.replace("svg:",""))&&!E.getAttribute("instantiated_by_use"))return!0;return!1}e.parseSVGDocument=function(E,x,M,L){if(E){ut(E);var K=e.Object.__uid++,H,Z,B=A(E),nt=e.util.toArray(E.getElementsByTagName("*"));if(B.crossOrigin=L&&L.crossOrigin,B.svgUid=K,nt.length===0&&e.isLikelyNode){nt=E.selectNodes('//*[name(.)!="svg"]');var W=[];for(H=0,Z=nt.length;H<Z;H++)W[H]=nt[H];nt=W}var R=nt.filter(function(J){return A(J),e.svgValidTagNamesRegEx.test(J.nodeName.replace("svg:",""))&&!P(J,e.svgInvalidAncestorsRegEx)});if(!R||R&&!R.length){x&&x([],{});return}var G={};nt.filter(function(J){return J.nodeName.replace("svg:","")==="clipPath"}).forEach(function(J){var N=J.getAttribute("id");G[N]=e.util.toArray(J.getElementsByTagName("*")).filter(function($){return e.svgValidTagNamesRegEx.test($.nodeName.replace("svg:",""))})}),e.gradientDefs[K]=e.getGradientDefs(E),e.cssRules[K]=e.getCSSRules(E),e.clipPaths[K]=G,e.parseElements(R,function(J,N){x&&(x(J,B,N,nt),delete e.gradientDefs[K],delete e.cssRules[K],delete e.clipPaths[K])},o(B),M,L)}};function D(E,x){var M=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],L="xlink:href",K=x.getAttribute(L).slice(1),H=ft(E,K);if(H&&H.getAttribute(L)&&D(E,H),M.forEach(function(B){H&&!x.hasAttribute(B)&&H.hasAttribute(B)&&x.setAttribute(B,H.getAttribute(B))}),!x.children.length)for(var Z=H.cloneNode(!0);Z.firstChild;)x.appendChild(Z.firstChild);x.removeAttribute(L)}var z=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");c(e,{parseFontDeclaration:function(E,x){var M=E.match(z);if(M){var L=M[1],K=M[3],H=M[4],Z=M[5],B=M[6];L&&(x.fontStyle=L),K&&(x.fontWeight=isNaN(parseFloat(K))?K:parseFloat(K)),H&&(x.fontSize=r(H)),B&&(x.fontFamily=B),Z&&(x.lineHeight=Z==="normal"?1:Z)}},getGradientDefs:function(E){var x=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],M=X(E,x),L,K=0,H={};for(K=M.length;K--;)L=M[K],L.getAttribute("xlink:href")&&D(E,L),H[L.getAttribute("id")]=L;return H},parseAttributes:function(E,x,M){if(E){var L,K={},H,Z;typeof M>"u"&&(M=E.getAttribute("svgUid")),E.parentNode&&e.svgValidParentsRegEx.test(E.parentNode.nodeName)&&(K=e.parseAttributes(E.parentNode,x,M));var B=x.reduce(function($,it){return L=E.getAttribute(it),L&&($[it]=L),$},{}),nt=c(Y(E,M),e.parseStyleAttribute(E));B=c(B,nt),nt[C]&&E.setAttribute(C,nt[C]),H=Z=K.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,B[_]&&(B[_]=H=r(B[_],Z));var W,R,G={};for(var J in B)W=w(J),R=S(W,B[J],K,H),G[W]=R;G&&G.font&&e.parseFontDeclaration(G.font,G);var N=c(K,G);return e.svgValidParentsRegEx.test(E.nodeName)?N:I(N)}},parseElements:function(E,x,M,L,K){new e.ElementsParser(E,x,M,L,K).parse()},parseStyleAttribute:function(E){var x={},M=E.getAttribute("style");return M&&(typeof M=="string"?Q(M,x):tt(M,x)),x},parsePointsAttribute:function(E){if(!E)return null;E=E.replace(/,/g," ").trim(),E=E.split(/\s+/);var x=[],M,L;for(M=0,L=E.length;M<L;M+=2)x.push({x:parseFloat(E[M]),y:parseFloat(E[M+1])});return x},getCSSRules:function(E){var x=E.getElementsByTagName("style"),M,L,K={},H;for(M=0,L=x.length;M<L;M++){var Z=x[M].textContent;Z=Z.replace(/\/\*[\s\S]*?\*\//g,""),Z.trim()!==""&&(H=Z.split("}"),H=H.filter(function(B){return B.trim()}),H.forEach(function(B){var nt=B.split("{"),W={},R=nt[1].trim(),G=R.split(";").filter(function(it){return it.trim()});for(M=0,L=G.length;M<L;M++){var J=G[M].split(":"),N=J[0].trim(),$=J[1].trim();W[N]=$}B=nt[0].trim(),B.split(",").forEach(function(it){it=it.replace(/^svg/i,"").trim(),it!==""&&(K[it]?e.util.object.extend(K[it],W):K[it]=e.util.object.clone(W))})}))}return K},loadSVGFromURL:function(E,x,M,L){E=E.replace(/^\n\s*/,"").trim(),new e.util.request(E,{method:"get",onComplete:K});function K(H){var Z=H.responseXML;if(!Z||!Z.documentElement)return x&&x(null),!1;e.parseSVGDocument(Z.documentElement,function(B,nt,W,R){x&&x(B,nt,W,R)},M,L)}},loadSVGFromString:function(E,x,M,L){var K=new e.window.DOMParser,H=K.parseFromString(E.trim(),"text/xml");e.parseSVGDocument(H.documentElement,function(Z,B,nt,W){x(Z,B,nt,W)},M,L)}})}(l),t.ElementsParser=function(h,e,c,o,n,r){this.elements=h,this.callback=e,this.options=c,this.reviver=o,this.svgUid=c&&c.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=r},function(h){h.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},h.createObjects=function(){var e=this;this.elements.forEach(function(c,o){c.setAttribute("svgUid",e.svgUid),e.createObject(c,o)})},h.findTag=function(e){return t[t.util.string.capitalize(e.tagName.replace("svg:",""))]},h.createObject=function(e,c){var o=this.findTag(e);if(o&&o.fromElement)try{o.fromElement(e,this.createCallback(c,e),this.options)}catch(n){t.log(n)}else this.checkIfDone()},h.createCallback=function(e,c){var o=this;return function(n){var r;o.resolveGradient(n,c,"fill"),o.resolveGradient(n,c,"stroke"),n instanceof t.Image&&n._originalElement&&(r=n.parsePreserveAspectRatioAttribute(c)),n._removeTransformMatrix(r),o.resolveClipPath(n,c),o.reviver&&o.reviver(c,n),o.instances[e]=n,o.checkIfDone()}},h.extractPropertyDefinition=function(e,c,o){var n=e[c],r=this.regexUrl;if(r.test(n)){r.lastIndex=0;var i=r.exec(n)[1];return r.lastIndex=0,t[o][this.svgUid][i]}},h.resolveGradient=function(e,c,o){var n=this.extractPropertyDefinition(e,o,"gradientDefs");if(n){var r=c.getAttribute(o+"-opacity"),i=t.Gradient.fromElement(n,e,r,this.options);e.set(o,i)}},h.createClipPathCallback=function(e,c){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,c.push(o)}},h.resolveClipPath=function(e,c){var o=this.extractPropertyDefinition(e,"clipPath","clipPaths"),n,r,i,a,u,s;if(o){a=[],i=t.util.invertTransform(e.calcTransformMatrix());for(var d=o[0].parentNode,g=c;g.parentNode&&g.getAttribute("clip-path")!==e.clipPath;)g=g.parentNode;g.parentNode.appendChild(d);for(var p=0;p<o.length;p++)n=o[p],r=this.findTag(n),r.fromElement(n,this.createClipPathCallback(e,a),this.options);a.length===1?o=a[0]:o=new t.Group(a),u=t.util.multiplyTransformMatrices(i,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,g);var s=t.util.qrDecompose(u);o.flipX=!1,o.flipY=!1,o.set("scaleX",s.scaleX),o.set("scaleY",s.scaleY),o.angle=s.angle,o.skewX=s.skewX,o.skewY=0,o.setPositionByOrigin({x:s.translateX,y:s.translateY},"center","center"),e.clipPath=o}else delete e.clipPath},h.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(e){return e!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(h){var e=h.fabric||(h.fabric={});if(e.Point){e.warn("fabric.Point is already defined");return}e.Point=c;function c(o,n){this.x=o,this.y=n}c.prototype={type:"point",constructor:c,add:function(o){return new c(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new c(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new c(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new c(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new c(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new c(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,n){return typeof n>"u"&&(n=.5),n=Math.max(Math.min(1,n),0),new c(this.x+(o.x-this.x)*n,this.y+(o.y-this.y)*n)},distanceFrom:function(o){var n=this.x-o.x,r=this.y-o.y;return Math.sqrt(n*n+r*r)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new c(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new c(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,n){return this.x=o,this.y=n,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var n=this.x,r=this.y;this.x=o.x,this.y=o.y,o.x=n,o.y=r},clone:function(){return new c(this.x,this.y)}}}(l),function(h){var e=h.fabric||(h.fabric={});if(e.Intersection){e.warn("fabric.Intersection is already defined");return}function c(o){this.status=o,this.points=[]}e.Intersection=c,e.Intersection.prototype={constructor:c,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},e.Intersection.intersectLineLine=function(o,n,r,i){var a,u=(i.x-r.x)*(o.y-r.y)-(i.y-r.y)*(o.x-r.x),s=(n.x-o.x)*(o.y-r.y)-(n.y-o.y)*(o.x-r.x),d=(i.y-r.y)*(n.x-o.x)-(i.x-r.x)*(n.y-o.y);if(d!==0){var g=u/d,p=s/d;0<=g&&g<=1&&0<=p&&p<=1?(a=new c("Intersection"),a.appendPoint(new e.Point(o.x+g*(n.x-o.x),o.y+g*(n.y-o.y)))):a=new c}else u===0||s===0?a=new c("Coincident"):a=new c("Parallel");return a},e.Intersection.intersectLinePolygon=function(o,n,r){var i=new c,a=r.length,u,s,d,g;for(g=0;g<a;g++)u=r[g],s=r[(g+1)%a],d=c.intersectLineLine(o,n,u,s),i.appendPoints(d.points);return i.points.length>0&&(i.status="Intersection"),i},e.Intersection.intersectPolygonPolygon=function(o,n){var r=new c,i=o.length,a;for(a=0;a<i;a++){var u=o[a],s=o[(a+1)%i],d=c.intersectLinePolygon(u,s,n);r.appendPoints(d.points)}return r.points.length>0&&(r.status="Intersection"),r},e.Intersection.intersectPolygonRectangle=function(o,n,r){var i=n.min(r),a=n.max(r),u=new e.Point(a.x,i.y),s=new e.Point(i.x,a.y),d=c.intersectLinePolygon(i,u,o),g=c.intersectLinePolygon(u,a,o),p=c.intersectLinePolygon(a,s,o),_=c.intersectLinePolygon(s,i,o),C=new c;return C.appendPoints(d.points),C.appendPoints(g.points),C.appendPoints(p.points),C.appendPoints(_.points),C.points.length>0&&(C.status="Intersection"),C}}(l),function(h){var e=h.fabric||(h.fabric={});if(e.Color){e.warn("fabric.Color is already defined.");return}function c(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}e.Color=c,e.Color.prototype={_tryParsingColor:function(n){var r;n in c.colorNameMap&&(n=c.colorNameMap[n]),n==="transparent"&&(r=[255,255,255,0]),r||(r=c.sourceFromHex(n)),r||(r=c.sourceFromRgb(n)),r||(r=c.sourceFromHsl(n)),r||(r=[0,0,0,1]),r&&this.setSource(r)},_rgbToHsl:function(n,r,i){n/=255,r/=255,i/=255;var a,u,s,d=e.util.array.max([n,r,i]),g=e.util.array.min([n,r,i]);if(s=(d+g)/2,d===g)a=u=0;else{var p=d-g;switch(u=s>.5?p/(2-d-g):p/(d+g),d){case n:a=(r-i)/p+(r<i?6:0);break;case r:a=(i-n)/p+2;break;case i:a=(n-r)/p+4;break}a/=6}return[Math.round(a*360),Math.round(u*100),Math.round(s*100)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),r=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+r[0]+","+r[1]+"%,"+r[2]+"%)"},toHsla:function(){var n=this.getSource(),r=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+r[0]+","+r[1]+"%,"+r[2]+"%,"+n[3]+")"},toHex:function(){var n=this.getSource(),r,i,a;return r=n[0].toString(16),r=r.length===1?"0"+r:r,i=n[1].toString(16),i=i.length===1?"0"+i:i,a=n[2].toString(16),a=a.length===1?"0"+a:a,r.toUpperCase()+i.toUpperCase()+a.toUpperCase()},toHexa:function(){var n=this.getSource(),r;return r=Math.round(n[3]*255),r=r.toString(16),r=r.length===1?"0"+r:r,this.toHex()+r.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var r=this.getSource();return r[3]=n,this.setSource(r),this},toGrayscale:function(){var n=this.getSource(),r=parseInt((n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),10),i=n[3];return this.setSource([r,r,r,i]),this},toBlackWhite:function(n){var r=this.getSource(),i=(r[0]*.3+r[1]*.59+r[2]*.11).toFixed(0),a=r[3];return n=n||127,i=Number(i)<Number(n)?0:255,this.setSource([i,i,i,a]),this},overlayWith:function(n){n instanceof c||(n=new c(n));var r=[],i=this.getAlpha(),a=.5,u=this.getSource(),s=n.getSource(),d;for(d=0;d<3;d++)r.push(Math.round(u[d]*(1-a)+s[d]*a));return r[3]=i,this.setSource(r),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(n,r,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?n+(r-n)*6*i:i<1/2?r:i<2/3?n+(r-n)*(2/3-i)*6:n}e.Color.fromRgb=function(n){return c.fromSource(c.sourceFromRgb(n))},e.Color.sourceFromRgb=function(n){var r=n.match(c.reRGBa);if(r){var i=parseInt(r[1],10)/(/%$/.test(r[1])?100:1)*(/%$/.test(r[1])?255:1),a=parseInt(r[2],10)/(/%$/.test(r[2])?100:1)*(/%$/.test(r[2])?255:1),u=parseInt(r[3],10)/(/%$/.test(r[3])?100:1)*(/%$/.test(r[3])?255:1);return[parseInt(i,10),parseInt(a,10),parseInt(u,10),r[4]?parseFloat(r[4]):1]}},e.Color.fromRgba=c.fromRgb,e.Color.fromHsl=function(n){return c.fromSource(c.sourceFromHsl(n))},e.Color.sourceFromHsl=function(n){var r=n.match(c.reHSLa);if(r){var i=(parseFloat(r[1])%360+360)%360/360,a=parseFloat(r[2])/(/%$/.test(r[2])?100:1),u=parseFloat(r[3])/(/%$/.test(r[3])?100:1),s,d,g;if(a===0)s=d=g=u;else{var p=u<=.5?u*(a+1):u+a-u*a,_=u*2-p;s=o(_,p,i+1/3),d=o(_,p,i),g=o(_,p,i-1/3)}return[Math.round(s*255),Math.round(d*255),Math.round(g*255),r[4]?parseFloat(r[4]):1]}},e.Color.fromHsla=c.fromHsl,e.Color.fromHex=function(n){return c.fromSource(c.sourceFromHex(n))},e.Color.sourceFromHex=function(n){if(n.match(c.reHex)){var r=n.slice(n.indexOf("#")+1),i=r.length===3||r.length===4,a=r.length===8||r.length===4,u=i?r.charAt(0)+r.charAt(0):r.substring(0,2),s=i?r.charAt(1)+r.charAt(1):r.substring(2,4),d=i?r.charAt(2)+r.charAt(2):r.substring(4,6),g=a?i?r.charAt(3)+r.charAt(3):r.substring(6,8):"FF";return[parseInt(u,16),parseInt(s,16),parseInt(d,16),parseFloat((parseInt(g,16)/255).toFixed(2))]}},e.Color.fromSource=function(n){var r=new c;return r.setSource(n),r}}(l),function(h){var e=h.fabric||(h.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],n={},r="left",i="top",a="right",u="bottom",s="center",d={top:u,bottom:i,left:a,right:r,center:s},g=e.util.radiansToDegrees,p=Math.sign||function(W){return(W>0)-(W<0)||+W};function _(W,R){var G=W.angle+g(Math.atan2(R.y,R.x))+360;return Math.round(G%360/45)}function C(W,R){var G=R.transform.target,J=G.canvas,N=e.util.object.clone(R);N.target=G,J&&J.fire("object:"+W,N),G.fire(W,R)}function w(W,R){var G=R.canvas,J=G.uniScaleKey,N=W[J];return G.uniformScaling&&!N||!G.uniformScaling&&N}function S(W){return W.originX===s&&W.originY===s}function O(W,R,G){var J=W.lockScalingX,N=W.lockScalingY;return!!(J&&N||!R&&(J||N)&&G||J&&R==="x"||N&&R==="y")}function I(W,R,G){var J="not-allowed",N=w(W,G),$="";if(R.x!==0&&R.y===0?$="x":R.x===0&&R.y!==0&&($="y"),O(G,$,N))return J;var it=_(G,R);return c[it]+"-resize"}function X(W,R,G){var J="not-allowed";if(R.x!==0&&G.lockSkewingY||R.y!==0&&G.lockSkewingX)return J;var N=_(G,R)%4;return o[N]+"-resize"}function Q(W,R,G){return W[G.canvas.altActionKey]?n.skewCursorStyleHandler(W,R,G):n.scaleCursorStyleHandler(W,R,G)}function tt(W,R,G){var J=W[G.canvas.altActionKey];if(R.x===0)return J?"skewX":"scaleY";if(R.y===0)return J?"skewY":"scaleX"}function Y(W,R,G){return G.lockRotation?"not-allowed":R.cursorStyle}function U(W,R,G,J){return{e:W,transform:R,pointer:{x:G,y:J}}}function et(W){return function(R,G,J,N){var $=G.target,it=$.getCenterPoint(),mt=$.translateToOriginPoint(it,G.originX,G.originY),at=W(R,G,J,N);return $.setPositionByOrigin(mt,G.originX,G.originY),at}}function st(W,R){return function(G,J,N,$){var it=R(G,J,N,$);return it&&C(W,U(G,J,N,$)),it}}function ft(W,R,G,J,N){var $=W.target,it=$.controls[W.corner],mt=$.canvas.getZoom(),at=$.padding/mt,F=$.toLocalPoint(new e.Point(J,N),R,G);return F.x>=at&&(F.x-=at),F.x<=-at&&(F.x+=at),F.y>=at&&(F.y-=at),F.y<=at&&(F.y+=at),F.x-=it.offsetX,F.y-=it.offsetY,F}function ut(W){return W.flipX!==W.flipY}function T(W,R,G,J,N){if(W[R]!==0){var $=W._getTransformedDimensions()[J],it=N/$*W[G];W.set(G,it)}}function A(W,R,G,J){var N=R.target,$=N._getTransformedDimensions(0,N.skewY),it=ft(R,R.originX,R.originY,G,J),mt=Math.abs(it.x*2)-$.x,at=N.skewX,F;mt<2?F=0:(F=g(Math.atan2(mt/N.scaleX,$.y/N.scaleY)),R.originX===r&&R.originY===u&&(F=-F),R.originX===a&&R.originY===i&&(F=-F),ut(N)&&(F=-F));var ct=at!==F;if(ct){var q=N._getTransformedDimensions().y;N.set("skewX",F),T(N,"skewY","scaleY","y",q)}return ct}function P(W,R,G,J){var N=R.target,$=N._getTransformedDimensions(N.skewX,0),it=ft(R,R.originX,R.originY,G,J),mt=Math.abs(it.y*2)-$.y,at=N.skewY,F;mt<2?F=0:(F=g(Math.atan2(mt/N.scaleY,$.x/N.scaleX)),R.originX===r&&R.originY===u&&(F=-F),R.originX===a&&R.originY===i&&(F=-F),ut(N)&&(F=-F));var ct=at!==F;if(ct){var q=N._getTransformedDimensions().x;N.set("skewY",F),T(N,"skewX","scaleX","x",q)}return ct}function D(W,R,G,J){var N=R.target,$=N.skewX,it,mt=R.originY;if(N.lockSkewingX)return!1;if($===0){var at=ft(R,s,s,G,J);at.x>0?it=r:it=a}else $>0&&(it=mt===i?r:a),$<0&&(it=mt===i?a:r),ut(N)&&(it=it===r?a:r);R.originX=it;var F=st("skewing",et(A));return F(W,R,G,J)}function z(W,R,G,J){var N=R.target,$=N.skewY,it,mt=R.originX;if(N.lockSkewingY)return!1;if($===0){var at=ft(R,s,s,G,J);at.y>0?it=i:it=u}else $>0&&(it=mt===r?i:u),$<0&&(it=mt===r?u:i),ut(N)&&(it=it===i?u:i);R.originY=it;var F=st("skewing",et(P));return F(W,R,G,J)}function E(W,R,G,J){var N=R,$=N.target,it=$.translateToOriginPoint($.getCenterPoint(),N.originX,N.originY);if($.lockRotation)return!1;var mt=Math.atan2(N.ey-it.y,N.ex-it.x),at=Math.atan2(J-it.y,G-it.x),F=g(at-mt+N.theta),ct=!0;if($.snapAngle>0){var q=$.snapAngle,pt=$.snapThreshold||q,Ot=Math.ceil(F/q)*q,wt=Math.floor(F/q)*q;Math.abs(F-wt)<pt?F=wt:Math.abs(F-Ot)<pt&&(F=Ot)}return F<0&&(F=360+F),F%=360,ct=$.angle!==F,$.angle=F,ct}function x(W,R,G,J,N){N=N||{};var $=R.target,it=$.lockScalingX,mt=$.lockScalingY,at=N.by,F,ct,q,pt,Ot=w(W,$),wt=O($,at,Ot),Wt,It,he=R.gestureScale;if(wt)return!1;if(he)ct=R.scaleX*he,q=R.scaleY*he;else{if(F=ft(R,R.originX,R.originY,G,J),Wt=at!=="y"?p(F.x):1,It=at!=="x"?p(F.y):1,R.signX||(R.signX=Wt),R.signY||(R.signY=It),$.lockScalingFlip&&(R.signX!==Wt||R.signY!==It))return!1;if(pt=$._getTransformedDimensions(),Ot&&!at){var Ae=Math.abs(F.x)+Math.abs(F.y),Kt=R.original,Is=Math.abs(pt.x*Kt.scaleX/$.scaleX)+Math.abs(pt.y*Kt.scaleY/$.scaleY),Zi=Ae/Is;ct=Kt.scaleX*Zi,q=Kt.scaleY*Zi}else ct=Math.abs(F.x*$.scaleX/pt.x),q=Math.abs(F.y*$.scaleY/pt.y);S(R)&&(ct*=2,q*=2),R.signX!==Wt&&at!=="y"&&(R.originX=d[R.originX],ct*=-1,R.signX=Wt),R.signY!==It&&at!=="x"&&(R.originY=d[R.originY],q*=-1,R.signY=It)}var Ms=$.scaleX,Fs=$.scaleY;return at?(at==="x"&&$.set("scaleX",ct),at==="y"&&$.set("scaleY",q)):(!it&&$.set("scaleX",ct),!mt&&$.set("scaleY",q)),Ms!==$.scaleX||Fs!==$.scaleY}function M(W,R,G,J){return x(W,R,G,J)}function L(W,R,G,J){return x(W,R,G,J,{by:"x"})}function K(W,R,G,J){return x(W,R,G,J,{by:"y"})}function H(W,R,G,J){return W[R.target.canvas.altActionKey]?n.skewHandlerX(W,R,G,J):n.scalingY(W,R,G,J)}function Z(W,R,G,J){return W[R.target.canvas.altActionKey]?n.skewHandlerY(W,R,G,J):n.scalingX(W,R,G,J)}function B(W,R,G,J){var N=R.target,$=ft(R,R.originX,R.originY,G,J),it=N.strokeWidth/(N.strokeUniform?N.scaleX:1),mt=S(R)?2:1,at=N.width,F=Math.abs($.x*mt/N.scaleX)-it;return N.set("width",Math.max(F,0)),at!==F}function nt(W,R,G,J){var N=R.target,$=G-R.offsetX,it=J-R.offsetY,mt=!N.get("lockMovementX")&&N.left!==$,at=!N.get("lockMovementY")&&N.top!==it;return mt&&N.set("left",$),at&&N.set("top",it),(mt||at)&&C("moving",U(W,R,G,J)),mt||at}n.scaleCursorStyleHandler=I,n.skewCursorStyleHandler=X,n.scaleSkewCursorStyleHandler=Q,n.rotationWithSnapping=st("rotating",et(E)),n.scalingEqually=st("scaling",et(M)),n.scalingX=st("scaling",et(L)),n.scalingY=st("scaling",et(K)),n.scalingYOrSkewingX=H,n.scalingXOrSkewingY=Z,n.changeWidth=st("resizing",et(B)),n.skewHandlerX=D,n.skewHandlerY=z,n.dragHandler=nt,n.scaleOrSkewActionName=tt,n.rotationStyleHandler=Y,n.fireEvent=C,n.wrapWithFixedAnchor=et,n.wrapWithFireEvent=st,n.getLocalPoint=ft,e.controlsUtils=n}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.degreesToRadians,o=e.controlsUtils;function n(i,a,u,s,d){s=s||{};var g=this.sizeX||s.cornerSize||d.cornerSize,p=this.sizeY||s.cornerSize||d.cornerSize,_=typeof s.transparentCorners<"u"?s.transparentCorners:d.transparentCorners,C=_?"stroke":"fill",w=!_&&(s.cornerStrokeColor||d.cornerStrokeColor),S=a,O=u,I;i.save(),i.fillStyle=s.cornerColor||d.cornerColor,i.strokeStyle=s.cornerStrokeColor||d.cornerStrokeColor,g>p?(I=g,i.scale(1,p/g),O=u*g/p):p>g?(I=p,i.scale(g/p,1),S=a*p/g):I=g,i.lineWidth=1,i.beginPath(),i.arc(S,O,I/2,0,2*Math.PI,!1),i[C](),w&&i.stroke(),i.restore()}function r(i,a,u,s,d){s=s||{};var g=this.sizeX||s.cornerSize||d.cornerSize,p=this.sizeY||s.cornerSize||d.cornerSize,_=typeof s.transparentCorners<"u"?s.transparentCorners:d.transparentCorners,C=_?"stroke":"fill",w=!_&&(s.cornerStrokeColor||d.cornerStrokeColor),S=g/2,O=p/2;i.save(),i.fillStyle=s.cornerColor||d.cornerColor,i.strokeStyle=s.cornerStrokeColor||d.cornerStrokeColor,i.lineWidth=1,i.translate(a,u),i.rotate(c(d.angle)),i[C+"Rect"](-S,-O,g,p),w&&i.strokeRect(-S,-O,g,p),i.restore()}o.renderCircleControl=n,o.renderSquareControl=r}(l),function(h){var e=h.fabric||(h.fabric={});function c(o){for(var n in o)this[n]=o[n]}e.Control=c,e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,n){return n.cursorStyle},getActionName:function(o,n){return n.actionName},getVisibility:function(o,n){var r=o._controlsVisibility;return r&&typeof r[n]<"u"?r[n]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,n){var r=e.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},n);return r},calcCornerCoords:function(o,n,r,i,a){var u,s,d,g,p=a?this.touchSizeX:this.sizeX,_=a?this.touchSizeY:this.sizeY;if(p&&_&&p!==_){var C=Math.atan2(_,p),w=Math.sqrt(p*p+_*_)/2,S=C-e.util.degreesToRadians(o),O=Math.PI/2-C-e.util.degreesToRadians(o);u=w*e.util.cos(S),s=w*e.util.sin(S),d=w*e.util.cos(O),g=w*e.util.sin(O)}else{var I=p&&_?p:n;w=I*.7071067812;var S=e.util.degreesToRadians(45-o);u=d=w*e.util.cos(S),s=g=w*e.util.sin(S)}return{tl:{x:r-g,y:i-d},tr:{x:r+u,y:i-s},bl:{x:r-u,y:i+s},br:{x:r+g,y:i+d}}},render:function(o,n,r,i,a){switch(i=i||{},i.cornerStyle||a.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,o,n,r,i,a);break;default:e.controlsUtils.renderSquareControl.call(this,o,n,r,i,a)}}}}(l),function(){function h(r,i){var a=r.getAttribute("style"),u=r.getAttribute("offset")||0,s,d,g,p;if(u=parseFloat(u)/(/%$/.test(u)?100:1),u=u<0?0:u>1?1:u,a){var _=a.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),p=_.length;p--;){var C=_[p].split(/\s*:\s*/),w=C[0].trim(),S=C[1].trim();w==="stop-color"?s=S:w==="stop-opacity"&&(g=S)}}return s||(s=r.getAttribute("stop-color")||"rgb(0,0,0)"),g||(g=r.getAttribute("stop-opacity")),s=new t.Color(s),d=s.getAlpha(),g=isNaN(parseFloat(g))?1:parseFloat(g),g*=d*i,{offset:u,color:s.toRgb(),opacity:g}}function e(r){return{x1:r.getAttribute("x1")||0,y1:r.getAttribute("y1")||0,x2:r.getAttribute("x2")||"100%",y2:r.getAttribute("y2")||0}}function c(r){return{x1:r.getAttribute("fx")||r.getAttribute("cx")||"50%",y1:r.getAttribute("fy")||r.getAttribute("cy")||"50%",r1:0,x2:r.getAttribute("cx")||"50%",y2:r.getAttribute("cy")||"50%",r2:r.getAttribute("r")||"50%"}}var o=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(r){r||(r={}),r.coords||(r.coords={});var i,a=this;Object.keys(r).forEach(function(u){a[u]=r[u]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,i={x1:r.coords.x1||0,y1:r.coords.y1||0,x2:r.coords.x2||0,y2:r.coords.y2||0},this.type==="radial"&&(i.r1=r.coords.r1||0,i.r2=r.coords.r2||0),this.coords=i,this.colorStops=r.colorStops.slice()},addColorStop:function(r){for(var i in r){var a=new t.Color(r[i]);this.colorStops.push({offset:parseFloat(i),color:a.toRgb(),opacity:a.getAlpha()})}return this},toObject:function(r){var i={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,i,r),i},toSVG:function(r,d){var a=o(this.coords,!0),u,s,d=d||{},g,p,_=o(this.colorStops,!0),C=a.r1>a.r2,w=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),S=-this.offsetX,O=-this.offsetY,I=!!d.additionalTransform,X=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(et,st){return et.offset-st.offset}),X==="objectBoundingBox"?(S/=r.width,O/=r.height):(S+=r.width/2,O+=r.height/2),r.type==="path"&&this.gradientUnits!=="percentage"&&(S-=r.pathOffset.x,O-=r.pathOffset.y),w[4]-=S,w[5]-=O,p='id="SVGID_'+this.id+'" gradientUnits="'+X+'"',p+=' gradientTransform="'+(I?d.additionalTransform+" ":"")+t.util.matrixToSVG(w)+'" ',this.type==="linear"?g=["<linearGradient ",p,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`">
`]:this.type==="radial"&&(g=["<radialGradient ",p,' cx="',C?a.x1:a.x2,'" cy="',C?a.y1:a.y2,'" r="',C?a.r1:a.r2,'" fx="',C?a.x2:a.x1,'" fy="',C?a.y2:a.y1,`">
`]),this.type==="radial"){if(C)for(_=_.concat(),_.reverse(),u=0,s=_.length;u<s;u++)_[u].offset=1-_[u].offset;var Q=Math.min(a.r1,a.r2);if(Q>0){var tt=Math.max(a.r1,a.r2),Y=Q/tt;for(u=0,s=_.length;u<s;u++)_[u].offset+=Y*(1-_[u].offset)}}for(u=0,s=_.length;u<s;u++){var U=_[u];g.push("<stop ",'offset="',U.offset*100+"%",'" style="stop-color:',U.color,typeof U.opacity<"u"?";stop-opacity: "+U.opacity:";",`"/>
`)}return g.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),g.join("")},toLive:function(r){var i,a=t.util.object.clone(this.coords),u,s;if(this.type){for(this.type==="linear"?i=r.createLinearGradient(a.x1,a.y1,a.x2,a.y2):this.type==="radial"&&(i=r.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2)),u=0,s=this.colorStops.length;u<s;u++){var d=this.colorStops[u].color,g=this.colorStops[u].opacity,p=this.colorStops[u].offset;typeof g<"u"&&(d=new t.Color(d).setAlpha(g).toRgba()),i.addColorStop(p,d)}return i}}}),t.util.object.extend(t.Gradient,{fromElement:function(r,i,a,u){var s=parseFloat(a)/(/%$/.test(a)?100:1);s=s<0?0:s>1?1:s,isNaN(s)&&(s=1);var d=r.getElementsByTagName("stop"),g,p=r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=r.getAttribute("gradientTransform")||"",C=[],w,S,O=0,I=0,X;for(r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?(g="linear",w=e(r)):(g="radial",w=c(r)),S=d.length;S--;)C.push(h(d[S],s));X=t.parseTransformAttribute(_),n(i,w,u,p),p==="pixels"&&(O=-i.left,I=-i.top);var Q=new t.Gradient({id:r.getAttribute("id"),type:g,coords:w,colorStops:C,gradientUnits:p,gradientTransform:X,offsetX:O,offsetY:I});return Q}});function n(r,i,a,u){var s,d;Object.keys(i).forEach(function(g){s=i[g],s==="Infinity"?d=1:s==="-Infinity"?d=0:(d=parseFloat(i[g],10),typeof s=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(s)&&(d*=.01,u==="pixels"&&((g==="x1"||g==="x2"||g==="r2")&&(d*=a.viewBoxWidth||a.width),(g==="y1"||g==="y2")&&(d*=a.viewBoxHeight||a.height)))),i[g]=d})}}(),function(){var h=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,c){if(e||(e={}),this.id=t.Object.__uid++,this.setOptions(e),!e.source||e.source&&typeof e.source!="string"){c&&c(this);return}else{var o=this;this.source=t.util.createImage(),t.util.loadImage(e.source,function(n,r){o.source=n,c&&c(o,r)},null,this.crossOrigin)}},toObject:function(e){var c=t.Object.NUM_FRACTION_DIGITS,o,n;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),n={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:h(this.offsetX,c),offsetY:h(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,n,e),n},toSVG:function(e){var c=typeof this.source=="function"?this.source():this.source,o=c.width/e.width,n=c.height/e.height,r=this.offsetX/e.width,i=this.offsetY/e.height,a="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(n=1,i&&(n+=Math.abs(i))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,r&&(o+=Math.abs(r))),c.src?a=c.src:c.toDataURL&&(a=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+r+'" y="'+i+'" width="'+o+'" height="'+n+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+a+`"></image>
</pattern>
`},setOptions:function(e){for(var c in e)this[c]=e[c]},toLive:function(e){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":e.createPattern(c,this.repeat)}})}(),function(h){var e=h.fabric||(h.fabric={}),c=e.util.toFixed;if(e.Shadow){e.warn("fabric.Shadow is already defined.");return}e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var n in o)this[n]=o[n];this.id=e.Object.__uid++},_parseShadow:function(o){var n=o.trim(),r=e.Shadow.reOffsetsAndBlur.exec(n)||[],i=n.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:i.trim(),offsetX:parseFloat(r[1],10)||0,offsetY:parseFloat(r[2],10)||0,blur:parseFloat(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var n=40,r=40,i=e.Object.NUM_FRACTION_DIGITS,a=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-o.angle)),u=20,s=new e.Color(this.color);return o.width&&o.height&&(n=c((Math.abs(a.x)+this.blur)/o.width,i)*100+u,r=c((Math.abs(a.y)+this.blur)/o.height,i)*100+u),o.flipX&&(a.x*=-1),o.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+r+'%" height="'+(100+2*r)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,i)+`"></feGaussianBlur>
	<feOffset dx="`+c(a.x,i)+'" dy="'+c(a.y,i)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+s.toRgb()+'" flood-opacity="'+s.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},n=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(r){this[r]!==n[r]&&(o[r]=this[r])},this),o}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(l),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var h=t.util.object.extend,e=t.util.getElementOffset,c=t.util.removeFromArray,o=t.util.toFixed,n=t.util.transformPoint,r=t.util.invertTransform,i=t.util.getNodeCanvas,a=t.util.createCanvasElement,u=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(s,d){d||(d={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(s,d)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(s,d){var g=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(s),this._initOptions(d),this.interactive||this._initRetinaScaling(),d.overlayImage&&this.setOverlayImage(d.overlayImage,g),d.backgroundImage&&this.setBackgroundImage(d.backgroundImage,g),d.backgroundColor&&this.setBackgroundColor(d.backgroundColor,g),d.overlayColor&&this.setOverlayColor(d.overlayColor,g),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var s=t.devicePixelRatio;this.__initRetinaScaling(s,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(s,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(s,d,g){d.setAttribute("width",this.width*s),d.setAttribute("height",this.height*s),g.scale(s,s)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(s,d,g){return this.__setBgOverlayImage("overlayImage",s,d,g)},setBackgroundImage:function(s,d,g){return this.__setBgOverlayImage("backgroundImage",s,d,g)},setOverlayColor:function(s,d){return this.__setBgOverlayColor("overlayColor",s,d)},setBackgroundColor:function(s,d){return this.__setBgOverlayColor("backgroundColor",s,d)},__setBgOverlayImage:function(s,d,g,p){return typeof d=="string"?t.util.loadImage(d,function(_,C){if(_){var w=new t.Image(_,p);this[s]=w,w.canvas=this}g&&g(_,C)},this,p&&p.crossOrigin):(p&&d.setOptions(p),this[s]=d,d&&(d.canvas=this),g&&g(d,!1)),this},__setBgOverlayColor:function(s,d,g){return this[s]=d,this._initGradient(d,s),this._initPattern(d,s,g),this},_createCanvasElement:function(){var s=a();if(!s||(s.style||(s.style={}),typeof s.getContext>"u"))throw u;return s},_initOptions:function(s){var d=this.lowerCanvasEl;this._setOptions(s),this.width=this.width||parseInt(d.width,10)||0,this.height=this.height||parseInt(d.height,10)||0,this.lowerCanvasEl.style&&(d.width=this.width,d.height=this.height,d.style.width=this.width+"px",d.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(s){s&&s.getContext?this.lowerCanvasEl=s:this.lowerCanvasEl=t.util.getById(s)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(s,d){return this.setDimensions({width:s},d)},setHeight:function(s,d){return this.setDimensions({height:s},d)},setDimensions:function(s,d){var g;d=d||{};for(var p in s)g=s[p],d.cssOnly||(this._setBackstoreDimension(p,s[p]),g+="px",this.hasLostContext=!0),d.backstoreOnly||this._setCssDimension(p,g);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),d.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(s,d){return this.lowerCanvasEl[s]=d,this.upperCanvasEl&&(this.upperCanvasEl[s]=d),this.cacheCanvasEl&&(this.cacheCanvasEl[s]=d),this[s]=d,this},_setCssDimension:function(s,d){return this.lowerCanvasEl.style[s]=d,this.upperCanvasEl&&(this.upperCanvasEl.style[s]=d),this.wrapperEl&&(this.wrapperEl.style[s]=d),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(s){var d=this._activeObject,g=this.backgroundImage,p=this.overlayImage,_,C,w;for(this.viewportTransform=s,C=0,w=this._objects.length;C<w;C++)_=this._objects[C],_.group||_.setCoords(!0);return d&&d.setCoords(),g&&g.setCoords(!0),p&&p.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(s,d){var g=s,p=this.viewportTransform.slice(0);s=n(s,r(this.viewportTransform)),p[0]=d,p[3]=d;var _=n(s,p);return p[4]+=g.x-_.x,p[5]+=g.y-_.y,this.setViewportTransform(p)},setZoom:function(s){return this.zoomToPoint(new t.Point(0,0),s),this},absolutePan:function(s){var d=this.viewportTransform.slice(0);return d[4]=-s.x,d[5]=-s.y,this.setViewportTransform(d)},relativePan:function(s){return this.absolutePan(new t.Point(-s.x-this.viewportTransform[4],-s.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(s){this.stateful&&s.setupState(),s._set("canvas",this),s.setCoords(),this.fire("object:added",{target:s}),s.fire("added")},_onObjectRemoved:function(s){this.fire("object:removed",{target:s}),s.fire("removed"),delete s.canvas},clearContext:function(s){return s.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var s=this.contextContainer;return this.renderCanvas(s,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var s={},d=this.width,g=this.height,p=r(this.viewportTransform);return s.tl=n({x:0,y:0},p),s.br=n({x:d,y:g},p),s.tr=new t.Point(s.br.x,s.tl.y),s.bl=new t.Point(s.tl.x,s.br.y),this.vptCoords=s,s},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(s,d){var g=this.viewportTransform,p=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(s),t.util.setImageSmoothing(s,this.imageSmoothingEnabled),this.fire("before:render",{ctx:s}),this._renderBackground(s),s.save(),s.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._renderObjects(s,d),s.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(s),p&&(p.canvas=this,p.shouldCache(),p._transformDone=!0,p.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(s)),this._renderOverlay(s),this.controlsAboveOverlay&&this.interactive&&this.drawControls(s),this.fire("after:render",{ctx:s})},drawClipPathOnCanvas:function(s){var d=this.viewportTransform,g=this.clipPath;s.save(),s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),s.globalCompositeOperation="destination-in",g.transform(s),s.scale(1/g.zoomX,1/g.zoomY),s.drawImage(g._cacheCanvas,-g.cacheTranslationX,-g.cacheTranslationY),s.restore()},_renderObjects:function(s,d){var g,p;for(g=0,p=d.length;g<p;++g)d[g]&&d[g].render(s)},_renderBackgroundOrOverlay:function(s,d){var g=this[d+"Color"],p=this[d+"Image"],_=this.viewportTransform,C=this[d+"Vpt"];if(!(!g&&!p)){if(g){s.save(),s.beginPath(),s.moveTo(0,0),s.lineTo(this.width,0),s.lineTo(this.width,this.height),s.lineTo(0,this.height),s.closePath(),s.fillStyle=g.toLive?g.toLive(s,this):g,C&&s.transform(_[0],_[1],_[2],_[3],_[4],_[5]),s.transform(1,0,0,1,g.offsetX||0,g.offsetY||0);var w=g.gradientTransform||g.patternTransform;w&&s.transform(w[0],w[1],w[2],w[3],w[4],w[5]),s.fill(),s.restore()}p&&(s.save(),C&&s.transform(_[0],_[1],_[2],_[3],_[4],_[5]),p.render(s),s.restore())}},_renderBackground:function(s){this._renderBackgroundOrOverlay(s,"background")},_renderOverlay:function(s){this._renderBackgroundOrOverlay(s,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(s){return this._centerObject(s,new t.Point(this.getCenterPoint().x,s.getCenterPoint().y))},centerObjectV:function(s){return this._centerObject(s,new t.Point(s.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(s){var d=this.getCenterPoint();return this._centerObject(s,d)},viewportCenterObject:function(s){var d=this.getVpCenter();return this._centerObject(s,d)},viewportCenterObjectH:function(s){var d=this.getVpCenter();return this._centerObject(s,new t.Point(d.x,s.getCenterPoint().y)),this},viewportCenterObjectV:function(s){var d=this.getVpCenter();return this._centerObject(s,new t.Point(s.getCenterPoint().x,d.y))},getVpCenter:function(){var s=this.getCenterPoint(),d=r(this.viewportTransform);return n(s,d)},_centerObject:function(s,d){return s.setPositionByOrigin(d,"center","center"),s.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(s){return this.toDatalessObject(s)},toObject:function(s){return this._toObjectMethod("toObject",s)},toDatalessObject:function(s){return this._toObjectMethod("toDatalessObject",s)},_toObjectMethod:function(s,d){var g=this.clipPath,p={version:t.version,objects:this._toObjects(s,d)};return g&&!g.excludeFromExport&&(p.clipPath=this._toObject(this.clipPath,s,d)),h(p,this.__serializeBgOverlay(s,d)),t.util.populateWithProperties(this,p,d),p},_toObjects:function(s,d){return this._objects.filter(function(g){return!g.excludeFromExport}).map(function(g){return this._toObject(g,s,d)},this)},_toObject:function(s,d,g){var p;this.includeDefaultValues||(p=s.includeDefaultValues,s.includeDefaultValues=!1);var _=s[d](g);return this.includeDefaultValues||(s.includeDefaultValues=p),_},__serializeBgOverlay:function(s,d){var g={},p=this.backgroundImage,_=this.overlayImage,C=this.backgroundColor,w=this.overlayColor;return C&&C.toObject?C.excludeFromExport||(g.background=C.toObject(d)):C&&(g.background=C),w&&w.toObject?w.excludeFromExport||(g.overlay=w.toObject(d)):w&&(g.overlay=w),p&&!p.excludeFromExport&&(g.backgroundImage=this._toObject(p,s,d)),_&&!_.excludeFromExport&&(g.overlayImage=this._toObject(_,s,d)),g},svgViewportTransformation:!0,toSVG:function(s,d){s||(s={}),s.reviver=d;var g=[];return this._setSVGPreamble(g,s),this._setSVGHeader(g,s),this.clipPath&&g.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(g,"background"),this._setSVGBgOverlayImage(g,"backgroundImage",d),this._setSVGObjects(g,d),this.clipPath&&g.push(`</g>
`),this._setSVGBgOverlayColor(g,"overlay"),this._setSVGBgOverlayImage(g,"overlayImage",d),g.push("</svg>"),g.join("")},_setSVGPreamble:function(s,d){d.suppressPreamble||s.push('<?xml version="1.0" encoding="',d.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(s,d){var g=d.width||this.width,p=d.height||this.height,_,C='viewBox="0 0 '+this.width+" "+this.height+'" ',w=t.Object.NUM_FRACTION_DIGITS;d.viewBox?C='viewBox="'+d.viewBox.x+" "+d.viewBox.y+" "+d.viewBox.width+" "+d.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,C='viewBox="'+o(-_[4]/_[0],w)+" "+o(-_[5]/_[3],w)+" "+o(this.width/_[0],w)+" "+o(this.height/_[3],w)+'" '),s.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',g,'" ','height="',p,'" ',C,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(d),`</defs>
`)},createSVGClipPathMarkup:function(s){var d=this.clipPath;return d?(d.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+d.clipPathId+`" >
`+this.clipPath.toClipPathSVG(s.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var s=this,d=["background","overlay"].map(function(g){var p=s[g+"Color"];if(p&&p.toLive){var _=s[g+"Vpt"],C=s.viewportTransform,w={width:s.width/(_?C[0]:1),height:s.height/(_?C[3]:1)};return p.toSVG(w,{additionalTransform:_?t.util.matrixToSVG(C):""})}});return d.join("")},createSVGFontFacesMarkup:function(){var s="",d={},g,p,_,C,w,S,O,I,X,Q=t.fontPaths,tt=[];for(this._objects.forEach(function U(et){tt.push(et),et._objects&&et._objects.forEach(U)}),I=0,X=tt.length;I<X;I++)if(g=tt[I],p=g.fontFamily,!(g.type.indexOf("text")===-1||d[p]||!Q[p])&&(d[p]=!0,!!g.styles)){_=g.styles;for(w in _){C=_[w];for(O in C)S=C[O],p=S.fontFamily,!d[p]&&Q[p]&&(d[p]=!0)}}for(var Y in d)s+=[`		@font-face {
`,"			font-family: '",Y,`';
`,"			src: url('",Q[Y],`');
`,`		}
`].join("");return s&&(s=['	<style type="text/css">',`<![CDATA[
`,s,"]]>",`</style>
`].join("")),s},_setSVGObjects:function(s,d){var g,p,_,C=this._objects;for(p=0,_=C.length;p<_;p++)g=C[p],!g.excludeFromExport&&this._setSVGObject(s,g,d)},_setSVGObject:function(s,d,g){s.push(d.toSVG(g))},_setSVGBgOverlayImage:function(s,d,g){this[d]&&!this[d].excludeFromExport&&this[d].toSVG&&s.push(this[d].toSVG(g))},_setSVGBgOverlayColor:function(s,d){var g=this[d+"Color"],p=this.viewportTransform,_=this.width,C=this.height;if(g)if(g.toLive){var w=g.repeat,S=t.util.invertTransform(p),O=this[d+"Vpt"],I=O?t.util.matrixToSVG(S):"";s.push('<rect transform="'+I+" translate(",_/2,",",C/2,')"',' x="',g.offsetX-_/2,'" y="',g.offsetY-C/2,'" ','width="',w==="repeat-y"||w==="no-repeat"?g.source.width:_,'" height="',w==="repeat-x"||w==="no-repeat"?g.source.height:C,'" fill="url(#SVGID_'+g.id+')"',`></rect>
`)}else s.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',g,'"',`></rect>
`)},sendToBack:function(s){if(!s)return this;var d=this._activeObject,g,p,_;if(s===d&&s.type==="activeSelection")for(_=d._objects,g=_.length;g--;)p=_[g],c(this._objects,p),this._objects.unshift(p);else c(this._objects,s),this._objects.unshift(s);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(s){if(!s)return this;var d=this._activeObject,g,p,_;if(s===d&&s.type==="activeSelection")for(_=d._objects,g=0;g<_.length;g++)p=_[g],c(this._objects,p),this._objects.push(p);else c(this._objects,s),this._objects.push(s);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(s,d){if(!s)return this;var g=this._activeObject,p,_,C,w,S,O=0;if(s===g&&s.type==="activeSelection")for(S=g._objects,p=0;p<S.length;p++)_=S[p],C=this._objects.indexOf(_),C>0+O&&(w=C-1,c(this._objects,_),this._objects.splice(w,0,_)),O++;else C=this._objects.indexOf(s),C!==0&&(w=this._findNewLowerIndex(s,C,d),c(this._objects,s),this._objects.splice(w,0,s));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(s,d,g){var p,_;if(g)for(p=d,_=d-1;_>=0;--_){var C=s.intersectsWithObject(this._objects[_])||s.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(s);if(C){p=_;break}}else p=d-1;return p},bringForward:function(s,d){if(!s)return this;var g=this._activeObject,p,_,C,w,S,O=0;if(s===g&&s.type==="activeSelection")for(S=g._objects,p=S.length;p--;)_=S[p],C=this._objects.indexOf(_),C<this._objects.length-1-O&&(w=C+1,c(this._objects,_),this._objects.splice(w,0,_)),O++;else C=this._objects.indexOf(s),C!==this._objects.length-1&&(w=this._findNewUpperIndex(s,C,d),c(this._objects,s),this._objects.splice(w,0,s));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(s,d,g){var p,_,C;if(g)for(p=d,_=d+1,C=this._objects.length;_<C;++_){var w=s.intersectsWithObject(this._objects[_])||s.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(s);if(w){p=_;break}}else p=d+1;return p},moveTo:function(s,d){return c(this._objects,s),this._objects.splice(d,0,s),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(s){s.dispose&&s.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),h(t.StaticCanvas.prototype,t.Observable),h(t.StaticCanvas.prototype,t.Collection),h(t.StaticCanvas.prototype,t.DataURLExporter),h(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(s){var d=a();if(!d||!d.getContext)return null;var g=d.getContext("2d");if(!g)return null;switch(s){case"setLineDash":return typeof g.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var s=i(this.lowerCanvasEl);return s&&s.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(s){var d=i(this.lowerCanvasEl);return d&&d.createJPEGStream(s)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(h){h.strokeStyle=this.color,h.lineWidth=this.width,h.lineCap=this.strokeLineCap,h.miterLimit=this.strokeMiterLimit,h.lineJoin=this.strokeLineJoin,h.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(h){var e=this.canvas.viewportTransform;h.save(),h.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var h=this.canvas,e=this.shadow,c=h.contextTop,o=h.getZoom();h&&h._isRetinaScaling()&&(o*=t.devicePixelRatio),c.shadowColor=e.color,c.shadowBlur=e.blur*o,c.shadowOffsetX=e.offsetX*o,c.shadowOffsetY=e.offsetY*o}},needsFullRender:function(){var h=new t.Color(this.color);return h.getAlpha()<1||!!this.shadow},_resetShadow:function(){var h=this.canvas.contextTop;h.shadowColor="",h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0},_isOutSideCanvas:function(h){return h.x<0||h.x>this.canvas.getWidth()||h.y<0||h.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(h){this.canvas=h,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(h,e,c){var o=e.midPointFrom(c);return h.quadraticCurveTo(e.x,e.y,o.x,o.y),o},onMouseDown:function(h,e){this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],this._prepareForDrawing(h),this._captureDrawingPath(h),this._render())},onMouseMove:function(h,e){if(this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h))&&this._captureDrawingPath(h)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,o=c.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,c[o-2],c[o-1],!0),n.stroke(),n.restore()}},onMouseUp:function(h){return this.canvas._isMainEvent(h.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(h){var e=new t.Point(h.x,h.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(h){return this._points.length>1&&h.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(h),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(h){var e=new t.Point(h.x,h.y);return this._addPoint(e)},_render:function(h){var e,c,o=this._points[0],n=this._points[1];if(h=h||this.canvas.contextTop,this._saveAndTransform(h),h.beginPath(),this._points.length===2&&o.x===n.x&&o.y===n.y){var r=this.width/1e3;o=new t.Point(o.x,o.y),n=new t.Point(n.x,n.y),o.x-=r,n.x+=r}for(h.moveTo(o.x,o.y),e=1,c=this._points.length;e<c;e++)this._drawSegment(h,o,n),o=this._points[e],n=this._points[e+1];h.lineTo(o.x,o.y),h.stroke(),h.restore()},convertPointsToSVGPath:function(h){var e=this.width/1e3;return t.util.getSmoothPathFromPoints(h,e)},_isEmptySVGPath:function(h){var e=t.util.joinPath(h);return e==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(h){var e=new t.Path(h,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new t.Shadow(this.shadow)),e},decimatePoints:function(h,e){if(h.length<=2)return h;var c=this.canvas.getZoom(),o=Math.pow(e/c,2),n,r=h.length-1,i=h[0],a=[i],u;for(n=1;n<r-1;n++)u=Math.pow(i.x-h[n].x,2)+Math.pow(i.y-h[n].y,2),u>=o&&(i=h[n],a.push(i));return a.push(h[r]),a},_finalizeAndAddPath:function(){var h=this.canvas.contextTop;h.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e)){this.canvas.requestRenderAll();return}var c=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(h){this.canvas=h,this.points=[]},drawDot:function(h){var e=this.addPoint(h),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,e),c.restore()},dot:function(h,e){h.fillStyle=e.fill,h.beginPath(),h.arc(e.x,e.y,e.radius,0,Math.PI*2,!1),h.closePath(),h.fill()},onMouseDown:function(h){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(h)},_render:function(){var h=this.canvas.contextTop,e,c,o=this.points;for(this._saveAndTransform(h),e=0,c=o.length;e<c;e++)this.dot(h,o[e]);h.restore()},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(h),this._render()):this.drawDot(h))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove,e,c;this.canvas.renderOnAddRemove=!1;var o=[];for(e=0,c=this.points.length;e<c;e++){var n=this.points[e],r=new t.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(r.shadow=new t.Shadow(this.shadow)),o.push(r)}var i=new t.Group(o);i.canvas=this.canvas,this.canvas.fire("before:path:created",{path:i}),this.canvas.add(i),this.canvas.fire("path:created",{path:i}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},addPoint:function(h){var e=new t.Point(h.x,h.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return e.radius=c,e.fill=o,this.points.push(e),e}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(h){this.canvas=h,this.sprayChunks=[]},onMouseDown:function(h){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(h),this.render(this.sprayChunkPoints)},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.addSprayChunk(h),this.render(this.sprayChunkPoints))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],c=0,o=this.sprayChunks.length;c<o;c++)for(var n=this.sprayChunks[c],r=0,i=n.length;r<i;r++){var a=new t.Rect({width:n[r].width,height:n[r].width,left:n[r].x+1,top:n[r].y+1,originX:"center",originY:"center",fill:this.color});e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var u=new t.Group(e);this.shadow&&u.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},_getOptimizedRects:function(h){var e={},c,o,n;for(o=0,n=h.length;o<n;o++)c=h[o].left+""+h[o].top,e[c]||(e[c]=h[o]);var r=[];for(c in e)r.push(e[c]);return r},render:function(h){var e=this.canvas.contextTop,c,o;for(e.fillStyle=this.color,this._saveAndTransform(e),c=0,o=h.length;c<o;c++){var n=h[c];typeof n.opacity<"u"&&(e.globalAlpha=n.opacity),e.fillRect(n.x,n.y,n.width,n.width)}e.restore()},_render:function(){var h=this.canvas.contextTop,e,c;for(h.fillStyle=this.color,this._saveAndTransform(h),e=0,c=this.sprayChunks.length;e<c;e++)this.render(this.sprayChunks[e]);h.restore()},addSprayChunk:function(h){this.sprayChunkPoints=[];var e,c,o,n=this.width/2,r;for(r=0;r<this.density;r++){e=t.util.getRandomInt(h.x-n,h.x+n),c=t.util.getRandomInt(h.y-n,h.y+n),this.dotWidthVariance?o=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var i=new t.Point(e,c);i.width=o,this.randomOpacity&&(i.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(i)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var h=20,e=5,c=t.util.createCanvasElement(),o=c.getContext("2d");return c.width=c.height=h+e,o.fillStyle=this.color,o.beginPath(),o.arc(h/2,h/2,h/2,0,Math.PI*2,!1),o.closePath(),o.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(h){return h.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(h){this.callSuper("_setBrushStyles",h),h.strokeStyle=this.getPattern(h)},createPath:function(h){var e=this.callSuper("createPath",h),c=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),e}}),function(){var h=t.util.getPointer,e=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(n,r){r||(r={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,r),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n=this.getActiveObjects(),r,i,a;if(n.length>0&&!this.preserveObjectStacking){i=[],a=[];for(var u=0,s=this._objects.length;u<s;u++)r=this._objects[u],n.indexOf(r)===-1?i.push(r):a.push(r);n.length>1&&(this._activeObject._objects=a),i.push.apply(i,a)}else i=this._objects;return i},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,r){var i=n.calcTransformMatrix(),a=t.util.invertTransform(i),u=this.restorePointerVpt(r);return t.util.transformPoint(u,a)},isTargetTransparent:function(n,r,i){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var a=this._normalizePointer(n,{x:r,y:i}),u=Math.max(n.cacheTranslationX+a.x*n.zoomX,0),s=Math.max(n.cacheTranslationY+a.y*n.zoomY,0),_=t.util.isTransparent(n._cacheContext,Math.round(u),Math.round(s),this.targetFindTolerance);return _}var d=this.contextCache,g=n.selectionBackgroundColor,p=this.viewportTransform;n.selectionBackgroundColor="",this.clearContext(d),d.save(),d.transform(p[0],p[1],p[2],p[3],p[4],p[5]),n.render(d),d.restore(),n.selectionBackgroundColor=g;var _=t.util.isTransparent(d,r,i,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(n){var r=!1;return Array.isArray(this.selectionKey)?r=!!this.selectionKey.find(function(i){return n[i]===!0}):r=n[this.selectionKey],r},_shouldClearSelection:function(n,r){var i=this.getActiveObjects(),a=this._activeObject;return!r||r&&a&&i.length>1&&i.indexOf(r)===-1&&a!==r&&!this._isSelectionKeyPressed(n)||r&&!r.evented||r&&!r.selectable&&a&&a!==r},_shouldCenterTransform:function(n,r,i){if(n){var a;return r==="scale"||r==="scaleX"||r==="scaleY"||r==="resizing"?a=this.centeredScaling||n.centeredScaling:r==="rotate"&&(a=this.centeredRotation||n.centeredRotation),a?!i:i}},_getOriginFromCorner:function(n,r){var i={x:n.originX,y:n.originY};return r==="ml"||r==="tl"||r==="bl"?i.x="right":(r==="mr"||r==="tr"||r==="br")&&(i.x="left"),r==="tl"||r==="mt"||r==="tr"?i.y="bottom":(r==="bl"||r==="mb"||r==="br")&&(i.y="top"),i},_getActionFromCorner:function(n,r,i,a){if(!r||!n)return"drag";var u=a.controls[r];return u.getActionName(i,u,a)},_setupCurrentTransform:function(n,r,i){if(r){var a=this.getPointer(n),u=r.__corner,s=r.controls[u],d=i&&u?s.getActionHandler(n,r,s):t.controlsUtils.dragHandler,g=this._getActionFromCorner(i,u,n,r),p=this._getOriginFromCorner(r,u),_=n[this.centeredKey],C={target:r,action:g,actionHandler:d,corner:u,scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,offsetX:a.x-r.left,offsetY:a.y-r.top,originX:p.x,originY:p.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:e(r.angle),width:r.width*r.scaleX,shiftKey:n.shiftKey,altKey:_,original:t.util.saveObjectTransform(r)};this._shouldCenterTransform(r,g,_)&&(C.originX="center",C.originY="center"),C.original.originX=p.x,C.original.originY=p.y,this._currentTransform=C,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var r=this._groupSelector,i=new t.Point(r.ex,r.ey),a=t.util.transformPoint(i,this.viewportTransform),u=new t.Point(r.ex+r.left,r.ey+r.top),s=t.util.transformPoint(u,this.viewportTransform),d=Math.min(a.x,s.x),g=Math.min(a.y,s.y),p=Math.max(a.x,s.x),_=Math.max(a.y,s.y),C=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(d,g,p-d,_-g)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,d+=C,g+=C,p-=C,_-=C,t.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(d,g,p-d,_-g))},findTarget:function(n,r){if(!this.skipTargetFind){var i=!0,a=this.getPointer(n,i),u=this._activeObject,s=this.getActiveObjects(),d,g,p=c(n),_=s.length>1&&!r||s.length===1;if(this.targets=[],_&&u._findTargetCorner(a,p)||s.length>1&&!r&&u===this._searchPossibleTargets([u],a))return u;if(s.length===1&&u===this._searchPossibleTargets([u],a))if(this.preserveObjectStacking)d=u,g=this.targets,this.targets=[];else return u;var C=this._searchPossibleTargets(this._objects,a);return n[this.altSelectionKey]&&C&&d&&C!==d&&(C=d,this.targets=g),C}},_checkTarget:function(n,r,i){if(r&&r.visible&&r.evented&&r.containsPoint(n))if((this.perPixelTargetFind||r.perPixelTargetFind)&&!r.isEditing){var a=this.isTargetTransparent(r,i.x,i.y);if(!a)return!0}else return!0},_searchPossibleTargets:function(n,r){for(var i,a=n.length,u;a--;){var s=n[a],d=s.group?this._normalizePointer(s.group,r):r;if(this._checkTarget(d,s,r)){i=n[a],i.subTargetCheck&&i instanceof t.Group&&(u=this._searchPossibleTargets(i._objects,r),u&&this.targets.push(u));break}}return i},restorePointerVpt:function(n){return t.util.transformPoint(n,t.util.invertTransform(this.viewportTransform))},getPointer:function(n,r){if(this._absolutePointer&&!r)return this._absolutePointer;if(this._pointer&&r)return this._pointer;var i=h(n),a=this.upperCanvasEl,u=a.getBoundingClientRect(),s=u.width||0,d=u.height||0,g;(!s||!d)&&("top"in u&&"bottom"in u&&(d=Math.abs(u.top-u.bottom)),"right"in u&&"left"in u&&(s=Math.abs(u.right-u.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,r||(i=this.restorePointerVpt(i));var p=this.getRetinaScaling();return p!==1&&(i.x/=p,i.y/=p),s===0||d===0?g={width:1,height:1}:g={width:a.width/s,height:a.height/d},{x:i.x*g.width,y:i.y*g.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),r=this.lowerCanvasEl,i=this.upperCanvasEl;i?i.className="":(i=this._createCanvasElement(),this.upperCanvasEl=i),t.util.addClass(i,"upper-canvas "+n),this.wrapperEl.appendChild(i),this._copyCanvasStyle(r,i),this._applyCanvasStyle(i),this.contextTop=i.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var r=this.width||n.width,i=this.height||n.height;t.util.setStyle(n,{position:"absolute",width:r+"px",height:i+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=r,n.height=i,t.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,r){r.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,r){var i=!1,a=this.getActiveObjects(),u=[],s=[];n.forEach(function(d){a.indexOf(d)===-1&&(i=!0,d.fire("deselected",{e:r,target:d}),s.push(d))}),a.forEach(function(d){n.indexOf(d)===-1&&(i=!0,d.fire("selected",{e:r,target:d}),u.push(d))}),n.length>0&&a.length>0?i&&this.fire("selection:updated",{e:r,selected:u,deselected:s}):a.length>0?this.fire("selection:created",{e:r,selected:u}):n.length>0&&this.fire("selection:cleared",{e:r,deselected:s})},setActiveObject:function(n,r){var i=this.getActiveObjects();return this._setActiveObject(n,r),this._fireSelectionEvents(i,r),this},_setActiveObject:function(n,r){return this._activeObject===n||!this._discardActiveObject(r,n)||n.onSelect({e:r})?!1:(this._activeObject=n,!0)},_discardActiveObject:function(n,r){var i=this._activeObject;if(i){if(i.onDeselect({e:n,object:r}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var r=this.getActiveObjects(),i=this.getActiveObject();return r.length&&this.fire("before:selection:cleared",{target:i,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(r,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(r){t.util.cleanUpJsdomNode(this[r]),this[r]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var r=this._activeObject;r&&r._renderControls(n)},_toObject:function(n,r,i){var a=this._realizeGroupTransformOnObject(n),u=this.callSuper("_toObject",n,r,i);return this._unwindGroupTransformOnObject(n,a),u},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var r=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],i={};return r.forEach(function(a){i[a]=n[a]}),t.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),i}else return null},_unwindGroupTransformOnObject:function(n,r){r&&n.set(r)},_setSVGObject:function(n,r,i){var a=this._realizeGroupTransformOnObject(r);this.callSuper("_setSVGObject",n,r,i),this._unwindGroupTransformOnObject(r,a)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,n)}});for(var o in t.StaticCanvas)o!=="prototype"&&(t.Canvas[o]=t.StaticCanvas[o])}(),function(){var h=t.util.addListener,e=t.util.removeListener,c=3,o=2,n=1,r={passive:!1};function i(a,u){return a.button&&a.button===u-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(h,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(a,u){var s=this.upperCanvasEl,d=this._getEventPrefix();a(t.window,"resize",this._onResize),a(s,d+"down",this._onMouseDown),a(s,d+"move",this._onMouseMove,r),a(s,d+"out",this._onMouseOut),a(s,d+"enter",this._onMouseEnter),a(s,"wheel",this._onMouseWheel),a(s,"contextmenu",this._onContextMenu),a(s,"dblclick",this._onDoubleClick),a(s,"dragover",this._onDragOver),a(s,"dragenter",this._onDragEnter),a(s,"dragleave",this._onDragLeave),a(s,"drop",this._onDrop),this.enablePointerEvents||a(s,"touchstart",this._onTouchStart,r),typeof eventjs<"u"&&u in eventjs&&(eventjs[u](s,"gesture",this._onGesture),eventjs[u](s,"drag",this._onDrag),eventjs[u](s,"orientation",this._onOrientationChange),eventjs[u](s,"shake",this._onShake),eventjs[u](s,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var a=this._getEventPrefix();e(t.document,a+"up",this._onMouseUp),e(t.document,"touchend",this._onTouchEnd,r),e(t.document,a+"move",this._onMouseMove,r),e(t.document,"touchmove",this._onMouseMove,r)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(a,u){this.__onTransformGesture&&this.__onTransformGesture(a,u)},_onDrag:function(a,u){this.__onDrag&&this.__onDrag(a,u)},_onMouseWheel:function(a){this.__onMouseWheel(a)},_onMouseOut:function(a){var u=this._hoveredTarget;this.fire("mouse:out",{target:u,e:a}),this._hoveredTarget=null,u&&u.fire("mouseout",{e:a});var s=this;this._hoveredTargets.forEach(function(d){s.fire("mouse:out",{target:u,e:a}),d&&u.fire("mouseout",{e:a})}),this._hoveredTargets=[]},_onMouseEnter:function(a){!this._currentTransform&&!this.findTarget(a)&&(this.fire("mouse:over",{target:null,e:a}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(a,u){this.__onOrientationChange&&this.__onOrientationChange(a,u)},_onShake:function(a,u){this.__onShake&&this.__onShake(a,u)},_onLongPress:function(a,u){this.__onLongPress&&this.__onLongPress(a,u)},_onDragOver:function(a){a.preventDefault();var u=this._simpleEventHandler("dragover",a);this._fireEnterLeaveEvents(u,a)},_onDrop:function(a){return this._simpleEventHandler("drop:before",a),this._simpleEventHandler("drop",a)},_onContextMenu:function(a){return this.stopContextMenu&&(a.stopPropagation(),a.preventDefault()),!1},_onDoubleClick:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"dblclick"),this._resetTransformEventData(a)},getPointerId:function(a){var u=a.changedTouches;return u?u[0]&&u[0].identifier:this.enablePointerEvents?a.pointerId:-1},_isMainEvent:function(a){return a.isPrimary===!0?!0:a.isPrimary===!1?!1:a.type==="touchend"&&a.touches.length===0?!0:a.changedTouches?a.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(a){a.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(a)),this.__onMouseDown(a),this._resetTransformEventData();var u=this.upperCanvasEl,s=this._getEventPrefix();h(t.document,"touchend",this._onTouchEnd,r),h(t.document,"touchmove",this._onMouseMove,r),e(u,s+"down",this._onMouseDown)},_onMouseDown:function(a){this.__onMouseDown(a),this._resetTransformEventData();var u=this.upperCanvasEl,s=this._getEventPrefix();e(u,s+"move",this._onMouseMove,r),h(t.document,s+"up",this._onMouseUp),h(t.document,s+"move",this._onMouseMove,r)},_onTouchEnd:function(a){if(!(a.touches.length>0)){this.__onMouseUp(a),this._resetTransformEventData(),this.mainTouchId=null;var u=this._getEventPrefix();e(t.document,"touchend",this._onTouchEnd,r),e(t.document,"touchmove",this._onMouseMove,r);var s=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){h(s.upperCanvasEl,u+"down",s._onMouseDown),s._willAddMouseDown=0},400)}},_onMouseUp:function(a){this.__onMouseUp(a),this._resetTransformEventData();var u=this.upperCanvasEl,s=this._getEventPrefix();this._isMainEvent(a)&&(e(t.document,s+"up",this._onMouseUp),e(t.document,s+"move",this._onMouseMove,r),h(u,s+"move",this._onMouseMove,r))},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a){var u=this._activeObject;return!!u!=!!a||u&&a&&u!==a?!0:(u&&u.isEditing,!1)},__onMouseUp:function(a){var u,s=this._currentTransform,d=this._groupSelector,g=!1,p=!d||d.left===0&&d.top===0;if(this._cacheTransformEventData(a),u=this._target,this._handleEvent(a,"up:before"),i(a,c)){this.fireRightClick&&this._handleEvent(a,"up",c,p);return}if(i(a,o)){this.fireMiddleClick&&this._handleEvent(a,"up",o,p),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(a);return}if(this._isMainEvent(a)){if(s&&(this._finalizeCurrentTransform(a),g=s.actionPerformed),!p){var _=u===this._activeObject;this._maybeGroupObjects(a),g||(g=this._shouldRender(u)||!_&&u===this._activeObject)}var C,w;if(u){if(C=u._findTargetCorner(this.getPointer(a,!0),t.util.isTouchEvent(a)),u.selectable&&u!==this._activeObject&&u.activeOn==="up")this.setActiveObject(u,a),g=!0;else{var S=u.controls[C],O=S&&S.getMouseUpHandler(a,u,S);O&&(w=this.getPointer(a),O(a,s,w.x,w.y))}u.isMoving=!1}if(s&&(s.target!==u||s.corner!==C)){var I=s.target&&s.target.controls[s.corner],X=I&&I.getMouseUpHandler(a,u,S);w=w||this.getPointer(a),X&&X(a,s,w.x,w.y)}this._setCursorFromEvent(a,u),this._handleEvent(a,"up",n,p),this._groupSelector=null,this._currentTransform=null,u&&(u.__corner=0),g?this.requestRenderAll():p||this.renderTop()}},_simpleEventHandler:function(a,u){var s=this.findTarget(u),d=this.targets,g={e:u,target:s,subTargets:d};if(this.fire(a,g),s&&s.fire(a,g),!d)return s;for(var p=0;p<d.length;p++)d[p].fire(a,g);return s},_handleEvent:function(a,u,s,d){var g=this._target,p=this.targets||[],_={e:a,target:g,subTargets:p,button:s||n,isClick:d||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};u==="up"&&(_.currentTarget=this.findTarget(a),_.currentSubTargets=this.targets),this.fire("mouse:"+u,_),g&&g.fire("mouse"+u,_);for(var C=0;C<p.length;C++)p[C].fire("mouse"+u,_)},_finalizeCurrentTransform:function(a){var u=this._currentTransform,s=u.target,d={e:a,target:s,transform:u,action:u.action};s._scaling&&(s._scaling=!1),s.setCoords(),(u.actionPerformed||this.stateful&&s.hasStateChanged())&&this._fire("modified",d)},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(a).requestRenderAll();var u=this.getPointer(a);this.freeDrawingBrush.onMouseDown(u,{e:a,pointer:u}),this._handleEvent(a,"down")},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var u=this.getPointer(a);this.freeDrawingBrush.onMouseMove(u,{e:a,pointer:u})}this.setCursor(this.freeDrawingCursor),this._handleEvent(a,"move")},_onMouseUpInDrawingMode:function(a){var u=this.getPointer(a);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:a,pointer:u}),this._handleEvent(a,"up")},__onMouseDown:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"down:before");var u=this._target;if(i(a,c)){this.fireRightClick&&this._handleEvent(a,"down",c);return}if(i(a,o)){this.fireMiddleClick&&this._handleEvent(a,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(a);return}if(this._isMainEvent(a)&&!this._currentTransform){var s=this._pointer;this._previousPointer=s;var d=this._shouldRender(u),g=this._shouldGroup(a,u);if(this._shouldClearSelection(a,u)?this.discardActiveObject(a):g&&(this._handleGrouping(a,u),u=this._activeObject),this.selection&&(!u||!u.selectable&&!u.isEditing&&u!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),u){var p=u===this._activeObject;u.selectable&&u.activeOn==="down"&&this.setActiveObject(u,a);var _=u._findTargetCorner(this.getPointer(a,!0),t.util.isTouchEvent(a));if(u.__corner=_,u===this._activeObject&&(_||!g)){this._setupCurrentTransform(a,u,p);var C=u.controls[_],s=this.getPointer(a),w=C&&C.getMouseDownHandler(a,u,C);w&&w(a,this._currentTransform,s.x,s.y)}}this._handleEvent(a,"down"),(d||g)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(a){this._resetTransformEventData(),this._pointer=this.getPointer(a,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(a)||null},_beforeTransform:function(a){var u=this._currentTransform;this.stateful&&u.target.saveState(),this.fire("before:transform",{e:a,transform:u})},__onMouseMove:function(a){this._handleEvent(a,"move:before"),this._cacheTransformEventData(a);var u,s;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(a);return}if(this._isMainEvent(a)){var d=this._groupSelector;d?(s=this._absolutePointer,d.left=s.x-d.ex,d.top=s.y-d.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(u=this.findTarget(a)||null,this._setCursorFromEvent(a,u),this._fireOverOutEvents(u,a)),this._handleEvent(a,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(a,u){var s=this._hoveredTarget,d=this._hoveredTargets,g=this.targets,p=Math.max(d.length,g.length);this.fireSyntheticInOutEvents(a,u,{oldTarget:s,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<p;_++)this.fireSyntheticInOutEvents(g[_],u,{oldTarget:d[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(a,u){var s=this._draggedoverTarget,d=this._hoveredTargets,g=this.targets,p=Math.max(d.length,g.length);this.fireSyntheticInOutEvents(a,u,{oldTarget:s,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<p;_++)this.fireSyntheticInOutEvents(g[_],u,{oldTarget:d[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=a},fireSyntheticInOutEvents:function(a,u,s){var d,g,p=s.oldTarget,_,C,w=p!==a,S=s.canvasEvtIn,O=s.canvasEvtOut;w&&(d={e:u,target:a,previousTarget:p},g={e:u,target:p,nextTarget:a}),C=a&&w,_=p&&w,_&&(O&&this.fire(O,g),p.fire(s.evtOut,g)),C&&(S&&this.fire(S,d),a.fire(s.evtIn,d))},__onMouseWheel:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"wheel"),this._resetTransformEventData()},_transformObject:function(a){var u=this.getPointer(a),s=this._currentTransform;s.reset=!1,s.shiftKey=a.shiftKey,s.altKey=a[this.centeredKey],this._performTransformAction(a,s,u),s.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(a,u,s){var d=s.x,g=s.y,p=u.action,_=!1,C=u.actionHandler;C&&(_=C(a,u,d,g)),p==="drag"&&_&&(u.target.isMoving=!0,this.setCursor(u.target.moveCursor||this.moveCursor)),u.actionPerformed=u.actionPerformed||_},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(a,u){if(!u)return this.setCursor(this.defaultCursor),!1;var s=u.hoverCursor||this.hoverCursor,d=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,g=(!d||!d.contains(u))&&u._findTargetCorner(this.getPointer(a,!0));g?this.setCursor(this.getCornerCursor(g,u,a)):(u.subTargetCheck&&this.targets.concat().reverse().map(function(p){s=p.hoverCursor||s}),this.setCursor(s))},getCornerCursor:function(a,u,s){var d=u.controls[a];return d.cursorStyleHandler(s,d,u)}})}(),function(){var h=Math.min,e=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,o){var n=this._activeObject;return n&&this._isSelectionKeyPressed(c)&&o&&o.selectable&&this.selection&&(n!==o||n.type==="activeSelection")&&!o.onSelect({e:c})},_handleGrouping:function(c,o){var n=this._activeObject;n.__corner||o===n&&(o=this.findTarget(c,!0),!o||!o.selectable)||(n&&n.type==="activeSelection"?this._updateActiveSelection(o,c):this._createActiveSelection(o,c))},_updateActiveSelection:function(c,o){var n=this._activeObject,r=n._objects.slice(0);n.contains(c)?(n.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),n.size()===1&&this._setActiveObject(n.item(0),o)):(n.addWithUpdate(c),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(r,o)},_createActiveSelection:function(c,o){var n=this.getActiveObjects(),r=this._createGroup(c);this._hoveredTarget=r,this._setActiveObject(r,o),this._fireSelectionEvents(n,o)},_createGroup:function(c){var o=this._objects,n=o.indexOf(this._activeObject)<o.indexOf(c),r=n?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(r,{canvas:this})},_groupSelectedObjects:function(c){var o=this._collectObjects(c),n;o.length===1?this.setActiveObject(o[0],c):o.length>1&&(n=new t.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(n,c))},_collectObjects:function(c){for(var o=[],n,r=this._groupSelector.ex,i=this._groupSelector.ey,a=r+this._groupSelector.left,u=i+this._groupSelector.top,s=new t.Point(h(r,a),h(i,u)),d=new t.Point(e(r,a),e(i,u)),g=!this.selectionFullyContained,p=r===a&&i===u,_=this._objects.length;_--&&(n=this._objects[_],!(!(!n||!n.selectable||!n.visible)&&(g&&n.intersectsWithRect(s,d,!0)||n.isContainedWithinRect(s,d,!0)||g&&n.containsPoint(s,null,!0)||g&&n.containsPoint(d,null,!0))&&(o.push(n),p))););return o.length>1&&(o=o.filter(function(C){return!C.onSelect({e:c})})),o},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(h){h||(h={});var e=h.format||"png",c=h.quality||1,o=(h.multiplier||1)*(h.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(o,h);return t.util.toDataURL(n,e,c)},toCanvasElement:function(h,e){h=h||1,e=e||{};var c=(e.width||this.width)*h,o=(e.height||this.height)*h,n=this.getZoom(),r=this.width,i=this.height,a=n*h,u=this.viewportTransform,s=(u[4]-(e.left||0))*h,d=(u[5]-(e.top||0))*h,g=this.interactive,p=[a,0,0,a,s,d],_=this.enableRetinaScaling,C=t.util.createCanvasElement(),w=this.contextTop;return C.width=c,C.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=p,this.width=c,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(C.getContext("2d"),this._objects),this.viewportTransform=u,this.width=r,this.height=i,this.calcViewportBoundaries(),this.interactive=g,this.enableRetinaScaling=_,this.contextTop=w,C}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(h,e,c){if(h){var o=typeof h=="string"?JSON.parse(h):t.util.object.clone(h),n=this,r=o.clipPath,i=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(a){n.clear(),n._setBgOverlay(o,function(){r?n._enlivenObjects([r],function(u){n.clipPath=u[0],n.__setupCanvas.call(n,o,a,i,e)}):n.__setupCanvas.call(n,o,a,i,e)})},c),this}},__setupCanvas:function(h,e,c,o){var n=this;e.forEach(function(r,i){n.insertAt(r,i)}),this.renderOnAddRemove=c,delete h.objects,delete h.backgroundImage,delete h.overlayImage,delete h.background,delete h.overlay,this._setOptions(h),this.renderAll(),o&&o()},_setBgOverlay:function(h,e){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!h.backgroundImage&&!h.overlayImage&&!h.background&&!h.overlay){e&&e();return}var o=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",h.backgroundImage,c,o),this.__setBgOverlay("overlayImage",h.overlayImage,c,o),this.__setBgOverlay("backgroundColor",h.background,c,o),this.__setBgOverlay("overlayColor",h.overlay,c,o)},__setBgOverlay:function(h,e,c,o){var n=this;if(!e){c[h]=!0,o&&o();return}h==="backgroundImage"||h==="overlayImage"?t.util.enlivenObjects([e],function(r){n[h]=r[0],c[h]=!0,o&&o()}):this["set"+t.util.string.capitalize(h,!0)](e,function(){c[h]=!0,o&&o()})},_enlivenObjects:function(h,e,c){if(!h||h.length===0){e&&e([]);return}t.util.enlivenObjects(h,function(o){e&&e(o)},null,c)},_toDataURL:function(h,e){this.clone(function(c){e(c.toDataURL(h))})},_toDataURLWithMultiplier:function(h,e,c){this.clone(function(o){c(o.toDataURLWithMultiplier(h,e))})},clone:function(h,e){var c=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(o){o.loadFromJSON(c,function(){h&&h(o)})})},cloneWithoutData:function(h){var e=t.util.createCanvasElement();e.width=this.width,e.height=this.height;var c=new t.Canvas(e);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),h&&h(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):h&&h(c)}}),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.extend,o=e.util.object.clone,n=e.util.toFixed,r=e.util.string.capitalize,i=e.util.degreesToRadians,a=!e.isLikelyNode,u=2;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:a,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(s){s&&this.setOptions(s)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(s){var d=e.perfLimitSizeTotal,g=s.width,p=s.height,_=e.maxCacheSideLimit,C=e.minCacheSideLimit;if(g<=_&&p<=_&&g*p<=d)return g<C&&(s.width=C),p<C&&(s.height=C),s;var w=g/p,S=e.util.limitDimsByArea(w,d),O=e.util.capValue,I=O(C,S.x,_),X=O(C,S.y,_);return g>I&&(s.zoomX/=g/I,s.width=I,s.capped=!0),p>X&&(s.zoomY/=p/X,s.height=X,s.capped=!0),s},_getCacheCanvasDimensions:function(){var s=this.getTotalObjectScaling(),d=this._getTransformedDimensions(0,0),g=d.x*s.scaleX/this.scaleX,p=d.y*s.scaleY/this.scaleY;return{width:g+u,height:p+u,zoomX:s.scaleX,zoomY:s.scaleY,x:g,y:p}},_updateCacheCanvas:function(){var s=this.canvas;if(this.noScaleCache&&s&&s._currentTransform){var d=s._currentTransform.target,g=s._currentTransform.action;if(this===d&&g.slice&&g.slice(0,5)==="scale")return!1}var p=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),C=e.minCacheSideLimit,w=_.width,S=_.height,O,I,X=_.zoomX,Q=_.zoomY,tt=w!==this.cacheWidth||S!==this.cacheHeight,Y=this.zoomX!==X||this.zoomY!==Q,U=tt||Y,et=0,st=0,ft=!1;if(tt){var ut=this._cacheCanvas.width,T=this._cacheCanvas.height,A=w>ut||S>T,P=(w<ut*.9||S<T*.9)&&ut>C&&T>C;ft=A||P,A&&!_.capped&&(w>C||S>C)&&(et=w*.1,st=S*.1)}return this instanceof e.Text&&this.path&&(U=!0,ft=!0,et+=this.getHeightOfLine(0)*this.zoomX,st+=this.getHeightOfLine(0)*this.zoomY),U?(ft?(p.width=Math.ceil(w+et),p.height=Math.ceil(S+st)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,p.width,p.height)),O=_.x/2,I=_.y/2,this.cacheTranslationX=Math.round(p.width/2-O)+O,this.cacheTranslationY=Math.round(p.height/2-I)+I,this.cacheWidth=w,this.cacheHeight=S,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(X,Q),this.zoomX=X,this.zoomY=Q,!0):!1},setOptions:function(s){this._setOptions(s),this._initGradient(s.fill,"fill"),this._initGradient(s.stroke,"stroke"),this._initPattern(s.fill,"fill"),this._initPattern(s.stroke,"stroke")},transform:function(s){var d=this.group&&!this.group._transformDone||this.group&&this.canvas&&s===this.canvas.contextTop,g=this.calcTransformMatrix(!d);s.transform(g[0],g[1],g[2],g[3],g[4],g[5])},toObject:function(s){var d=e.Object.NUM_FRACTION_DIGITS,g={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:n(this.left,d),top:n(this.top,d),width:n(this.width,d),height:n(this.height,d),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,d),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,d),scaleX:n(this.scaleX,d),scaleY:n(this.scaleY,d),angle:n(this.angle,d),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,d),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,d),skewY:n(this.skewY,d)};return this.clipPath&&!this.clipPath.excludeFromExport&&(g.clipPath=this.clipPath.toObject(s),g.clipPath.inverted=this.clipPath.inverted,g.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,g,s),this.includeDefaultValues||(g=this._removeDefaultValues(g)),g},toDatalessObject:function(s){return this.toObject(s)},_removeDefaultValues:function(s){var d=e.util.getKlass(s.type).prototype,g=d.stateProperties;return g.forEach(function(p){p==="left"||p==="top"||(s[p]===d[p]&&delete s[p],Array.isArray(s[p])&&Array.isArray(d[p])&&s[p].length===0&&d[p].length===0&&delete s[p])}),s},toString:function(){return"#<fabric."+r(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var s=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(s.scaleX),scaleY:Math.abs(s.scaleY)}},getTotalObjectScaling:function(){var s=this.getObjectScaling(),d=s.scaleX,g=s.scaleY;if(this.canvas){var p=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();d*=p*_,g*=p*_}return{scaleX:d,scaleY:g}},getObjectOpacity:function(){var s=this.opacity;return this.group&&(s*=this.group.getObjectOpacity()),s},_set:function(s,d){var g=s==="scaleX"||s==="scaleY",p=this[s]!==d,_=!1;return g&&(d=this._constrainScale(d)),s==="scaleX"&&d<0?(this.flipX=!this.flipX,d*=-1):s==="scaleY"&&d<0?(this.flipY=!this.flipY,d*=-1):s==="shadow"&&d&&!(d instanceof e.Shadow)?d=new e.Shadow(d):s==="dirty"&&this.group&&this.group.set("dirty",d),this[s]=d,p&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(s)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(s)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(s){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(s.save(),this._setupCompositeOperation(s),this.drawSelectionBackground(s),this.transform(s),this._setOpacity(s),this._setShadow(s,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(s)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(s),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),s.restore())},renderCache:function(s){s=s||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,s.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(s,d){if(s.save(),d.inverted?s.globalCompositeOperation="destination-out":s.globalCompositeOperation="destination-in",d.absolutePositioned){var g=e.util.invertTransform(this.calcTransformMatrix());s.transform(g[0],g[1],g[2],g[3],g[4],g[5])}d.transform(s),s.scale(1/d.zoomX,1/d.zoomY),s.drawImage(d._cacheCanvas,-d.cacheTranslationX,-d.cacheTranslationY),s.restore()},drawObject:function(s,d){var g=this.fill,p=this.stroke;d?(this.fill="black",this.stroke="",this._setClippingProperties(s)):this._renderBackground(s),this._render(s),this._drawClipPath(s,this.clipPath),this.fill=g,this.stroke=p},_drawClipPath:function(s,d){d&&(d.canvas=this.canvas,d.shouldCache(),d._transformDone=!0,d.renderCache({forClipping:!0}),this.drawClipPathOnCache(s,d))},drawCacheOnCanvas:function(s){s.scale(1/this.zoomX,1/this.zoomY),s.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(s){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!s&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!s){var d=this.cacheWidth/this.zoomX,g=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-d/2,-g/2,d,g)}return!0}return!1},_renderBackground:function(s){if(this.backgroundColor){var d=this._getNonTransformedDimensions();s.fillStyle=this.backgroundColor,s.fillRect(-d.x/2,-d.y/2,d.x,d.y),this._removeShadow(s)}},_setOpacity:function(s){this.group&&!this.group._transformDone?s.globalAlpha=this.getObjectOpacity():s.globalAlpha*=this.opacity},_setStrokeStyles:function(s,d){var g=d.stroke;g&&(s.lineWidth=d.strokeWidth,s.lineCap=d.strokeLineCap,s.lineDashOffset=d.strokeDashOffset,s.lineJoin=d.strokeLineJoin,s.miterLimit=d.strokeMiterLimit,g.toLive?g.gradientUnits==="percentage"||g.gradientTransform||g.patternTransform?this._applyPatternForTransformedGradient(s,g):(s.strokeStyle=g.toLive(s,this),this._applyPatternGradientTransform(s,g)):s.strokeStyle=d.stroke)},_setFillStyles:function(s,d){var g=d.fill;g&&(g.toLive?(s.fillStyle=g.toLive(s,this),this._applyPatternGradientTransform(s,d.fill)):s.fillStyle=g)},_setClippingProperties:function(s){s.globalAlpha=1,s.strokeStyle="transparent",s.fillStyle="#000000"},_setLineDash:function(s,d){!d||d.length===0||(1&d.length&&d.push.apply(d,d),s.setLineDash(d))},_renderControls:function(s,d){var g=this.getViewportTransform(),p=this.calcTransformMatrix(),_,C,w;d=d||{},C=typeof d.hasBorders<"u"?d.hasBorders:this.hasBorders,w=typeof d.hasControls<"u"?d.hasControls:this.hasControls,p=e.util.multiplyTransformMatrices(g,p),_=e.util.qrDecompose(p),s.save(),s.translate(_.translateX,_.translateY),s.lineWidth=1*this.borderScaleFactor,this.group||(s.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),s.rotate(i(this.group?_.angle:this.angle)),d.forActiveSelection||this.group?C&&this.drawBordersInGroup(s,_,d):C&&this.drawBorders(s,d),w&&this.drawControls(s,d),s.restore()},_setShadow:function(s){if(this.shadow){var d=this.shadow,g=this.canvas,p,_=g&&g.viewportTransform[0]||1,C=g&&g.viewportTransform[3]||1;d.nonScaling?p={scaleX:1,scaleY:1}:p=this.getObjectScaling(),g&&g._isRetinaScaling()&&(_*=e.devicePixelRatio,C*=e.devicePixelRatio),s.shadowColor=d.color,s.shadowBlur=d.blur*e.browserShadowBlurConstant*(_+C)*(p.scaleX+p.scaleY)/4,s.shadowOffsetX=d.offsetX*_*p.scaleX,s.shadowOffsetY=d.offsetY*C*p.scaleY}},_removeShadow:function(s){this.shadow&&(s.shadowColor="",s.shadowBlur=s.shadowOffsetX=s.shadowOffsetY=0)},_applyPatternGradientTransform:function(s,d){if(!d||!d.toLive)return{offsetX:0,offsetY:0};var g=d.gradientTransform||d.patternTransform,p=-this.width/2+d.offsetX||0,_=-this.height/2+d.offsetY||0;return d.gradientUnits==="percentage"?s.transform(this.width,0,0,this.height,p,_):s.transform(1,0,0,1,p,_),g&&s.transform(g[0],g[1],g[2],g[3],g[4],g[5]),{offsetX:p,offsetY:_}},_renderPaintInOrder:function(s){this.paintFirst==="stroke"?(this._renderStroke(s),this._renderFill(s)):(this._renderFill(s),this._renderStroke(s))},_render:function(){},_renderFill:function(s){this.fill&&(s.save(),this._setFillStyles(s,this),this.fillRule==="evenodd"?s.fill("evenodd"):s.fill(),s.restore())},_renderStroke:function(s){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(s),s.save(),this.strokeUniform&&this.group){var d=this.getObjectScaling();s.scale(1/d.scaleX,1/d.scaleY)}else this.strokeUniform&&s.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(s,this.strokeDashArray),this._setStrokeStyles(s,this),s.stroke(),s.restore()}},_applyPatternForTransformedGradient:function(s,d){var g=this._limitCacheSize(this._getCacheCanvasDimensions()),p=e.util.createCanvasElement(),_,C=this.canvas.getRetinaScaling(),w=g.x/this.scaleX/C,S=g.y/this.scaleY/C;p.width=w,p.height=S,_=p.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(w,0),_.lineTo(w,S),_.lineTo(0,S),_.closePath(),_.translate(w/2,S/2),_.scale(g.zoomX/this.scaleX/C,g.zoomY/this.scaleY/C),this._applyPatternGradientTransform(_,d),_.fillStyle=d.toLive(s),_.fill(),s.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),s.scale(C*this.scaleX/g.zoomX,C*this.scaleY/g.zoomY),s.strokeStyle=_.createPattern(p,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var s=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",s.scaleX),this.set("scaleY",s.scaleY),this.angle=s.angle,this.skewX=s.skewX,this.skewY=0}},_removeTransformMatrix:function(s){var d=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),d=e.util.transformPoint(d,this.transformMatrix)),this.transformMatrix=null,s&&(this.scaleX*=s.scaleX,this.scaleY*=s.scaleY,this.cropX=s.cropX,this.cropY=s.cropY,d.x+=s.offsetLeft,d.y+=s.offsetTop,this.width=s.width,this.height=s.height),this.setPositionByOrigin(d,"center","center")},clone:function(s,d){var g=this.toObject(d);this.constructor.fromObject?this.constructor.fromObject(g,s):e.Object._fromObject("Object",g,s)},cloneAsImage:function(s,d){var g=this.toCanvasElement(d);return s&&s(new e.Image(g)),this},toCanvasElement:function(s){s||(s={});var d=e.util,g=d.saveObjectTransform(this),p=this.group,_=this.shadow,C=Math.abs,w=(s.multiplier||1)*(s.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,s.withoutTransform&&d.resetObjectTransform(this),s.withoutShadow&&(this.shadow=null);var S=e.util.createCanvasElement(),O=this.getBoundingRect(!0,!0),I=this.shadow,X,Q={x:0,y:0},tt,Y,U;I&&(tt=I.blur,I.nonScaling?X={scaleX:1,scaleY:1}:X=this.getObjectScaling(),Q.x=2*Math.round(C(I.offsetX)+tt)*C(X.scaleX),Q.y=2*Math.round(C(I.offsetY)+tt)*C(X.scaleY)),Y=O.width+Q.x,U=O.height+Q.y,S.width=Math.ceil(Y),S.height=Math.ceil(U);var et=new e.StaticCanvas(S,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});s.format==="jpeg"&&(et.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(et.width/2,et.height/2),"center","center");var st=this.canvas;et.add(this);var ft=et.toCanvasElement(w||1,s);return this.shadow=_,this.set("canvas",st),p&&(this.group=p),this.set(g).setCoords(),et._objects=[],et.dispose(),et=null,ft},toDataURL:function(s){return s||(s={}),e.util.toDataURL(this.toCanvasElement(s),s.format||"png",s.quality||1)},isType:function(s){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===s},complexity:function(){return 1},toJSON:function(s){return this.toObject(s)},rotate:function(s){var d=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return d&&this._setOriginToCenter(),this.set("angle",s),d&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(s,d){d=d||this.canvas.getPointer(s);var g=new e.Point(d.x,d.y),p=this._getLeftTopCoords();return this.angle&&(g=e.util.rotatePoint(g,p,i(-this.angle))),{x:g.x-p.x,y:g.y-p.y}},_setupCompositeOperation:function(s){this.globalCompositeOperation&&(s.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){e.runningAnimations&&e.runningAnimations.cancelByTarget(this)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),c(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.ENLIVEN_PROPS=["clipPath"],e.Object._fromObject=function(s,d,g,p){var _=e[s];d=o(d,!0),e.util.enlivenPatterns([d.fill,d.stroke],function(C){typeof C[0]<"u"&&(d.fill=C[0]),typeof C[1]<"u"&&(d.stroke=C[1]),e.util.enlivenObjectEnlivables(d,d,function(){var w=p?new _(d[p],d):new _(d);g&&g(w)})})},e.Object.__uid=0)}(l),function(){var h=t.util.degreesToRadians,e={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(o,n,r,i,a){var u=o.x,s=o.y,d,g,p;return typeof n=="string"?n=e[n]:n-=.5,typeof i=="string"?i=e[i]:i-=.5,d=i-n,typeof r=="string"?r=c[r]:r-=.5,typeof a=="string"?a=c[a]:a-=.5,g=a-r,(d||g)&&(p=this._getTransformedDimensions(),u=o.x+d*p.x,s=o.y+g*p.y),new t.Point(u,s)},translateToCenterPoint:function(o,n,r){var i=this.translateToGivenOrigin(o,n,r,"center","center");return this.angle?t.util.rotatePoint(i,o,h(this.angle)):i},translateToOriginPoint:function(o,n,r){var i=this.translateToGivenOrigin(o,"center","center",n,r);return this.angle?t.util.rotatePoint(i,o,h(this.angle)):i},getCenterPoint:function(){var o=new t.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,n){var r=this.getCenterPoint();return this.translateToOriginPoint(r,o,n)},toLocalPoint:function(o,n,r){var i=this.getCenterPoint(),a,u;return typeof n<"u"&&typeof r<"u"?a=this.translateToGivenOrigin(i,"center","center",n,r):a=new t.Point(this.left,this.top),u=new t.Point(o.x,o.y),this.angle&&(u=t.util.rotatePoint(u,i,-h(this.angle))),u.subtractEquals(a)},setPositionByOrigin:function(o,n,r){var i=this.translateToCenterPoint(o,n,r),a=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",a.x),this.set("top",a.y)},adjustPosition:function(o){var n=h(this.angle),r=this.getScaledWidth(),i=t.util.cos(n)*r,a=t.util.sin(n)*r,u,s;typeof this.originX=="string"?u=e[this.originX]:u=this.originX-.5,typeof o=="string"?s=e[o]:s=o-.5,this.left+=i*(s-u),this.top+=a*(s-u),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function h(r){return[new t.Point(r.tl.x,r.tl.y),new t.Point(r.tr.x,r.tr.y),new t.Point(r.br.x,r.br.y),new t.Point(r.bl.x,r.bl.y)]}var e=t.util,c=e.degreesToRadians,o=e.multiplyTransformMatrices,n=e.transformPoint;e.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(r,i){return i?r?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),r?this.aCoords:this.lineCoords)},getCoords:function(r,i){return h(this._getCoords(r,i))},intersectsWithRect:function(r,i,a,u){var s=this.getCoords(a,u),d=t.Intersection.intersectPolygonRectangle(s,r,i);return d.status==="Intersection"},intersectsWithObject:function(r,i,a){var u=t.Intersection.intersectPolygonPolygon(this.getCoords(i,a),r.getCoords(i,a));return u.status==="Intersection"||r.isContainedWithinObject(this,i,a)||this.isContainedWithinObject(r,i,a)},isContainedWithinObject:function(r,i,a){for(var u=this.getCoords(i,a),s=i?r.aCoords:r.lineCoords,d=0,g=r._getImageLines(s);d<4;d++)if(!r.containsPoint(u[d],g))return!1;return!0},isContainedWithinRect:function(r,i,a,u){var s=this.getBoundingRect(a,u);return s.left>=r.x&&s.left+s.width<=i.x&&s.top>=r.y&&s.top+s.height<=i.y},containsPoint:function(r,d,a,u){var s=this._getCoords(a,u),d=d||this._getImageLines(s),g=this._findCrossPoints(r,d);return g!==0&&g%2===1},isOnScreen:function(r){if(!this.canvas)return!1;var i=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br,u=this.getCoords(!0,r);return u.some(function(s){return s.x<=a.x&&s.x>=i.x&&s.y<=a.y&&s.y>=i.y})||this.intersectsWithRect(i,a,!0,r)?!0:this._containsCenterOfCanvas(i,a,r)},_containsCenterOfCanvas:function(r,i,a){var u={x:(r.x+i.x)/2,y:(r.y+i.y)/2};return!!this.containsPoint(u,null,!0,a)},isPartiallyOnScreen:function(r){if(!this.canvas)return!1;var i=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;if(this.intersectsWithRect(i,a,!0,r))return!0;var u=this.getCoords(!0,r).every(function(s){return(s.x>=a.x||s.x<=i.x)&&(s.y>=a.y||s.y<=i.y)});return u&&this._containsCenterOfCanvas(i,a,r)},_getImageLines:function(r){var i={topline:{o:r.tl,d:r.tr},rightline:{o:r.tr,d:r.br},bottomline:{o:r.br,d:r.bl},leftline:{o:r.bl,d:r.tl}};return i},_findCrossPoints:function(r,i){var a,u,s,d,g,p=0,_;for(var C in i)if(_=i[C],!(_.o.y<r.y&&_.d.y<r.y)&&!(_.o.y>=r.y&&_.d.y>=r.y)&&(_.o.x===_.d.x&&_.o.x>=r.x?g=_.o.x:(a=0,u=(_.d.y-_.o.y)/(_.d.x-_.o.x),s=r.y-a*r.x,d=_.o.y-u*_.o.x,g=-(s-d)/(a-u)),g>=r.x&&(p+=1),p===2))break;return p},getBoundingRect:function(r,i){var a=this.getCoords(r,i);return e.makeBoundingBoxFromPoints(a)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(r){return Math.abs(r)<this.minScaleLimit?r<0?-this.minScaleLimit:this.minScaleLimit:r===0?1e-4:r},scale:function(r){return this._set("scaleX",r),this._set("scaleY",r),this.setCoords()},scaleToWidth:function(r,i){var a=this.getBoundingRect(i).width/this.getScaledWidth();return this.scale(r/this.width/a)},scaleToHeight:function(r,i){var a=this.getBoundingRect(i).height/this.getScaledHeight();return this.scale(r/this.height/a)},calcLineCoords:function(){var r=this.getViewportTransform(),i=this.padding,a=c(this.angle),u=e.cos(a),s=e.sin(a),d=u*i,g=s*i,p=d+g,_=d-g,C=this.calcACoords(),w={tl:n(C.tl,r),tr:n(C.tr,r),bl:n(C.bl,r),br:n(C.br,r)};return i&&(w.tl.x-=_,w.tl.y-=p,w.tr.x+=p,w.tr.y-=_,w.bl.x-=p,w.bl.y+=_,w.br.x+=_,w.br.y+=p),w},calcOCoords:function(){var r=this._calcRotateMatrix(),i=this._calcTranslateMatrix(),a=this.getViewportTransform(),u=o(a,i),s=o(u,r),s=o(s,[1/a[0],0,0,1/a[3],0,0]),d=this._calculateCurrentDimensions(),g={};return this.forEachControl(function(p,_,C){g[_]=p.positionHandler(d,s,C)}),g},calcACoords:function(){var r=this._calcRotateMatrix(),i=this._calcTranslateMatrix(),a=o(i,r),u=this._getTransformedDimensions(),s=u.x/2,d=u.y/2;return{tl:n({x:-s,y:-d},a),tr:n({x:s,y:-d},a),bl:n({x:-s,y:d},a),br:n({x:s,y:d},a)}},setCoords:function(r){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),r?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var r=this.getCenterPoint();return[1,0,0,1,r.x,r.y]},transformMatrixKey:function(r){var i="_",a="";return!r&&this.group&&(a=this.group.transformMatrixKey(r)+i),a+this.top+i+this.left+i+this.scaleX+i+this.scaleY+i+this.skewX+i+this.skewY+i+this.angle+i+this.originX+i+this.originY+i+this.width+i+this.height+i+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(r){var i=this.calcOwnMatrix();if(r||!this.group)return i;var a=this.transformMatrixKey(r),u=this.matrixCache||(this.matrixCache={});return u.key===a?u.value:(this.group&&(i=o(this.group.calcTransformMatrix(!1),i)),u.key=a,u.value=i,i)},calcOwnMatrix:function(){var r=this.transformMatrixKey(!0),i=this.ownMatrixCache||(this.ownMatrixCache={});if(i.key===r)return i.value;var a=this._calcTranslateMatrix(),u={angle:this.angle,translateX:a[4],translateY:a[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return i.key=r,i.value=e.composeMatrix(u),i.value},_getNonTransformedDimensions:function(){var r=this.strokeWidth,i=this.width+r,a=this.height+r;return{x:i,y:a}},_getTransformedDimensions:function(r,i){typeof r>"u"&&(r=this.skewX),typeof i>"u"&&(i=this.skewY);var a,u,s,d=r===0&&i===0;if(this.strokeUniform?(u=this.width,s=this.height):(a=this._getNonTransformedDimensions(),u=a.x,s=a.y),d)return this._finalizeDimensions(u*this.scaleX,s*this.scaleY);var g=e.sizeAfterTransform(u,s,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:r,skewY:i});return this._finalizeDimensions(g.x,g.y)},_finalizeDimensions:function(r,i){return this.strokeUniform?{x:r+this.strokeWidth,y:i+this.strokeWidth}:{x:r,y:i}},_calculateCurrentDimensions:function(){var r=this.getViewportTransform(),i=this._getTransformedDimensions(),a=n(i,r,!0);return a.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(h){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,h):this.canvas&&this.canvas.sendBackwards(this,h),this},bringForward:function(h){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,h):this.canvas&&this.canvas.bringForward(this,h),this},moveTo:function(h){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,h):this.canvas&&this.canvas.moveTo(this,h),this}}),function(){function h(c,o){if(o){if(o.toLive)return c+": url(#SVGID_"+o.id+"); ";var n=new t.Color(o),r=c+": "+n.toRgb()+"; ",i=n.getAlpha();return i!==1&&(r+=c+"-opacity: "+i.toString()+"; "),r}else return c+": none; "}var e=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var o=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):"none",i=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",u=this.strokeLineJoin?this.strokeLineJoin:"miter",s=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=typeof this.opacity<"u"?this.opacity:"1",g=this.visible?"":" visibility: hidden;",p=c?"":this.getSvgFilter(),_=h("fill",this.fill),C=h("stroke",this.stroke);return[C,"stroke-width: ",n,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",u,"; ","stroke-miterlimit: ",s,"; ",_,"fill-rule: ",o,"; ","opacity: ",d,";",p,g].join("")},getSvgSpanStyles:function(c,o){var n="; ",i=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+n:"",r=c.strokeWidth?"stroke-width: "+c.strokeWidth+n:"",i=i,a=c.fontSize?"font-size: "+c.fontSize+"px"+n:"",u=c.fontStyle?"font-style: "+c.fontStyle+n:"",s=c.fontWeight?"font-weight: "+c.fontWeight+n:"",d=c.fill?h("fill",c.fill):"",g=c.stroke?h("stroke",c.stroke):"",p=this.getSvgTextDecoration(c),_=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return p&&(p="text-decoration: "+p+n),[g,r,i,a,u,s,p,d,_,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(o){return c[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,o){var n=c?this.calcTransformMatrix():this.calcOwnMatrix(),r='transform="'+t.util.matrixToSVG(n);return r+(o||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var o=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,o),'" y="',e(-this.height/2,o),'" width="',e(this.width,o),'" height="',e(this.height,o),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,o){o=o||{};var n=o.reviver,r=o.additionalTransform||"",i=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),a=c.indexOf("COMMON_PARTS");return c[a]=i,n?n(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,o){o=o||{};var n=o.noStyle,r=o.reviver,i=n?"":'style="'+this.getSvgStyles()+'" ',a=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",u=this.clipPath,s=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=u&&u.absolutePositioned,g=this.stroke,p=this.fill,_=this.shadow,C,w=[],S,O=c.indexOf("COMMON_PARTS"),I=o.additionalTransform;return u&&(u.clipPathId="CLIPPATH_"+t.Object.__uid++,S='<clipPath id="'+u.clipPathId+`" >
`+u.toClipPathSVG(r)+`</clipPath>
`),d&&w.push("<g ",a,this.getSvgCommons(),` >
`),w.push("<g ",this.getSvgTransform(!1),d?"":a+this.getSvgCommons(),` >
`),C=[i,s,n?"":this.addPaintOrder()," ",I?'transform="'+I+'" ':""].join(""),c[O]=C,p&&p.toLive&&w.push(p.toSVG(this)),g&&g.toLive&&w.push(g.toSVG(this)),_&&w.push(_.toSVG(this)),u&&w.push(S),w.push(c.join("")),w.push(`</g>
`),d&&w.push(`</g>
`),r?r(w.join("")):w.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var h=t.util.object.extend,e="stateProperties";function c(n,r,i){var a={},u=!0;i.forEach(function(s){a[s]=n[s]}),h(n[r],a,u)}function o(n,r,i){if(n===r)return!0;if(Array.isArray(n)){if(!Array.isArray(r)||n.length!==r.length)return!1;for(var a=0,u=n.length;a<u;a++)if(!o(n[a],r[a]))return!1;return!0}else if(n&&typeof n=="object"){var s=Object.keys(n),d;if(!r||typeof r!="object"||!i&&s.length!==Object.keys(r).length)return!1;for(var a=0,u=s.length;a<u;a++)if(d=s[a],!(d==="canvas"||d==="group")&&!o(n[d],r[d]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(n){n=n||e;var r="_"+n;return Object.keys(this[r]).length<this[n].length?!0:!o(this[r],this,!0)},saveState:function(n){var r=n&&n.propertySet||e,i="_"+r;return this[i]?(c(this,i,this[r]),n&&n.stateProperties&&c(this,i,n.stateProperties),this):this.setupState(n)},setupState:function(n){n=n||{};var r=n.propertySet||e;return n.propertySet=r,this["_"+r]={},this.saveState(n),this}})}(),function(){var h=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(e,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=e.x,n=e.y,r,i,a=Object.keys(this.oCoords),u=a.length-1,s;for(this.__corner=0;u>=0;u--)if(s=a[u],!!this.isControlVisible(s)&&(i=this._getImageLines(c?this.oCoords[s].touchCorner:this.oCoords[s].corner),r=this._findCrossPoints({x:o,y:n},i),r!==0&&r%2===1))return this.__corner=s,s;return!1},forEachControl:function(e){for(var c in this.controls)e(this.controls[c],c,this)},_setCornerCoords:function(){var e=this.oCoords;for(var c in e){var o=this.controls[c];e[c].corner=o.calcCornerCoords(this.angle,this.cornerSize,e[c].x,e[c].y,!1),e[c].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,e[c].x,e[c].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var c=this.getCenterPoint(),o=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return e.translate(c.x,c.y),e.scale(1/n[0],1/n[3]),e.rotate(h(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-o.x/2,-o.y/2,o.x,o.y),e.restore(),this},drawBorders:function(e,c){c=c||{};var o=this._calculateCurrentDimensions(),n=this.borderScaleFactor,r=o.x+n,i=o.y+n,a=typeof c.hasControls<"u"?c.hasControls:this.hasControls,u=!1;return e.save(),e.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(e,c.borderDashArray||this.borderDashArray),e.strokeRect(-r/2,-i/2,r,i),a&&(e.beginPath(),this.forEachControl(function(s,d,g){s.withConnection&&s.getVisibility(g,d)&&(u=!0,e.moveTo(s.x*r,s.y*i),e.lineTo(s.x*r+s.offsetX,s.y*i+s.offsetY))}),u&&e.stroke()),e.restore(),this},drawBordersInGroup:function(e,c,o){o=o||{};var n=t.util.sizeAfterTransform(this.width,this.height,c),r=this.strokeWidth,i=this.strokeUniform,a=this.borderScaleFactor,u=n.x+r*(i?this.canvas.getZoom():c.scaleX)+a,s=n.y+r*(i?this.canvas.getZoom():c.scaleY)+a;return e.save(),this._setLineDash(e,o.borderDashArray||this.borderDashArray),e.strokeStyle=o.borderColor||this.borderColor,e.strokeRect(-u/2,-s/2,u,s),e.restore(),this},drawControls:function(e,c){c=c||{},e.save();var o=this.canvas.getRetinaScaling(),n,r;return e.setTransform(o,0,0,o,0,0),e.strokeStyle=e.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl(function(i,a,u){r=u.oCoords[a],i.getVisibility(u,a)&&(n&&(r=t.util.transformPoint(r,n)),i.render(e,r.x,r.y,c,u))}),e.restore(),this},isControlVisible:function(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)},setControlVisible:function(e,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=c,this},setControlsVisibility:function(e){e||(e={});for(var c in e)this.setControlVisible(c,e[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(h,e){e=e||{};var c=function(){},o=e.onComplete||c,n=e.onChange||c,r=this;return t.util.animate({target:this,startValue:h.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(i){h.set("left",i),r.requestRenderAll(),n()},onComplete:function(){h.setCoords(),o()}})},fxCenterObjectV:function(h,e){e=e||{};var c=function(){},o=e.onComplete||c,n=e.onChange||c,r=this;return t.util.animate({target:this,startValue:h.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(i){h.set("top",i),r.requestRenderAll(),n()},onComplete:function(){h.setCoords(),o()}})},fxRemove:function(h,e){e=e||{};var c=function(){},o=e.onComplete||c,n=e.onChange||c,r=this;return t.util.animate({target:this,startValue:h.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(i){h.set("opacity",i),r.requestRenderAll(),n()},onComplete:function(){r.remove(h),o()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var h=[],e,c,o=[];for(e in arguments[0])h.push(e);for(var n=0,r=h.length;n<r;n++)e=h[n],c=n!==r-1,o.push(this._animate(e,arguments[0][e],arguments[1],c));return o}else return this._animate.apply(this,arguments)},_animate:function(h,e,c,o){var n=this,r;e=e.toString(),c?c=t.util.object.clone(c):c={},~h.indexOf(".")&&(r=h.split("."));var i=n.colorProperties.indexOf(h)>-1||r&&n.colorProperties.indexOf(r[1])>-1,a=r?this.get(r[0])[r[1]]:this.get(h);"from"in c||(c.from=a),i||(~e.indexOf("=")?e=a+parseFloat(e.replace("=","")):e=parseFloat(e));var u={target:this,startValue:c.from,endValue:e,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(s,d,g){return c.abort.call(n,s,d,g)},onChange:function(s,d,g){r?n[r[0]][r[1]]=s:n.set(h,s),!o&&c.onChange&&c.onChange(s,d,g)},onComplete:function(s,d,g){o||(n.setCoords(),c.onComplete&&c.onComplete(s,d,g))}};return i?t.util.animateColor(u.startValue,u.endValue,u.duration,u):t.util.animate(u)}}),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.extend,o=e.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};if(e.Line){e.warn("fabric.Line is already defined");return}e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(i,a){i||(i=[0,0,0,0]),this.callSuper("initialize",a),this.set("x1",i[0]),this.set("y1",i[1]),this.set("x2",i[2]),this.set("y2",i[3]),this._setWidthHeight(a)},_setWidthHeight:function(i){i||(i={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in i?i.left:this._getLeftToOriginX(),this.top="top"in i?i.top:this._getTopToOriginY()},_set:function(i,a){return this.callSuper("_set",i,a),typeof n[i]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:r({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:r({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(i){i.beginPath();var a=this.calcLinePoints();i.moveTo(a.x1,a.y1),i.lineTo(a.x2,a.y2),i.lineWidth=this.strokeWidth;var u=i.strokeStyle;i.strokeStyle=this.stroke||i.fillStyle,this.stroke&&this._renderStroke(i),i.strokeStyle=u},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(i){return c(this.callSuper("toObject",i),this.calcLinePoints())},_getNonTransformedDimensions:function(){var i=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(i.y-=this.strokeWidth),this.height===0&&(i.x-=this.strokeWidth)),i},calcLinePoints:function(){var i=this.x1<=this.x2?-1:1,a=this.y1<=this.y2?-1:1,u=i*this.width*.5,s=a*this.height*.5,d=i*this.width*-.5,g=a*this.height*-.5;return{x1:u,x2:d,y1:s,y2:g}},_toSVG:function(){var i=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,`" />
`]}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(i,a,u){u=u||{};var s=e.parseAttributes(i,e.Line.ATTRIBUTE_NAMES),d=[s.x1||0,s.y1||0,s.x2||0,s.y2||0];a(new e.Line(d,c(s,u)))},e.Line.fromObject=function(i,a){function u(d){delete d.points,a&&a(d)}var s=o(i,!0);s.points=[i.x1,i.y1,i.x2,i.y2],e.Object._fromObject("Line",s,u,"points")};function r(i,a){var u=i.origin,s=i.axis1,d=i.axis2,g=i.dimension,p=a.nearest,_=a.center,C=a.farthest;return function(){switch(this.get(u)){case p:return Math.min(this.get(s),this.get(d));case _:return Math.min(this.get(s),this.get(d))+.5*this.get(g);case C:return Math.max(this.get(s),this.get(d))}}}}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.degreesToRadians;if(e.Circle){e.warn("fabric.Circle is already defined.");return}e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(n,r){return this.callSuper("_set",n,r),n==="radius"&&this.setRadius(r),this},toObject:function(n){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(n))},_toSVG:function(){var n,r=0,i=0,a=(this.endAngle-this.startAngle)%360;if(a===0)n=["<circle ","COMMON_PARTS",'cx="'+r+'" cy="'+i+'" ','r="',this.radius,`" />
`];else{var u=c(this.startAngle),s=c(this.endAngle),d=this.radius,g=e.util.cos(u)*d,p=e.util.sin(u)*d,_=e.util.cos(s)*d,C=e.util.sin(s)*d,w=a>180?"1":"0";n=['<path d="M '+g+" "+p," A "+d+" "+d," 0 ",+w+" 1"," "+_+" "+C,'" ',"COMMON_PARTS",` />
`]}return n},_render:function(n){n.beginPath(),n.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(n)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(n){return this.radius=n,this.set("width",n*2).set("height",n*2)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(n,r){var i=e.parseAttributes(n,e.Circle.ATTRIBUTE_NAMES);if(!o(i))throw new Error("value of `r` attribute is required and can not be negative");i.left=(i.left||0)-i.radius,i.top=(i.top||0)-i.radius,r(new e.Circle(i))};function o(n){return"radius"in n&&n.radius>=0}e.Circle.fromObject=function(n,r){e.Object._fromObject("Circle",n,r)}}(l),function(h){var e=h.fabric||(h.fabric={});if(e.Triangle){e.warn("fabric.Triangle is already defined");return}e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(c){var o=this.width/2,n=this.height/2;c.beginPath(),c.moveTo(-o,n),c.lineTo(0,-n),c.lineTo(o,n),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,o=this.height/2,n=[-c+" "+o,"0 "+-o,c+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),e.Triangle.fromObject=function(c,o){return e.Object._fromObject("Triangle",c,o)}}(l),function(h){var e=h.fabric||(h.fabric={}),c=Math.PI*2;if(e.Ellipse){e.warn("fabric.Ellipse is already defined.");return}e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,n){switch(this.callSuper("_set",o,n),o){case"rx":this.rx=n,this.set("width",n*2);break;case"ry":this.ry=n,this.set("height",n*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,c,!1),o.restore(),this._renderPaintInOrder(o)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(o,n){var r=e.parseAttributes(o,e.Ellipse.ATTRIBUTE_NAMES);r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,n(new e.Ellipse(r))},e.Ellipse.fromObject=function(o,n){e.Object._fromObject("Ellipse",o,n)}}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.extend;if(e.Rect){e.warn("fabric.Rect is already defined");return}e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var n=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,a=this.height,u=-this.width/2,s=-this.height/2,d=n!==0||r!==0,g=1-.5522847498;o.beginPath(),o.moveTo(u+n,s),o.lineTo(u+i-n,s),d&&o.bezierCurveTo(u+i-g*n,s,u+i,s+g*r,u+i,s+r),o.lineTo(u+i,s+a-r),d&&o.bezierCurveTo(u+i,s+a-g*r,u+i-g*n,s+a,u+i-n,s+a),o.lineTo(u+n,s+a),d&&o.bezierCurveTo(u+g*n,s+a,u,s+a-g*r,u,s+a-r),o.lineTo(u,s+r),d&&o.bezierCurveTo(u,s+g*r,u+g*n,s,u+n,s),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,n=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',n,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(o,n,r){if(!o)return n(null);r=r||{};var i=e.parseAttributes(o,e.Rect.ATTRIBUTE_NAMES);i.left=i.left||0,i.top=i.top||0,i.height=i.height||0,i.width=i.width||0;var a=new e.Rect(c(r?e.util.object.clone(r):{},i));a.visible=a.visible&&a.width>0&&a.height>0,n(a)},e.Rect.fromObject=function(o,n){return e.Object._fromObject("Rect",o,n)}}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.extend,o=e.util.array.min,n=e.util.array.max,r=e.util.toFixed,i=e.util.projectStrokeOnPoints;if(e.Polyline){e.warn("fabric.Polyline is already defined");return}e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(a,u){u=u||{},this.points=a||[],this.callSuper("initialize",u),this._setPositionDimensions(u)},_projectStrokeOnPoints:function(){return i(this.points,this,!0)},_setPositionDimensions:function(a){var u=this._calcDimensions(a),s,d=this.exactBoundingBox?this.strokeWidth:0;this.width=u.width-d,this.height=u.height-d,a.fromSVG||(s=this.translateToGivenOrigin({x:u.left-this.strokeWidth/2+d/2,y:u.top-this.strokeWidth/2+d/2},"left","top",this.originX,this.originY)),typeof a.left>"u"&&(this.left=a.fromSVG?u.left:s.x),typeof a.top>"u"&&(this.top=a.fromSVG?u.top:s.y),this.pathOffset={x:u.left+this.width/2+d/2,y:u.top+this.height/2+d/2}},_calcDimensions:function(){var a=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,u=o(a,"x")||0,s=o(a,"y")||0,d=n(a,"x")||0,g=n(a,"y")||0,p=d-u,_=g-s;return{left:u,top:s,width:p,height:_}},toObject:function(a){return c(this.callSuper("toObject",a),{points:this.points.concat()})},_toSVG:function(){for(var a=[],u=this.pathOffset.x,s=this.pathOffset.y,d=e.Object.NUM_FRACTION_DIGITS,g=0,p=this.points.length;g<p;g++)a.push(r(this.points[g].x-u,d),",",r(this.points[g].y-s,d)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',a.join(""),`" />
`]},commonRender:function(a){var u,s=this.points.length,d=this.pathOffset.x,g=this.pathOffset.y;if(!s||isNaN(this.points[s-1].y))return!1;a.beginPath(),a.moveTo(this.points[0].x-d,this.points[0].y-g);for(var p=0;p<s;p++)u=this.points[p],a.lineTo(u.x-d,u.y-g);return!0},_render:function(a){this.commonRender(a)&&this._renderPaintInOrder(a)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(a){return function(u,s,d){if(!u)return s(null);d||(d={});var g=e.parsePointsAttribute(u.getAttribute("points")),p=e.parseAttributes(u,e[a].ATTRIBUTE_NAMES);p.fromSVG=!0,s(new e[a](g,c(p,d)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(a,u){return e.Object._fromObject("Polyline",a,u,"points")}}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.projectStrokeOnPoints;if(e.Polygon){e.warn("fabric.Polygon is already defined");return}e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(o,n){e.Object._fromObject("Polygon",o,n,"points")}}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.array.min,o=e.util.array.max,n=e.util.object.extend,r=e.util.object.clone,i=e.util.toFixed;if(e.Path){e.warn("fabric.Path is already defined");return}e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(a,u){u=r(u||{}),delete u.path,this.callSuper("initialize",u),this._setPath(a||[],u)},_setPath:function(a,u){this.path=e.util.makePathSimpler(Array.isArray(a)?a:e.util.parsePath(a)),e.Polyline.prototype._setPositionDimensions.call(this,u||{})},_renderPathCommands:function(a){var u,s=0,d=0,g=0,p=0,_=0,C=0,w=-this.pathOffset.x,S=-this.pathOffset.y;a.beginPath();for(var O=0,I=this.path.length;O<I;++O)switch(u=this.path[O],u[0]){case"L":g=u[1],p=u[2],a.lineTo(g+w,p+S);break;case"M":g=u[1],p=u[2],s=g,d=p,a.moveTo(g+w,p+S);break;case"C":g=u[5],p=u[6],_=u[3],C=u[4],a.bezierCurveTo(u[1]+w,u[2]+S,_+w,C+S,g+w,p+S);break;case"Q":a.quadraticCurveTo(u[1]+w,u[2]+S,u[3]+w,u[4]+S),g=u[3],p=u[4],_=u[1],C=u[2];break;case"z":case"Z":g=s,p=d,a.closePath();break}},_render:function(a){this._renderPathCommands(a),this._renderPaintInOrder(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){return n(this.callSuper("toObject",a),{path:this.path.map(function(u){return u.slice()})})},toDatalessObject:function(a){var u=this.toObject(["sourcePath"].concat(a));return u.sourcePath&&delete u.path,u},_toSVG:function(){var a=e.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',a,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var a=e.Object.NUM_FRACTION_DIGITS;return" translate("+i(-this.pathOffset.x,a)+", "+i(-this.pathOffset.y,a)+")"},toClipPathSVG:function(a){var u=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:u})},toSVG:function(a){var u=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:u})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var a=[],u=[],s,d=0,g=0,p=0,_=0,C,w=0,S=this.path.length;w<S;++w){switch(s=this.path[w],s[0]){case"L":p=s[1],_=s[2],C=[];break;case"M":p=s[1],_=s[2],d=p,g=_,C=[];break;case"C":C=e.util.getBoundsOfCurve(p,_,s[1],s[2],s[3],s[4],s[5],s[6]),p=s[5],_=s[6];break;case"Q":C=e.util.getBoundsOfCurve(p,_,s[1],s[2],s[1],s[2],s[3],s[4]),p=s[3],_=s[4];break;case"z":case"Z":p=d,_=g;break}C.forEach(function(U){a.push(U.x),u.push(U.y)}),a.push(p),u.push(_)}var O=c(a)||0,I=c(u)||0,X=o(a)||0,Q=o(u)||0,tt=X-O,Y=Q-I;return{left:O,top:I,width:tt,height:Y}}}),e.Path.fromObject=function(a,u){if(typeof a.sourcePath=="string"){var s=a.sourcePath;e.loadSVGFromURL(s,function(d){var g=d[0];g.setOptions(a),a.clipPath?e.util.enlivenObjects([a.clipPath],function(p){g.clipPath=p[0],u&&u(g)}):u&&u(g)})}else e.Object._fromObject("Path",a,u,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(a,u,s){var d=e.parseAttributes(a,e.Path.ATTRIBUTE_NAMES);d.fromSVG=!0,u(new e.Path(d.d,n(d,s)))}}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.array.min,o=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,r,i){r=r||{},this._objects=[],i&&this.callSuper("initialize",r),this._objects=n||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;if(i)this._updateObjectsACoords();else{var u=r&&r.centerPoint;r.originX!==void 0&&(this.originX=r.originX),r.originY!==void 0&&(this.originY=r.originY),u||this._calcBounds(),this._updateObjectsCoords(u),delete r.centerPoint,this.callSuper("initialize",r)}this.setCoords()},_updateObjectsACoords:function(){for(var n=!0,r=this._objects.length;r--;)this._objects[r].setCoords(n)},_updateObjectsCoords:function(r){for(var r=r||this.getCenterPoint(),i=this._objects.length;i--;)this._updateObjectCoords(this._objects[i],r)},_updateObjectCoords:function(n,r){var i=n.left,a=n.top,u=!0;n.set({left:i-r.x,top:a-r.y}),n.group=this,n.setCoords(u)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var r=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),n&&(r&&e.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,r?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,r){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(n,r);if(n==="canvas")for(;i--;)this._objects[i]._set(n,r);e.Object.prototype._set.call(this,n,r)},toObject:function(n){var r=this.includeDefaultValues,i=this._objects.filter(function(u){return!u.excludeFromExport}).map(function(u){var s=u.includeDefaultValues;u.includeDefaultValues=r;var d=u.toObject(n);return u.includeDefaultValues=s,d}),a=e.Object.prototype.toObject.call(this,n);return a.objects=i,a},toDatalessObject:function(n){var r,i=this.sourcePath;if(i)r=i;else{var a=this.includeDefaultValues;r=this._objects.map(function(s){var d=s.includeDefaultValues;s.includeDefaultValues=a;var g=s.toDatalessObject(n);return s.includeDefaultValues=d,g})}var u=e.Object.prototype.toDatalessObject.call(this,n);return u.objects=r,u},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=e.Object.prototype.shouldCache.call(this);if(n){for(var r=0,i=this._objects.length;r<i;r++)if(this._objects[r].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,r=this._objects.length;n<r;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var r=0,i=this._objects.length;r<i;r++)this._objects[r].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var r=0,i=this._objects.length;r<i;r++)if(this._objects[r].isCacheDirty(!0)){if(this._cacheCanvas){var a=this.cacheWidth/this.zoomX,u=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-a/2,-u/2,a,u)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(r){e.util.addTransformToObject(r,n),delete r.group,r.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,r=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var a=new e.ActiveSelection([]);return a.set(i),a.type="activeSelection",r.remove(this),n.forEach(function(u){u.group=a,u.dirty=!0,r.add(u)}),a.canvas=r,a._objects=n,r._activeObject=a,a.setCoords(),a}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var n=!0;return this.forEachObject(function(r){r.setCoords(n)}),this},_calcBounds:function(n){for(var r=[],i=[],a,u,s,d=["tr","br","bl","tl"],g=0,p=this._objects.length,_,C=d.length;g<p;++g){for(a=this._objects[g],s=a.calcACoords(),_=0;_<C;_++)u=d[_],r.push(s[u].x),i.push(s[u].y);a.aCoords=s}this._getBounds(r,i,n)},_getBounds:function(n,r,i){var a=new e.Point(c(n),c(r)),u=new e.Point(o(n),o(r)),s=a.y||0,d=a.x||0,g=u.x-a.x||0,p=u.y-a.y||0;this.width=g,this.height=p,i||this.setPositionByOrigin({x:d,y:s},"left","top")},_toSVG:function(n){for(var r=["<g ","COMMON_PARTS",` >
`],i=0,a=this._objects.length;i<a;i++)r.push("		",this._objects[i].toSVG(n));return r.push(`</g>
`),r},getSvgStyles:function(){var n=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",r=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),r].join("")},toClipPathSVG:function(n){for(var r=[],i=0,a=this._objects.length;i<a;i++)r.push("	",this._objects[i].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(r,{reviver:n})}}),e.Group.fromObject=function(n,r){var i=n.objects,a=e.util.object.clone(n,!0);if(delete a.objects,typeof i=="string"){e.loadSVGFromURL(i,function(u){var s=e.util.groupSVGElements(u,n,i),d=a.clipPath;delete a.clipPath,s.set(a),d?e.util.enlivenObjects([d],function(g){s.clipPath=g[0],r&&r(s)}):r&&r(s)});return}e.util.enlivenObjects(i,function(u){e.util.enlivenObjectEnlivables(n,a,function(){r&&r(new e.Group(u,a,!0))})})})}(l),function(h){var e=h.fabric||(h.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(c,o){o=o||{},this._objects=c||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var o=e.Object.prototype.toObject.call(this),n=new e.Group([]);if(delete o.type,n.set(o),c.forEach(function(i){i.canvas.remove(i),i.group=n}),n._objects=c,!this.canvas)return n;var r=this.canvas;return r.add(n),r._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,o,n){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",c,o),n=n||{},typeof n.hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var r=0,i=this._objects.length;r<i;r++)this._objects[r]._renderControls(c,n);c.restore()}}),e.ActiveSelection.fromObject=function(c,o){e.util.enlivenObjects(c.objects,function(n){delete c.objects,o&&o(new e.ActiveSelection(n,c,!0))})})}(l),function(h){var e=t.util.object.extend;if(h.fabric||(h.fabric={}),h.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,o){o||(o={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",o),this._initElement(c,o)},getElement:function(){return this._element||{}},setElement:function(c,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var o=t.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,n=this.height/2;c.beginPath(),c.moveTo(-o,-n),c.lineTo(o,-n),c.lineTo(o,n),c.lineTo(-o,n),c.lineTo(-o,-n),c.closePath()}},toObject:function(c){var o=[];this.filters.forEach(function(r){r&&o.push(r.toObject())});var n=e(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],o=[],n,r=this._element,i=-this.width/2,a=-this.height/2,u="",s="";if(!r)return[];if(this.hasCrop()){var d=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+i+'" y="'+a+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),u=' clip-path="url(#imageCrop_'+d+')" '}if(this.imageSmoothing||(s='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',i-this.cropX,'" y="',a-this.cropY,'" width="',r.width||r.naturalWidth,'" height="',r.height||r.height,s,'"',u,`></image>
`),this.stroke||this.strokeDashArray){var g=this.fill;this.fill=null,n=["	<rect ",'x="',i,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=g}return this.paintFirst!=="fill"?c=c.concat(n,o):c=c.concat(o,n),c},getSrc:function(c){var o=c?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(c,o,n){return t.util.loadImage(c,function(r,i){this.setElement(r,n),this._setWidthHeight(),o&&o(this,i)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,o=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),r=n.scaleX,i=n.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||r>o&&i>o){this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,this._lastScaleY=i;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var u=t.util.createCanvasElement(),s=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,d=a.width,g=a.height;u.width=d,u.height=g,this._element=u,this._lastScaleX=c.scaleX=r,this._lastScaleY=c.scaleY=i,t.filterBackend.applyFilters([c],a,d,g,this._element,s),this._filterScalingX=u.width/this._originalElement.width,this._filterScalingY=u.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(a){return a&&!a.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,n=o.naturalWidth||o.width,r=o.naturalHeight||o.height;if(this._element===this._originalElement){var i=t.util.createCanvasElement();i.width=n,i.height=r,this._element=i,this._filteredEl=i}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,r),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,n,r,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var o=this._element;if(o){var n=this._filterScalingX,r=this._filterScalingY,i=this.width,a=this.height,u=Math.min,s=Math.max,d=s(this.cropX,0),g=s(this.cropY,0),p=o.naturalWidth||o.width,_=o.naturalHeight||o.height,C=d*n,w=g*r,S=u(i*n,p-C),O=u(a*r,_-w),I=-i/2,X=-a/2,Q=u(i,p/n-d),tt=u(a,_/r-g);o&&c.drawImage(o,C,w,S,O,I,X,Q,tt)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,o){this.setElement(t.util.getById(c),o),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,o){c&&c.length?t.util.enlivenObjects(c,function(n){o&&o(n)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(c){c||(c={});var o=this.getElement();this.width=c.width||o.naturalWidth||o.width||0,this.height=c.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,n=this._element.height,r=1,i=1,a=0,u=0,s=0,d=0,g,p=this.width,_=this.height,C={width:p,height:_};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(r=i=t.util.findScaleToFit(this._element,C),g=(p-o*r)/2,c.alignX==="Min"&&(a=-g),c.alignX==="Max"&&(a=g),g=(_-n*i)/2,c.alignY==="Min"&&(u=-g),c.alignY==="Max"&&(u=g)),c.meetOrSlice==="slice"&&(r=i=t.util.findScaleToCover(this._element,C),g=o-p/r,c.alignX==="Mid"&&(s=g/2),c.alignX==="Max"&&(s=g),g=n-_/i,c.alignY==="Mid"&&(d=g/2),c.alignY==="Max"&&(d=g),o=p/r,n=_/i)):(r=p/o,i=_/n),{width:o,height:n,scaleX:r,scaleY:i,offsetLeft:a,offsetTop:u,cropX:s,cropY:d}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,o){var n=t.util.object.clone(c);t.util.loadImage(n.src,function(r,i){if(i){o&&o(null,!0);return}t.Image.prototype._initFilters.call(n,n.filters,function(a){n.filters=a||[],t.Image.prototype._initFilters.call(n,[n.resizeFilter],function(u){n.resizeFilter=u[0],t.util.enlivenObjectEnlivables(n,n,function(){var s=new t.Image(r,n);o(s,!1)})})})},null,n.crossOrigin)},t.Image.fromURL=function(c,o,n){t.util.loadImage(c,function(r,i){o&&o(new t.Image(r,n),i)},null,n&&n.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,o,n){var r=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(r["xlink:href"],o,e(n?t.util.object.clone(n):{},r))}}(l),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var h=this.angle%360;return h>0?Math.round((h-1)/90)*90:Math.round(h/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(h){h=h||{};var e=function(){},c=h.onComplete||e,o=h.onChange||e,n=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(r){n.rotate(r),o()},onComplete:function(){n.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(h){return h.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(h){return h.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function h(c,o){var n="precision "+o+` float;
void main(){}`,r=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(r,n),c.compileShader(r),!!c.getShaderParameter(r,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),n=o.getContext("webgl")||o.getContext("experimental-webgl"),r=!1;if(n){t.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),r=t.maxTextureSize>=c;for(var i=["highp","mediump","lowp"],a=0;a<3;a++)if(h(n,i[a])){t.webGlPrecision=i[a];break}}return this.isSupported=r,r},t.WebglFilterBackend=e;function e(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}e.prototype={tileSize:2048,resources:{},setupGLContext:function(c,o){this.dispose(),this.createWebGLCanvas(c,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,o)},chooseFastestCopyGLTo2DMethod:function(c,o){var n=typeof window.performance<"u",r;try{new ImageData(1,1),r=!0}catch{r=!1}var i=typeof ArrayBuffer<"u",a=typeof Uint8ClampedArray<"u";if(n&&r&&i&&a){var u=t.util.createCanvasElement(),s=new ArrayBuffer(c*o*4);if(t.forceGLPutImageData){this.imageBuffer=s,this.copyGLTo2D=y;return}var d={imageBuffer:s,destinationWidth:c,destinationHeight:o,targetCanvas:u},g,p,_;u.width=c,u.height=o,g=window.performance.now(),b.call(d,this.gl,d),p=window.performance.now()-g,g=window.performance.now(),y.call(d,this.gl,d),_=window.performance.now()-g,p>_?(this.imageBuffer=s,this.copyGLTo2D=y):this.copyGLTo2D=b}},createWebGLCanvas:function(c,o){var n=t.util.createCanvasElement();n.width=c,n.height=o;var r={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},i=n.getContext("webgl",r);i||(i=n.getContext("experimental-webgl",r)),i&&(i.clearColor(0,0,0,0),this.canvas=n,this.gl=i)},applyFilters:function(c,o,n,r,i,a){var u=this.gl,s;a&&(s=this.getCachedTexture(a,o));var d={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:n,sourceHeight:r,destinationWidth:n,destinationHeight:r,context:u,sourceTexture:this.createTexture(u,n,r,!s&&o),targetTexture:this.createTexture(u,n,r),originalTexture:s||this.createTexture(u,n,r,!s&&o),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},g=u.createFramebuffer();return u.bindFramebuffer(u.FRAMEBUFFER,g),c.forEach(function(p){p&&p.applyTo(d)}),v(d),this.copyGLTo2D(u,d),u.bindTexture(u.TEXTURE_2D,null),u.deleteTexture(d.sourceTexture),u.deleteTexture(d.targetTexture),u.deleteFramebuffer(g),i.getContext("2d").setTransform(1,0,0,1,0,0),d},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,o,n,r,i){var a=c.createTexture();return c.bindTexture(c.TEXTURE_2D,a),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,i||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,i||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),r?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,r):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,o,n,0,c.RGBA,c.UNSIGNED_BYTE,null),a},getCachedTexture:function(c,o){if(this.textureCache[c])return this.textureCache[c];var n=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[c]=n,n},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:b,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,o={renderer:"",vendor:""};if(!c)return o;var n=c.getExtension("WEBGL_debug_renderer_info");if(n){var r=c.getParameter(n.UNMASKED_RENDERER_WEBGL),i=c.getParameter(n.UNMASKED_VENDOR_WEBGL);r&&(o.renderer=r.toLowerCase()),i&&(o.vendor=i.toLowerCase())}return this.gpuInfo=o,o}}}();function v(h){var e=h.targetCanvas,c=e.width,o=e.height,n=h.destinationWidth,r=h.destinationHeight;(c!==n||o!==r)&&(e.width=n,e.height=r)}function b(h,e){var c=h.canvas,o=e.targetCanvas,n=o.getContext("2d");n.translate(0,o.height),n.scale(1,-1);var r=c.height-o.height;n.drawImage(c,0,r,o.width,o.height,0,0,o.width,o.height)}function y(h,e){var c=e.targetCanvas,o=c.getContext("2d"),n=e.destinationWidth,r=e.destinationHeight,i=n*r*4,a=new Uint8Array(this.imageBuffer,0,i),u=new Uint8ClampedArray(this.imageBuffer,0,i);h.readPixels(0,0,n,r,h.RGBA,h.UNSIGNED_BYTE,a);var s=new ImageData(u,n,r);o.putImageData(s,0,0)}(function(){var h=function(){};t.Canvas2dFilterBackend=e;function e(){}e.prototype={evictCachesForKey:h,dispose:h,clearWebGLCaches:h,resources:{},applyFilters:function(c,o,n,r,i){var a=i.getContext("2d");a.drawImage(o,0,0,n,r);var u=a.getImageData(0,0,n,r),s=a.getImageData(0,0,n,r),d={sourceWidth:n,sourceHeight:r,imageData:u,originalEl:o,originalImageData:s,canvasEl:i,ctx:a,filterBackend:this};return c.forEach(function(g){g.applyTo(d)}),(d.imageData.width!==n||d.imageData.height!==r)&&(i.width=d.imageData.width,i.height=d.imageData.height),a.putImageData(d.imageData,0,0),d}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(h){h&&this.setOptions(h)},setOptions:function(h){for(var e in h)this[e]=h[e]},createProgram:function(h,e,c){e=e||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(e=e.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var o=h.createShader(h.VERTEX_SHADER);if(h.shaderSource(o,c),h.compileShader(o),!h.getShaderParameter(o,h.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+h.getShaderInfoLog(o));var n=h.createShader(h.FRAGMENT_SHADER);if(h.shaderSource(n,e),h.compileShader(n),!h.getShaderParameter(n,h.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+h.getShaderInfoLog(n));var r=h.createProgram();if(h.attachShader(r,o),h.attachShader(r,n),h.linkProgram(r),!h.getProgramParameter(r,h.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+h.getProgramInfoLog(r));var i=this.getAttributeLocations(h,r),a=this.getUniformLocations(h,r)||{};return a.uStepW=h.getUniformLocation(r,"uStepW"),a.uStepH=h.getUniformLocation(r,"uStepH"),{program:r,attributeLocations:i,uniformLocations:a}},getAttributeLocations:function(h,e){return{aPosition:h.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(h,e,c){var o=e.aPosition,n=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,n),h.enableVertexAttribArray(o),h.vertexAttribPointer(o,2,h.FLOAT,!1,0,0),h.bufferData(h.ARRAY_BUFFER,c,h.STATIC_DRAW)},_setupFrameBuffer:function(h){var e=h.context,c,o;h.passes>1?(c=h.destinationWidth,o=h.destinationHeight,(h.sourceWidth!==c||h.sourceHeight!==o)&&(e.deleteTexture(h.targetTexture),h.targetTexture=h.filterBackend.createTexture(e,c,o)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,h.targetTexture,0)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish())},_swapTextures:function(h){h.passes--,h.pass++;var e=h.targetTexture;h.targetTexture=h.sourceTexture,h.sourceTexture=e},isNeutralState:function(){var h=this.mainParameter,e=t.Image.filters[this.type].prototype;if(h)if(Array.isArray(e[h])){for(var c=e[h].length;c--;)if(this[h][c]!==e[h][c])return!1;return!0}else return e[h]===this[h];else return!1},applyTo:function(h){h.webgl?(this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},retrieveShader:function(h){return h.programCache.hasOwnProperty(this.type)||(h.programCache[this.type]=this.createProgram(h.context)),h.programCache[this.type]},applyToWebGL:function(h){var e=h.context,c=this.retrieveShader(h);h.pass===0&&h.originalTexture?e.bindTexture(e.TEXTURE_2D,h.originalTexture):e.bindTexture(e.TEXTURE_2D,h.sourceTexture),e.useProgram(c.program),this.sendAttributeData(e,c.attributeLocations,h.aPosition),e.uniform1f(c.uniformLocations.uStepW,1/h.sourceWidth),e.uniform1f(c.uniformLocations.uStepH,1/h.sourceHeight),this.sendUniformData(e,c.uniformLocations),e.viewport(0,0,h.destinationWidth,h.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(h,e,c){h.activeTexture(c),h.bindTexture(h.TEXTURE_2D,e),h.activeTexture(h.TEXTURE0)},unbindAdditionalTexture:function(h,e){h.activeTexture(e),h.bindTexture(h.TEXTURE_2D,null),h.activeTexture(h.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(h){this[this.mainParameter]=h},sendUniformData:function(){},createHelpLayer:function(h){if(!h.helpLayer){var e=document.createElement("canvas");e.width=h.sourceWidth,e.height=h.sourceHeight,h.helpLayer=e}},toObject:function(){var h={type:this.type},e=this.mainParameter;return e&&(h[e]=this[e]),h},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(h,e){var c=new t.Image.filters[h.type](h);return e&&e(c),c},function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.ColorMatrix=o(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var r=n.imageData,i=r.data,a=i.length,u=this.matrix,s,d,g,p,_,C=this.colorsOnly;for(_=0;_<a;_+=4)s=i[_],d=i[_+1],g=i[_+2],C?(i[_]=s*u[0]+d*u[1]+g*u[2]+u[4]*255,i[_+1]=s*u[5]+d*u[6]+g*u[7]+u[9]*255,i[_+2]=s*u[10]+d*u[11]+g*u[12]+u[14]*255):(p=i[_+3],i[_]=s*u[0]+d*u[1]+g*u[2]+p*u[3]+u[4]*255,i[_+1]=s*u[5]+d*u[6]+g*u[7]+p*u[8]+u[9]*255,i[_+2]=s*u[10]+d*u[11]+g*u[12]+p*u[13]+u[14]*255,i[_+3]=s*u[15]+d*u[16]+g*u[17]+p*u[18]+u[19]*255)},getUniformLocations:function(n,r){return{uColorMatrix:n.getUniformLocation(r,"uColorMatrix"),uConstants:n.getUniformLocation(r,"uConstants")}},sendUniformData:function(n,r){var i=this.matrix,a=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],u=[i[4],i[9],i[14],i[19]];n.uniformMatrix4fv(r.uColorMatrix,!1,a),n.uniform4fv(r.uConstants,u)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Brightness=o(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var r=n.imageData,i=r.data,a,u=i.length,s=Math.round(this.brightness*255);for(a=0;a<u;a+=4)i[a]=i[a]+s,i[a+1]=i[a+1]+s,i[a+2]=i[a+2]+s}},getUniformLocations:function(n,r){return{uBrightness:n.getUniformLocation(r,"uBrightness")}},sendUniformData:function(n,r){n.uniform1f(r.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.Convolute=n(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(r){var i=Math.sqrt(this.matrix.length),a=this.type+"_"+i+"_"+(this.opaque?1:0),u=this.fragmentSource[a];return r.programCache.hasOwnProperty(a)||(r.programCache[a]=this.createProgram(r.context,u)),r.programCache[a]},applyTo2d:function(r){var i=r.imageData,a=i.data,u=this.matrix,s=Math.round(Math.sqrt(u.length)),d=Math.floor(s/2),g=i.width,p=i.height,_=r.ctx.createImageData(g,p),C=_.data,w=this.opaque?1:0,S,O,I,X,Q,tt,Y,U,et,st,ft,ut,T;for(ft=0;ft<p;ft++)for(st=0;st<g;st++){for(Q=(ft*g+st)*4,S=0,O=0,I=0,X=0,T=0;T<s;T++)for(ut=0;ut<s;ut++)Y=ft+T-d,tt=st+ut-d,!(Y<0||Y>=p||tt<0||tt>=g)&&(U=(Y*g+tt)*4,et=u[T*s+ut],S+=a[U]*et,O+=a[U+1]*et,I+=a[U+2]*et,w||(X+=a[U+3]*et));C[Q]=S,C[Q+1]=O,C[Q+2]=I,w?C[Q+3]=a[Q+3]:C[Q+3]=X}r.imageData=_},getUniformLocations:function(r,i){return{uMatrix:r.getUniformLocation(i,"uMatrix"),uOpaque:r.getUniformLocation(i,"uOpaque"),uHalfSize:r.getUniformLocation(i,"uHalfSize"),uSize:r.getUniformLocation(i,"uSize")}},sendUniformData:function(r,i){r.uniform1fv(i.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Grayscale=o(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var r=n.imageData,i=r.data,a,u=i.length,s,d=this.mode;for(a=0;a<u;a+=4)d==="average"?s=(i[a]+i[a+1]+i[a+2])/3:d==="lightness"?s=(Math.min(i[a],i[a+1],i[a+2])+Math.max(i[a],i[a+1],i[a+2]))/2:d==="luminosity"&&(s=.21*i[a]+.72*i[a+1]+.07*i[a+2]),i[a]=s,i[a+1]=s,i[a+2]=s},retrieveShader:function(n){var r=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(r)){var i=this.fragmentSource[this.mode];n.programCache[r]=this.createProgram(n.context,i)}return n.programCache[r]},getUniformLocations:function(n,r){return{uMode:n.getUniformLocation(r,"uMode")}},sendUniformData:function(n,r){var i=1;n.uniform1i(r.uMode,i)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Invert=o(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var r=n.imageData,i=r.data,a,u=i.length;for(a=0;a<u;a+=4)i[a]=255-i[a],i[a+1]=255-i[a+1],i[a+2]=255-i[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,r){return{uInvert:n.getUniformLocation(r,"uInvert")}},sendUniformData:function(n,r){n.uniform1i(r.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.Noise=n(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(r){if(this.noise!==0){var i=r.imageData,a=i.data,u,s=a.length,d=this.noise,g;for(u=0,s=a.length;u<s;u+=4)g=(.5-Math.random())*d,a[u]+=g,a[u+1]+=g,a[u+2]+=g}},getUniformLocations:function(r,i){return{uNoise:r.getUniformLocation(i,"uNoise"),uSeed:r.getUniformLocation(i,"uSeed")}},sendUniformData:function(r,i){r.uniform1f(i.uNoise,this.noise/255),r.uniform1f(i.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Pixelate=o(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var r=n.imageData,i=r.data,a=r.height,u=r.width,s,d,g,p,_,C,w,S,O,I,X;for(d=0;d<a;d+=this.blocksize)for(g=0;g<u;g+=this.blocksize)for(s=d*4*u+g*4,p=i[s],_=i[s+1],C=i[s+2],w=i[s+3],I=Math.min(d+this.blocksize,a),X=Math.min(g+this.blocksize,u),S=d;S<I;S++)for(O=g;O<X;O++)s=S*4*u+O*4,i[s]=p,i[s+1]=_,i[s+2]=C,i[s+3]=w},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,r){return{uBlocksize:n.getUniformLocation(r,"uBlocksize"),uStepW:n.getUniformLocation(r,"uStepW"),uStepH:n.getUniformLocation(r,"uStepH")}},sendUniformData:function(n,r){n.uniform1f(r.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.RemoveColor=n(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(r){var i=r.imageData,a=i.data,u,s=this.distance*255,d,g,p,_=new e.Color(this.color).getSource(),C=[_[0]-s,_[1]-s,_[2]-s],w=[_[0]+s,_[1]+s,_[2]+s];for(u=0;u<a.length;u+=4)d=a[u],g=a[u+1],p=a[u+2],d>C[0]&&g>C[1]&&p>C[2]&&d<w[0]&&g<w[1]&&p<w[2]&&(a[u+3]=0)},getUniformLocations:function(r,i){return{uLow:r.getUniformLocation(i,"uLow"),uHigh:r.getUniformLocation(i,"uHigh")}},sendUniformData:function(r,i){var a=new e.Color(this.color).getSource(),u=parseFloat(this.distance),s=[0+a[0]/255-u,0+a[1]/255-u,0+a[2]/255-u,1],d=[a[0]/255+u,a[1]/255+u,a[2]/255+u,1];r.uniform4fv(i.uLow,s),r.uniform4fv(i.uHigh,d)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var r in n)c[r]=o(c.ColorMatrix,{type:r,matrix:n[r],mainParameter:!1,colorsOnly:!0}),e.Image.filters[r].fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric,c=e.Image.filters,o=e.util.createClass;c.BlendColor=o(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var r=this.type+"_"+this.mode,i;return n.programCache.hasOwnProperty(r)||(i=this.buildSource(this.mode),n.programCache[r]=this.createProgram(n.context,i)),n.programCache[r]},applyTo2d:function(n){var r=n.imageData,i=r.data,a=i.length,u,s,d,g,p,_,C,w=1-this.alpha;C=new e.Color(this.color).getSource(),u=C[0]*this.alpha,s=C[1]*this.alpha,d=C[2]*this.alpha;for(var S=0;S<a;S+=4)switch(g=i[S],p=i[S+1],_=i[S+2],this.mode){case"multiply":i[S]=g*u/255,i[S+1]=p*s/255,i[S+2]=_*d/255;break;case"screen":i[S]=255-(255-g)*(255-u)/255,i[S+1]=255-(255-p)*(255-s)/255,i[S+2]=255-(255-_)*(255-d)/255;break;case"add":i[S]=g+u,i[S+1]=p+s,i[S+2]=_+d;break;case"diff":case"difference":i[S]=Math.abs(g-u),i[S+1]=Math.abs(p-s),i[S+2]=Math.abs(_-d);break;case"subtract":i[S]=g-u,i[S+1]=p-s,i[S+2]=_-d;break;case"darken":i[S]=Math.min(g,u),i[S+1]=Math.min(p,s),i[S+2]=Math.min(_,d);break;case"lighten":i[S]=Math.max(g,u),i[S+1]=Math.max(p,s),i[S+2]=Math.max(_,d);break;case"overlay":i[S]=u<128?2*g*u/255:255-2*(255-g)*(255-u)/255,i[S+1]=s<128?2*p*s/255:255-2*(255-p)*(255-s)/255,i[S+2]=d<128?2*_*d/255:255-2*(255-_)*(255-d)/255;break;case"exclusion":i[S]=u+g-2*u*g/255,i[S+1]=s+p-2*s*p/255,i[S+2]=d+_-2*d*_/255;break;case"tint":i[S]=u+g*w,i[S+1]=s+p*w,i[S+2]=d+_*w}},getUniformLocations:function(n,r){return{uColor:n.getUniformLocation(r,"uColor")}},sendUniformData:function(n,r){var i=new e.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,n.uniform4fv(r.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric,c=e.Image.filters,o=e.util.createClass;c.BlendImage=o(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var r=this.type+"_"+this.mode,i=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(r)||(n.programCache[r]=this.createProgram(n.context,i)),n.programCache[r]},applyToWebGL:function(n){var r=n.context,i=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(r,i,r.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(r,r.TEXTURE1)},createTexture:function(n,r){return n.getCachedTexture(r.cacheKey,r._element)},calculateMatrix:function(){var n=this.image,r=n._element.width,i=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/r,-n.top/i,1]},applyTo2d:function(n){var r=n.imageData,i=n.filterBackend.resources,a=r.data,u=a.length,s=r.width,d=r.height,g,p,_,C,w,S,O,I,X,Q,tt=this.image,Y;i.blendImage||(i.blendImage=e.util.createCanvasElement()),X=i.blendImage,Q=X.getContext("2d"),X.width!==s||X.height!==d?(X.width=s,X.height=d):Q.clearRect(0,0,s,d),Q.setTransform(tt.scaleX,0,0,tt.scaleY,tt.left,tt.top),Q.drawImage(tt._element,0,0,s,d),Y=Q.getImageData(0,0,s,d).data;for(var U=0;U<u;U+=4)switch(w=a[U],S=a[U+1],O=a[U+2],I=a[U+3],g=Y[U],p=Y[U+1],_=Y[U+2],C=Y[U+3],this.mode){case"multiply":a[U]=w*g/255,a[U+1]=S*p/255,a[U+2]=O*_/255,a[U+3]=I*C/255;break;case"mask":a[U+3]=C;break}},getUniformLocations:function(n,r){return{uTransformMatrix:n.getUniformLocation(r,"uTransformMatrix"),uImage:n.getUniformLocation(r,"uImage")}},sendUniformData:function(n,r){var i=this.calculateMatrix();n.uniform1i(r.uImage,1),n.uniformMatrix3fv(r.uTransformMatrix,!1,i)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(n,r){e.Image.fromObject(n.image,function(i){var a=e.util.object.clone(n);a.image=i,r(new e.Image.filters.BlendImage(a))})}}(l),function(h){var e=h.fabric||(h.fabric={}),c=Math.pow,o=Math.floor,n=Math.sqrt,r=Math.abs,i=Math.round,a=Math.sin,u=Math.ceil,s=e.Image.filters,d=e.util.createClass;s.Resize=d(s.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(g,p){return{uDelta:g.getUniformLocation(p,"uDelta"),uTaps:g.getUniformLocation(p,"uTaps")}},sendUniformData:function(g,p){g.uniform2fv(p.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),g.uniform1fv(p.uTaps,this.taps)},retrieveShader:function(g){var p=this.getFilterWindow(),_=this.type+"_"+p;if(!g.programCache.hasOwnProperty(_)){var C=this.generateShader(p);g.programCache[_]=this.createProgram(g.context,C)}return g.programCache[_]},getFilterWindow:function(){var g=this.tempScale;return Math.ceil(this.lanczosLobes/g)},getTaps:function(){for(var g=this.lanczosCreate(this.lanczosLobes),p=this.tempScale,_=this.getFilterWindow(),C=new Array(_),w=1;w<=_;w++)C[w-1]=g(w*p);return C},generateShader:function(C){for(var p=new Array(C),_=this.fragmentSourceTOP,C,w=1;w<=C;w++)p[w-1]=w+".0 * uDelta";return _+="uniform float uTaps["+C+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,p.forEach(function(S,O){_+="  color += texture2D(uTexture, vTexCoord + "+S+") * uTaps["+O+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+S+") * uTaps["+O+`];
`,_+="  sum += 2.0 * uTaps["+O+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(g){g.webgl?(g.passes++,this.width=g.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=g.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),g.destinationWidth=this.dW,this._setupFrameBuffer(g),this.applyToWebGL(g),this._swapTextures(g),g.sourceWidth=g.destinationWidth,this.height=g.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),g.destinationHeight=this.dH,this._setupFrameBuffer(g),this.applyToWebGL(g),this._swapTextures(g),g.sourceHeight=g.destinationHeight):this.applyTo2d(g)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(g){return function(p){if(p>=g||p<=-g)return 0;if(p<11920929e-14&&p>-11920929e-14)return 1;p*=Math.PI;var _=p/g;return a(p)/p*a(_)/_}},applyTo2d:function(g){var p=g.imageData,_=this.scaleX,C=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/C;var w=p.width,S=p.height,O=i(w*_),I=i(S*C),X;this.resizeType==="sliceHack"?X=this.sliceByTwo(g,w,S,O,I):this.resizeType==="hermite"?X=this.hermiteFastResize(g,w,S,O,I):this.resizeType==="bilinear"?X=this.bilinearFiltering(g,w,S,O,I):this.resizeType==="lanczos"&&(X=this.lanczosResize(g,w,S,O,I)),g.imageData=X},sliceByTwo:function(g,p,_,C,w){var S=g.imageData,O=.5,I=!1,X=!1,Q=p*O,tt=_*O,Y=e.filterBackend.resources,U,et,st=0,ft=0,ut=p,T=0;for(Y.sliceByTwo||(Y.sliceByTwo=document.createElement("canvas")),U=Y.sliceByTwo,(U.width<p*1.5||U.height<_)&&(U.width=p*1.5,U.height=_),et=U.getContext("2d"),et.clearRect(0,0,p*1.5,_),et.putImageData(S,0,0),C=o(C),w=o(w);!I||!X;)p=Q,_=tt,C<o(Q*O)?Q=o(Q*O):(Q=C,I=!0),w<o(tt*O)?tt=o(tt*O):(tt=w,X=!0),et.drawImage(U,st,ft,p,_,ut,T,Q,tt),st=ut,ft=T,T+=tt;return et.getImageData(st,ft,C,w)},lanczosResize:function(g,p,_,C,w){function S(P){var D,z,E,x,M,L,K,H,Z,B,nt;for(T.x=(P+.5)*tt,A.x=o(T.x),D=0;D<w;D++){for(T.y=(D+.5)*Y,A.y=o(T.y),M=0,L=0,K=0,H=0,Z=0,z=A.x-st;z<=A.x+st;z++)if(!(z<0||z>=p)){B=o(1e3*r(z-T.x)),ut[B]||(ut[B]={});for(var W=A.y-ft;W<=A.y+ft;W++)W<0||W>=_||(nt=o(1e3*r(W-T.y)),ut[B][nt]||(ut[B][nt]=Q(n(c(B*U,2)+c(nt*et,2))/1e3)),E=ut[B][nt],E>0&&(x=(W*p+z)*4,M+=E,L+=E*O[x],K+=E*O[x+1],H+=E*O[x+2],Z+=E*O[x+3]))}x=(D*C+P)*4,X[x]=L/M,X[x+1]=K/M,X[x+2]=H/M,X[x+3]=Z/M}return++P<C?S(P):I}var O=g.imageData.data,I=g.ctx.createImageData(C,w),X=I.data,Q=this.lanczosCreate(this.lanczosLobes),tt=this.rcpScaleX,Y=this.rcpScaleY,U=2/this.rcpScaleX,et=2/this.rcpScaleY,st=u(tt*this.lanczosLobes/2),ft=u(Y*this.lanczosLobes/2),ut={},T={},A={};return S(0)},bilinearFiltering:function(g,p,_,C,w){var S,O,I,X,Q,tt,Y,U,et,st,ft,ut,T=0,A,P=this.rcpScaleX,D=this.rcpScaleY,z=4*(p-1),E=g.imageData,x=E.data,M=g.ctx.createImageData(C,w),L=M.data;for(Y=0;Y<w;Y++)for(U=0;U<C;U++)for(Q=o(P*U),tt=o(D*Y),et=P*U-Q,st=D*Y-tt,A=4*(tt*p+Q),ft=0;ft<4;ft++)S=x[A+ft],O=x[A+4+ft],I=x[A+z+ft],X=x[A+z+4+ft],ut=S*(1-et)*(1-st)+O*et*(1-st)+I*st*(1-et)+X*et*st,L[T++]=ut;return M},hermiteFastResize:function(g,p,_,C,w){for(var S=this.rcpScaleX,O=this.rcpScaleY,I=u(S/2),X=u(O/2),Q=g.imageData,tt=Q.data,Y=g.ctx.createImageData(C,w),U=Y.data,et=0;et<w;et++)for(var st=0;st<C;st++){for(var ft=(st+et*C)*4,ut=0,T=0,A=0,P=0,D=0,z=0,E=0,x=(et+.5)*O,M=o(et*O);M<(et+1)*O;M++)for(var L=r(x-(M+.5))/X,K=(st+.5)*S,H=L*L,Z=o(st*S);Z<(st+1)*S;Z++){var B=r(K-(Z+.5))/I,nt=n(H+B*B);nt>1&&nt<-1||(ut=2*nt*nt*nt-3*nt*nt+1,ut>0&&(B=4*(Z+M*p),E+=ut*tt[B+3],A+=ut,tt[B+3]<255&&(ut=ut*tt[B+3]/250),P+=ut*tt[B],D+=ut*tt[B+1],z+=ut*tt[B+2],T+=ut))}U[ft]=P/T,U[ft+1]=D/T,U[ft+2]=z/T,U[ft+3]=E/A}return Y},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Contrast=o(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var r=n.imageData,i,u,a=r.data,u=a.length,s=Math.floor(this.contrast*255),d=259*(s+255)/(255*(259-s));for(i=0;i<u;i+=4)a[i]=d*(a[i]-128)+128,a[i+1]=d*(a[i+1]-128)+128,a[i+2]=d*(a[i+2]-128)+128}},getUniformLocations:function(n,r){return{uContrast:n.getUniformLocation(r,"uContrast")}},sendUniformData:function(n,r){n.uniform1f(r.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Saturation=o(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var r=n.imageData,i=r.data,a=i.length,u=-this.saturation,s,d;for(s=0;s<a;s+=4)d=Math.max(i[s],i[s+1],i[s+2]),i[s]+=d!==i[s]?(d-i[s])*u:0,i[s+1]+=d!==i[s+1]?(d-i[s+1])*u:0,i[s+2]+=d!==i[s+2]?(d-i[s+2])*u:0}},getUniformLocations:function(n,r){return{uSaturation:n.getUniformLocation(r,"uSaturation")}},sendUniformData:function(n,r){n.uniform1f(r.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Vibrance=o(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var r=n.imageData,i=r.data,a=i.length,u=-this.vibrance,s,d,g,p;for(s=0;s<a;s+=4)d=Math.max(i[s],i[s+1],i[s+2]),g=(i[s]+i[s+1]+i[s+2])/3,p=Math.abs(d-g)*2/255*u,i[s]+=d!==i[s]?(d-i[s])*p:0,i[s+1]+=d!==i[s+1]?(d-i[s+1])*p:0,i[s+2]+=d!==i[s+2]?(d-i[s+2])*p:0}},getUniformLocations:function(n,r){return{uVibrance:n.getUniformLocation(r,"uVibrance")}},sendUniformData:function(n,r){n.uniform1f(r.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Blur=o(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var r=n.filterBackend.resources,i,a,u=n.imageData.width,s=n.imageData.height;r.blurLayer1||(r.blurLayer1=e.util.createCanvasElement(),r.blurLayer2=e.util.createCanvasElement()),i=r.blurLayer1,a=r.blurLayer2,(i.width!==u||i.height!==s)&&(a.width=i.width=u,a.height=i.height=s);var d=i.getContext("2d"),g=a.getContext("2d"),p=15,_,C,w,S,O=this.blur*.06*.5;for(d.putImageData(n.imageData,0,0),g.clearRect(0,0,u,s),S=-p;S<=p;S++)_=(Math.random()-.5)/4,C=S/p,w=O*C*u+_,g.globalAlpha=1-Math.abs(C),g.drawImage(i,w,_),d.drawImage(a,0,0),g.globalAlpha=1,g.clearRect(0,0,a.width,a.height);for(S=-p;S<=p;S++)_=(Math.random()-.5)/4,C=S/p,w=O*C*s+_,g.globalAlpha=1-Math.abs(C),g.drawImage(i,_,w),d.drawImage(a,0,0),g.globalAlpha=1,g.clearRect(0,0,a.width,a.height);n.ctx.drawImage(i,0,0);var I=n.ctx.getImageData(0,0,i.width,i.height);return d.globalAlpha=1,d.clearRect(0,0,i.width,i.height),I},getUniformLocations:function(n,r){return{delta:n.getUniformLocation(r,"uDelta")}},sendUniformData:function(n,r){var i=this.chooseRightDelta();n.uniform2fv(r.delta,i)},chooseRightDelta:function(){var n=1,r=[0,0],i;return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),i=n*this.blur*.12,this.horizontal?r[0]=i:r[1]=i,r}}),c.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Gamma=o(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var r=n.imageData,i=r.data,a=this.gamma,u=i.length,s=1/a[0],d=1/a[1],g=1/a[2],p;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),p=0,u=256;p<u;p++)this.rVals[p]=Math.pow(p/255,s)*255,this.gVals[p]=Math.pow(p/255,d)*255,this.bVals[p]=Math.pow(p/255,g)*255;for(p=0,u=i.length;p<u;p+=4)i[p]=this.rVals[i[p]],i[p+1]=this.gVals[i[p+1]],i[p+2]=this.bVals[i[p+2]]},getUniformLocations:function(n,r){return{uGamma:n.getUniformLocation(r,"uGamma")}},sendUniformData:function(n,r){n.uniform3fv(r.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.Composed=o(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(r){r.applyTo(n)})},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),e.Image.filters.Composed.fromObject=function(n,r){var i=n.subFilters||[],a=i.map(function(s){return new e.Image.filters[s.type](s)}),u=new e.Image.filters.Composed({subFilters:a});return r&&r(u),u}}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.Image.filters,o=e.util.createClass;c.HueRotation=o(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,r=e.util.cos(n),i=e.util.sin(n),a=1/3,u=Math.sqrt(a)*i,s=1-r;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=r+s/3,this.matrix[1]=a*s-u,this.matrix[2]=a*s+u,this.matrix[5]=a*s+u,this.matrix[6]=r+a*s,this.matrix[7]=a*s-u,this.matrix[10]=a*s-u,this.matrix[11]=a*s+u,this.matrix[12]=r+a*s},isNeutralState:function(n){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,n)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}(l),function(h){var e=h.fabric||(h.fabric={}),c=e.util.object.clone;if(e.Text){e.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(o),cacheProperties:e.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,r){this.styles=r?r.styles||{}:{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",r),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=e.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,r,i,a,u,s,d,g=0,p=this._textLines.length;g<p;g++)if(!(this.textAlign!=="justify"&&(g===p-1||this.isEndOfWrapping(g)))&&(a=0,u=this._textLines[g],r=this.getLineWidth(g),r<this.width&&(d=this.textLines[g].match(this._reSpacesAndTabs)))){i=d.length,n=(this.width-r)/i;for(var _=0,C=u.length;_<=C;_++)s=this.__charBounds[g][_],this._reSpaceAndTab.test(u[_])?(s.width+=n,s.kernedWidth+=n,s.left+=a,a+=n):s.left+=a}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),r=this.fontSize;return n.width+=r*n.zoomX,n.height+=r*n.zoomY,n},_render:function(n){var r=this.path;r&&!r.isNotVisible()&&r._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,r,i){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom";break}n.font=this._getFontDeclaration(r,i)},calcTextWidth:function(){for(var n=this.getLineWidth(0),r=1,i=this._textLines.length;r<i;r++){var a=this.getLineWidth(r);a>n&&(n=a)}return n},_renderTextLine:function(n,r,i,a,u,s){this._renderChars(n,r,i,a,u,s)},_renderTextLinesBackground:function(n){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var r,i,a=n.fillStyle,u,s,d=this._getLeftOffset(),g=this._getTopOffset(),p=0,_=0,C,w,S=this.path,O,I=0,X=this._textLines.length;I<X;I++){if(r=this.getHeightOfLine(I),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",I)){g+=r;continue}u=this._textLines[I],i=this._getLineLeftOffset(I),_=0,p=0,s=this.getValueOfPropertyAt(I,0,"textBackgroundColor");for(var Q=0,tt=u.length;Q<tt;Q++)C=this.__charBounds[I][Q],w=this.getValueOfPropertyAt(I,Q,"textBackgroundColor"),S?(n.save(),n.translate(C.renderLeft,C.renderTop),n.rotate(C.angle),n.fillStyle=w,w&&n.fillRect(-C.width/2,-r/this.lineHeight*(1-this._fontSizeFraction),C.width,r/this.lineHeight),n.restore()):w!==s?(O=d+i+p,this.direction==="rtl"&&(O=this.width-O-_),n.fillStyle=s,s&&n.fillRect(O,g,_,r/this.lineHeight),p=C.left,_=C.width,s=w):_+=C.kernedWidth;w&&!S&&(O=d+i+p,this.direction==="rtl"&&(O=this.width-O-_),n.fillStyle=w,n.fillRect(O,g,_,r/this.lineHeight)),g+=r}n.fillStyle=a,this._removeShadow(n)}},getFontCache:function(n){var r=n.fontFamily.toLowerCase();e.charWidthsCache[r]||(e.charWidthsCache[r]={});var i=e.charWidthsCache[r],a=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return i[a]||(i[a]={}),i[a]},_measureChar:function(n,r,i,a){var u=this.getFontCache(r),s=this._getFontDeclaration(r),d=this._getFontDeclaration(a),g=i+n,p=s===d,_,C,w,S=r.fontSize/this.CACHE_FONT_SIZE,O;if(i&&u[i]!==void 0&&(w=u[i]),u[n]!==void 0&&(O=_=u[n]),p&&u[g]!==void 0&&(C=u[g],O=C-w),_===void 0||w===void 0||C===void 0){var I=this.getMeasuringContext();this._setTextStyles(I,r,!0)}return _===void 0&&(O=_=I.measureText(n).width,u[n]=_),w===void 0&&p&&i&&(w=I.measureText(i).width,u[i]=w),p&&C===void 0&&(C=I.measureText(g).width,u[g]=C,O=C-w),{width:_*S,kernedWidth:O*S}},getHeightOfChar:function(n,r){return this.getValueOfPropertyAt(n,r,"fontSize")},measureLine:function(n){var r=this._measureLine(n);return this.charSpacing!==0&&(r.width-=this._getWidthOfCharSpacing()),r.width<0&&(r.width=0),r},_measureLine:function(n){var r=0,i,a,u=this._textLines[n],s,d,g=0,p=new Array(u.length),_=0,C,w,S=this.path,O=this.pathSide==="right";for(this.__charBounds[n]=p,i=0;i<u.length;i++)a=u[i],d=this._getGraphemeBox(a,n,i,s),p[i]=d,r+=d.kernedWidth,s=a;if(p[i]={left:d?d.left+d.width:0,width:0,kernedWidth:0,height:this.fontSize},S){switch(w=S.segmentsInfo[S.segmentsInfo.length-1].length,C=e.util.getPointOnPath(S.path,0,S.segmentsInfo),C.x+=S.pathOffset.x,C.y+=S.pathOffset.y,this.textAlign){case"left":_=O?w-r:0;break;case"center":_=(w-r)/2;break;case"right":_=O?0:w-r;break}for(_+=this.pathStartOffset*(O?-1:1),i=O?u.length-1:0;O?i>=0:i<u.length;O?i--:i++)d=p[i],_>w?_%=w:_<0&&(_+=w),this._setGraphemeOnPath(_,d,C),_+=d.kernedWidth}return{width:r,numOfSpaces:g}},_setGraphemeOnPath:function(n,r,i){var a=n+r.kernedWidth/2,u=this.path,s=e.util.getPointOnPath(u.path,a,u.segmentsInfo);r.renderLeft=s.x-i.x,r.renderTop=s.y-i.y,r.angle=s.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,r,i,a,u){var s=this.getCompleteStyleDeclaration(r,i),d=a?this.getCompleteStyleDeclaration(r,i-1):{},g=this._measureChar(n,s,a,d),p=g.kernedWidth,_=g.width,C;this.charSpacing!==0&&(C=this._getWidthOfCharSpacing(),_+=C,p+=C);var w={width:_,left:0,height:s.fontSize,kernedWidth:p,deltaY:s.deltaY};if(i>0&&!u){var S=this.__charBounds[r][i-1];w.left=S.left+S.width+g.kernedWidth-g.width}return w},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var r=this._textLines[n],i=this.getHeightOfChar(n,0),a=1,u=r.length;a<u;a++)i=Math.max(this.getHeightOfChar(n,a),i);return this.__lineHeights[n]=i*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,r=0,i=0,a=this._textLines.length;i<a;i++)n=this.getHeightOfLine(i),r+=i===a-1?n/this.lineHeight:n;return r},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,r){n.save();for(var i=0,a=this._getLeftOffset(),u=this._getTopOffset(),s=0,d=this._textLines.length;s<d;s++){var g=this.getHeightOfLine(s),p=g/this.lineHeight,_=this._getLineLeftOffset(s);this._renderTextLine(r,n,this._textLines[s],a+_,u+i+p,s),i+=g}n.restore()},_renderTextFill:function(n){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,r,i,a,u,s){var d=this.getHeightOfLine(s),g=this.textAlign.indexOf("justify")!==-1,p,_,C="",w,S=0,O,I=this.path,X=!g&&this.charSpacing===0&&this.isEmptyStyles(s)&&!I,Q=this.direction==="ltr",tt=this.direction==="ltr"?1:-1,Y,U=r.canvas.getAttribute("dir");if(r.save(),U!==this.direction&&(r.canvas.setAttribute("dir",Q?"ltr":"rtl"),r.direction=Q?"ltr":"rtl",r.textAlign=Q?"left":"right"),u-=d*this._fontSizeFraction/this.lineHeight,X){this._renderChar(n,r,s,0,i.join(""),a,u,d),r.restore();return}for(var et=0,st=i.length-1;et<=st;et++)O=et===st||this.charSpacing||I,C+=i[et],w=this.__charBounds[s][et],S===0?(a+=tt*(w.kernedWidth-w.width),S+=w.width):S+=w.kernedWidth,g&&!O&&this._reSpaceAndTab.test(i[et])&&(O=!0),O||(p=p||this.getCompleteStyleDeclaration(s,et),_=this.getCompleteStyleDeclaration(s,et+1),O=e.util.hasStyleChanged(p,_,!1)),O&&(I?(r.save(),r.translate(w.renderLeft,w.renderTop),r.rotate(w.angle),this._renderChar(n,r,s,et,C,-S/2,0,d),r.restore()):(Y=a,this._renderChar(n,r,s,et,C,Y,u,d)),C="",p=_,a+=tt*S,S=0);r.restore()},_applyPatternGradientTransformText:function(n){var r=e.util.createCanvasElement(),i,a=this.width+this.strokeWidth,u=this.height+this.strokeWidth;return r.width=a,r.height=u,i=r.getContext("2d"),i.beginPath(),i.moveTo(0,0),i.lineTo(a,0),i.lineTo(a,u),i.lineTo(0,u),i.closePath(),i.translate(a/2,u/2),i.fillStyle=n.toLive(i),this._applyPatternGradientTransform(i,n),i.fill(),i.createPattern(r,"no-repeat")},handleFiller:function(n,r,i){var a,u;return i.toLive?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(a=-this.width/2,u=-this.height/2,n.translate(a,u),n[r]=this._applyPatternGradientTransformText(i),{offsetX:a,offsetY:u}):(n[r]=i.toLive(n,this),this._applyPatternGradientTransform(n,i)):(n[r]=i,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,r){return n.lineWidth=r.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",r.stroke)},_setFillStyles:function(n,r){return this.handleFiller(n,"fillStyle",r.fill)},_renderChar:function(n,r,i,a,u,s,d){var g=this._getStyleDeclaration(i,a),p=this.getCompleteStyleDeclaration(i,a),_=n==="fillText"&&p.fill,C=n==="strokeText"&&p.stroke&&p.strokeWidth,w,S;!C&&!_||(r.save(),_&&(w=this._setFillStyles(r,p)),C&&(S=this._setStrokeStyles(r,p)),r.font=this._getFontDeclaration(p),g&&g.textBackgroundColor&&this._removeShadow(r),g&&g.deltaY&&(d+=g.deltaY),_&&r.fillText(u,s-w.offsetX,d-w.offsetY),C&&r.strokeText(u,s-S.offsetX,d-S.offsetY),r.restore())},setSuperscript:function(n,r){return this._setScript(n,r,this.superscript)},setSubscript:function(n,r){return this._setScript(n,r,this.subscript)},_setScript:function(n,r,i){var a=this.get2DCursorLocation(n,!0),u=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"fontSize"),s=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"deltaY"),d={fontSize:u*i.size,deltaY:s+u*i.baseline};return this.setSelectionStyles(d,n,r),this},_getLineLeftOffset:function(n){var r=this.getLineWidth(n),i=this.width-r,a=this.textAlign,u=this.direction,d,s=0,d=this.isEndOfWrapping(n);return a==="justify"||a==="justify-center"&&!d||a==="justify-right"&&!d||a==="justify-left"&&!d?0:(a==="center"&&(s=i/2),a==="right"&&(s=i),a==="justify-center"&&(s=i/2),a==="justify-right"&&(s=i),u==="rtl"&&(s-=i),s)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var r=this.measureLine(n),i=r.width;return this.__lineWidths[n]=i,i},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,r,i){var a=this._getStyleDeclaration(n,r);return a&&typeof a[i]<"u"?a[i]:this[i]},_renderTextDecoration:function(n,r){if(!(!this[r]&&!this.styleHas(r))){for(var i,a,u,s,d,g,p,_,C=this._getLeftOffset(),w=this._getTopOffset(),S,O,I,X,Q,tt,Y,U,et=this.path,st=this._getWidthOfCharSpacing(),ft=this.offsets[r],ut=0,T=this._textLines.length;ut<T;ut++){if(i=this.getHeightOfLine(ut),!this[r]&&!this.styleHas(r,ut)){w+=i;continue}p=this._textLines[ut],tt=i/this.lineHeight,s=this._getLineLeftOffset(ut),O=0,I=0,_=this.getValueOfPropertyAt(ut,0,r),U=this.getValueOfPropertyAt(ut,0,"fill"),S=w+tt*(1-this._fontSizeFraction),a=this.getHeightOfChar(ut,0),d=this.getValueOfPropertyAt(ut,0,"deltaY");for(var A=0,P=p.length;A<P;A++)if(X=this.__charBounds[ut][A],Q=this.getValueOfPropertyAt(ut,A,r),Y=this.getValueOfPropertyAt(ut,A,"fill"),u=this.getHeightOfChar(ut,A),g=this.getValueOfPropertyAt(ut,A,"deltaY"),et&&Q&&Y)n.save(),n.fillStyle=U,n.translate(X.renderLeft,X.renderTop),n.rotate(X.angle),n.fillRect(-X.kernedWidth/2,ft*u+g,X.kernedWidth,this.fontSize/15),n.restore();else if((Q!==_||Y!==U||u!==a||g!==d)&&I>0){var D=C+s+O;this.direction==="rtl"&&(D=this.width-D-I),_&&U&&(n.fillStyle=U,n.fillRect(D,S+ft*a+d,I,this.fontSize/15)),O=X.left,I=X.width,_=Q,U=Y,a=u,d=g}else I+=X.kernedWidth;var D=C+s+O;this.direction==="rtl"&&(D=this.width-D-I),n.fillStyle=Y,Q&&Y&&n.fillRect(D,S+ft*a+d,I-st,this.fontSize/15),w+=i}this._removeShadow(n)}},_getFontDeclaration:function(n,r){var i=n||this,a=this.fontFamily,u=e.Text.genericFonts.indexOf(a.toLowerCase())>-1,s=a===void 0||a.indexOf("'")>-1||a.indexOf(",")>-1||a.indexOf('"')>-1||u?i.fontFamily:'"'+i.fontFamily+'"';return[e.isLikelyNode?i.fontWeight:i.fontStyle,e.isLikelyNode?i.fontStyle:i.fontWeight,r?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",s].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var r=n.split(this._reNewline),i=new Array(r.length),a=[`
`],u=[],s=0;s<r.length;s++)i[s]=e.util.string.graphemeSplit(r[s]),u=u.concat(i[s],a);return u.pop(),{_unwrappedLines:i,lines:r,graphemeText:u,graphemeLines:i}},toObject:function(n){var r=o.concat(n),i=this.callSuper("toObject",r);return i.styles=e.util.stylesToArray(this.styles,this.text),i.path&&(i.path=this.path.toObject()),i},set:function(n,r){this.callSuper("set",n,r);var i=!1,a=!1;if(typeof n=="object")for(var u in n)u==="path"&&this.setPathInfo(),i=i||this._dimensionAffectingProps.indexOf(u)!==-1,a=a||u==="path";else i=this._dimensionAffectingProps.indexOf(n)!==-1,a=n==="path";return a&&this.setPathInfo(),i&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(n,r,i){if(!n)return r(null);var a=e.parseAttributes(n,e.Text.ATTRIBUTE_NAMES),u=a.textAnchor||"left";if(i=e.util.object.extend(i?c(i):{},a),i.top=i.top||0,i.left=i.left||0,a.textDecoration){var s=a.textDecoration;s.indexOf("underline")!==-1&&(i.underline=!0),s.indexOf("overline")!==-1&&(i.overline=!0),s.indexOf("line-through")!==-1&&(i.linethrough=!0),delete i.textDecoration}"dx"in a&&(i.left+=a.dx),"dy"in a&&(i.top+=a.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var d="";"textContent"in n?d=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(d=n.firstChild.data),d=d.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var g=i.strokeWidth;i.strokeWidth=0;var p=new e.Text(d,i),_=p.getScaledHeight()/p.height,C=(p.height+p.strokeWidth)*p.lineHeight-p.height,w=C*_,S=p.getScaledHeight()+w,O=0;u==="center"&&(O=p.getScaledWidth()/2),u==="right"&&(O=p.getScaledWidth()),p.set({left:p.left-O,top:p.top-(S-p.fontSize*(.07+p._fontSizeFraction))/p.lineHeight,strokeWidth:typeof g<"u"?g:1}),r(p)},e.Text.fromObject=function(n,r){var i=c(n),a=n.path;return delete i.path,e.Object._fromObject("Text",i,function(u){u.styles=e.util.stylesFromArray(n.styles,n.text),a?e.Object._fromObject("Path",a,function(s){u.set("path",s),r(u)},"path"):r(u)},"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)}(l),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(h){if(!this.styles||typeof h<"u"&&!this.styles[h])return!0;var e=typeof h>"u"?this.styles:{line:this.styles[h]};for(var c in e)for(var o in e[c])for(var n in e[c][o])return!1;return!0},styleHas:function(h,e){if(!this.styles||!h||h===""||typeof e<"u"&&!this.styles[e])return!1;var c=typeof e>"u"?this.styles:{0:this.styles[e]};for(var o in c)for(var n in c[o])if(typeof c[o][n][h]<"u")return!0;return!1},cleanStyle:function(h){if(!this.styles||!h||h==="")return!1;var e=this.styles,c=0,o,n,r=!0,i=0,a;for(var u in e){o=0;for(var s in e[u]){var a=e[u][s],d=a.hasOwnProperty(h);c++,d?(n?a[h]!==n&&(r=!1):n=a[h],a[h]===this[h]&&delete a[h]):r=!1,Object.keys(a).length!==0?o++:delete e[u][s]}o===0&&delete e[u]}for(var g=0;g<this._textLines.length;g++)i+=this._textLines[g].length;r&&c===i&&(this[h]=n,this.removeStyle(h))},removeStyle:function(h){if(!(!this.styles||!h||h==="")){var e=this.styles,c,o,n;for(o in e){c=e[o];for(n in c)delete c[n][h],Object.keys(c[n]).length===0&&delete c[n];Object.keys(c).length===0&&delete e[o]}}},_extendStyles:function(h,e){var c=this.get2DCursorLocation(h);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),e)},get2DCursorLocation:function(h,e){typeof h>"u"&&(h=this.selectionStart);for(var c=e?this._unwrappedTextLines:this._textLines,o=c.length,n=0;n<o;n++){if(h<=c[n].length)return{lineIndex:n,charIndex:h};h-=c[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:c[n-1].length<h?c[n-1].length:h}},getSelectionStyles:function(h,e,c){typeof h>"u"&&(h=this.selectionStart||0),typeof e>"u"&&(e=this.selectionEnd||h);for(var o=[],n=h;n<e;n++)o.push(this.getStyleAtPosition(n,c));return o},getStyleAtPosition:function(h,e){var c=this.get2DCursorLocation(h),o=e?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return o||{}},setSelectionStyles:function(h,e,c){typeof e>"u"&&(e=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||e);for(var o=e;o<c;o++)this._extendStyles(o,h);return this._forceClearCache=!0,this},_getStyleDeclaration:function(h,e){var c=this.styles&&this.styles[h];return c?c[e]:null},getCompleteStyleDeclaration:function(h,e){for(var c=this._getStyleDeclaration(h,e)||{},o={},n,r=0;r<this._styleProperties.length;r++)n=this._styleProperties[r],o[n]=typeof c[n]>"u"?this[n]:c[n];return o},_setStyleDeclaration:function(h,e,c){this.styles[h][e]=c},_deleteStyleDeclaration:function(h,e){delete this.styles[h][e]},_getLineStyle:function(h){return!!this.styles[h]},_setLineStyle:function(h){this.styles[h]={}},_deleteLineStyle:function(h){delete this.styles[h]}})}(),function(){function h(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,c){this.callSuper("initialize",e,c),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,c){this[e]!==c&&(this._fireSelectionChanged(),this[e]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,o=this.canvas.viewportTransform;c.save(),c.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(c),this._clearTextArea(c),e||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var e=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,c):this.renderSelection(e,c),c.restore()}},_clearTextArea:function(e){var c=this.width+4,o=this.height+4;e.clearRect(-c/2,-o/2,c,o)},_getCursorBoundaries:function(e){typeof e>"u"&&(e=this.selectionStart);var c=this._getLeftOffset(),o=this._getTopOffset(),n=this._getCursorBoundariesOffsets(e);return{left:c,top:o,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,o,n,r=0,i=0,a,u=this.get2DCursorLocation(e);n=u.charIndex,o=u.lineIndex;for(var s=0;s<o;s++)r+=this.getHeightOfLine(s);c=this._getLineLeftOffset(o);var d=this.__charBounds[o][n];return d&&(i=d.left),this.charSpacing!==0&&n===this._textLines[o].length&&(i-=this._getWidthOfCharSpacing()),a={top:r,left:c+(i>0?i:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(e,c){var o=this.get2DCursorLocation(),n=o.lineIndex,r=o.charIndex>0?o.charIndex-1:0,i=this.getValueOfPropertyAt(n,r,"fontSize"),a=this.scaleX*this.canvas.getZoom(),u=this.cursorWidth/a,s=e.topOffset,d=this.getValueOfPropertyAt(n,r,"deltaY");s+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-i*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,r,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(e.left+e.leftOffset-u/2,s+e.top+d,u,i)},renderSelection:function(e,c){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,r=this.textAlign.indexOf("justify")!==-1,i=this.get2DCursorLocation(o),a=this.get2DCursorLocation(n),u=i.lineIndex,s=a.lineIndex,d=i.charIndex<0?0:i.charIndex,g=a.charIndex<0?0:a.charIndex,p=u;p<=s;p++){var _=this._getLineLeftOffset(p)||0,C=this.getHeightOfLine(p),w=0,S=0,O=0;if(p===u&&(S=this.__charBounds[u][d].left),p>=u&&p<s)O=r&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===s)if(g===0)O=this.__charBounds[s][g].left;else{var I=this._getWidthOfCharSpacing();O=this.__charBounds[s][g-1].left+this.__charBounds[s][g-1].width-I}w=C,(this.lineHeight<1||p===s&&this.lineHeight>1)&&(C/=this.lineHeight);var X=e.left+_+S,Q=O-S,tt=C,Y=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",tt=1,Y=C):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(X=this.width-X-Q),c.fillRect(X,e.top+e.topOffset+Y,Q,tt),e.topOffset+=w}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),c=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c}}}),t.IText.fromObject=function(e,c){var o=t.util.stylesFromArray(e.styles,e.text),n=Object.assign({},e,{styles:o});if(h(n),n.styles)for(var r in n.styles)for(var i in n.styles[r])h(n.styles[r][i]);t.Object._fromObject("IText",n,c,"text")}}(),function(){var h=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",function(){var c=e.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,e._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(e))})},initRemovedHandler:function(){var e=this;this.on("removed",function(){var c=e.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,e),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,e._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach(function(c){c.__isMousedown=!1})},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,c,o,n){var r;return r={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",c,{duration:o,onComplete:function(){r.isAborted||e[n]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return r.isAborted}}),r},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(e){var c=this,o=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},o)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var c=0,o=e-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)c++,o--;for(;/\S/.test(this._text[o])&&o>-1;)c++,o--;return e-c},findWordBoundaryRight:function(e){var c=0,o=e;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)c++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)c++,o++;return e+c},findLineBoundaryLeft:function(e){for(var c=0,o=e-1;!/\n/.test(this._text[o])&&o>-1;)c++,o--;return e-c},findLineBoundaryRight:function(e){for(var c=0,o=e;!/\n/.test(this._text[o])&&o<this._text.length;)c++,o++;return e+c},searchWordBoundary:function(e,c){for(var o=this._text,n=this._reSpace.test(o[e])?e-1:e,r=o[n],i=t.reNonWord;!i.test(r)&&n>0&&n<o.length;)n+=c,r=o[n];return i.test(r)&&(n+=c===1?0:1),n},selectWord:function(e){e=e||this.selectionStart;var c=this.searchWordBoundary(e,-1),o=this.searchWordBoundary(e,1);this.selectionStart=c,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var c=this.findLineBoundaryLeft(e),o=this.findLineBoundaryRight(e);return this.selectionStart=c,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(e.e),o=this.selectionStart,n=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||o===n)&&(o===c||n===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==n)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,c,o){var n=o.slice(0,e),r=t.util.string.graphemeSplit(n).length;if(e===c)return{selectionStart:r,selectionEnd:r};var i=o.slice(e,c),a=t.util.string.graphemeSplit(i).length;return{selectionStart:r,selectionEnd:r+a}},fromGraphemeToStringSelection:function(e,c,o){var n=o.slice(0,e),r=n.join("").length;if(e===c)return{selectionStart:r,selectionEnd:r};var i=o.slice(e,c),a=i.join("").length;return{selectionStart:r,selectionEnd:r+a}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(e),o=this.get2DCursorLocation(e),n=o.lineIndex,r=o.charIndex,i=this.getValueOfPropertyAt(n,r,"fontSize")*this.lineHeight,a=c.leftOffset,u=this.calcTransformMatrix(),s={x:c.left+a,y:c.top+c.topOffset+i},d=this.canvas.getRetinaScaling(),g=this.canvas.upperCanvasEl,p=g.width/d,_=g.height/d,C=p-i,w=_-i,S=g.clientWidth/p,O=g.clientHeight/_;return s=t.util.transformPoint(s,u),s=t.util.transformPoint(s,this.canvas.viewportTransform),s.x*=S,s.y*=O,s.x<0&&(s.x=0),s.x>C&&(s.x=C),s.y<0&&(s.y=0),s.y>w&&(s.y=w),s.x+=this.canvas._offset.left,s.y+=this.canvas._offset.top,{left:s.x+"px",top:s.y+"px",fontSize:i+"px",charHeight:i}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,c){var o=this.get2DCursorLocation(e,!0),n=this.get2DCursorLocation(c,!0),r=o.lineIndex,i=o.charIndex,a=n.lineIndex,u=n.charIndex,s,d;if(r!==a){if(this.styles[r])for(s=i;s<this._unwrappedTextLines[r].length;s++)delete this.styles[r][s];if(this.styles[a])for(s=u;s<this._unwrappedTextLines[a].length;s++)d=this.styles[a][s],d&&(this.styles[r]||(this.styles[r]={}),this.styles[r][i+s-u]=d);for(s=r+1;s<=a;s++)delete this.styles[s];this.shiftLineStyles(a,r-a)}else if(this.styles[r]){d=this.styles[r];var g=u-i,p,_;for(s=i;s<u;s++)delete d[s];for(_ in this.styles[r])p=parseInt(_,10),p>=u&&(d[p-g]=d[_],delete d[_])}},shiftLineStyles:function(e,c){var o=h(this.styles);for(var n in this.styles){var r=parseInt(n,10);r>e&&(this.styles[r+c]=o[r],o[r-c]||delete this.styles[r])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(e,c,o,n){var r,i={},a=!1,u=this._unwrappedTextLines[e].length===c;o||(o=1),this.shiftLineStyles(e,o),this.styles[e]&&(r=this.styles[e][c===0?c:c-1]);for(var s in this.styles[e]){var d=parseInt(s,10);d>=c&&(a=!0,i[d-c]=this.styles[e][s],u&&c===0||delete this.styles[e][s])}var g=!1;for(a&&!u&&(this.styles[e+o]=i,g=!0),g&&o--;o>0;)n&&n[o-1]?this.styles[e+o]={0:h(n[o-1])}:r?this.styles[e+o]={0:h(r)}:delete this.styles[e+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(e,c,o,n){this.styles||(this.styles={});var r=this.styles[e],i=r?h(r):{};o||(o=1);for(var a in i){var u=parseInt(a,10);u>=c&&(r[u+o]=i[u],i[u-o]||delete r[u])}if(this._forceClearCache=!0,n){for(;o--;)Object.keys(n[o]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][c+o]=h(n[o]));return}if(r)for(var s=r[c?c-1:1];s&&o--;)this.styles[e][c+o]=h(s)},insertNewStyleBlock:function(e,c,o){for(var n=this.get2DCursorLocation(c,!0),r=[0],i=0,a=0;a<e.length;a++)e[a]===`
`?(i++,r[i]=0):r[i]++;r[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,r[0],o),o=o&&o.slice(r[0]+1)),i&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+r[0],i);for(var a=1;a<i;a++)r[a]>0?this.insertCharStyleObject(n.lineIndex+a,0,r[a],o):o&&this.styles[n.lineIndex+a]&&o[0]&&(this.styles[n.lineIndex+a][0]=o[0]),o=o&&o.slice(r[a]+1);r[a]>0&&this.insertCharStyleObject(n.lineIndex+a,0,r[a],o)},setSelectionStartEndWithShift:function(e,c,o){o<=e?(c===e?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=o):o>e&&o<c?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(c===e?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=o)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(h){if(this.canvas){this.__newClickTime=+new Date;var e=h.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",h),this._stopEvent(h.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(h){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===h.x&&this.__lastPointer.y===h.y},_stopEvent:function(h){h.preventDefault&&h.preventDefault(),h.stopPropagation&&h.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(h){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(h.e))},tripleClickHandler:function(h){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(h.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(h.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(h){if(this.__isMousedown=!1,!(!this.editable||this.group||h.transform&&h.transform.actionPerformed||h.e.button&&h.e.button!==1)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(h.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(h){var e=this.getSelectionStartFromPointer(h),c=this.selectionStart,o=this.selectionEnd;h.shiftKey?this.setSelectionStartEndWithShift(c,o,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(h){for(var e=this.getLocalPointer(h),c=0,o=0,n=0,r=0,i=0,a,u,s=0,d=this._textLines.length;s<d&&n<=e.y;s++)n+=this.getHeightOfLine(s)*this.scaleY,i=s,s>0&&(r+=this._textLines[s-1].length+this.missingNewlineOffset(s-1));a=this._getLineLeftOffset(i),o=a*this.scaleX,u=this._textLines[i],this.direction==="rtl"&&(e.x=this.width*this.scaleX-e.x+o);for(var g=0,p=u.length;g<p&&(c=o,o+=this.__charBounds[i][g].kernedWidth*this.scaleX,o<=e.x);g++)r++;return this._getNewSelectionStartFromOffset(e,c,o,r,p)},_getNewSelectionStartFromOffset:function(h,e,c,o,n){var r=h.x-e,i=c-h.x,a=i>r||i<0?0:1,u=o+a;return this.flipX&&(u=n-u),u>this._text.length&&(u=this._text.length),u}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var h=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+h.top+"; left: "+h.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+h.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(h){if(this.isEditing){var e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(h.keyCode in e)this[e[h.keyCode]](h);else if(h.keyCode in this.ctrlKeysMapDown&&(h.ctrlKey||h.metaKey))this[this.ctrlKeysMapDown[h.keyCode]](h);else return;h.stopImmediatePropagation(),h.preventDefault(),h.keyCode>=33&&h.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(h){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(h.keyCode in this.ctrlKeysMapUp&&(h.ctrlKey||h.metaKey))this[this.ctrlKeysMapUp[h.keyCode]](h);else return;h.stopImmediatePropagation(),h.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(h){var e=this.fromPaste;if(this.fromPaste=!1,h&&h.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,n=c.length,r,i,a=n-o,u=this.selectionStart,s=this.selectionEnd,d=u!==s,g,p,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var C=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),w=u>C.selectionStart;d?(r=this._text.slice(u,s),a+=s-u):n<o&&(w?r=this._text.slice(s+a,s):r=this._text.slice(u,u-a)),i=c.slice(C.selectionEnd-a,C.selectionEnd),r&&r.length&&(i.length&&(g=this.getSelectionStyles(u,u+1,!1),g=i.map(function(){return g[0]})),d?(p=u,_=s):w?(p=s-r.length,_=s):(p=s,_=s+r.length),this.removeStyleFromTo(p,_)),i.length&&(e&&i.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(g=t.copiedTextStyle),this.insertNewStyleBlock(i,u,g)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(h){this.compositionStart=h.target.selectionStart,this.compositionEnd=h.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(h){return h&&h.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(h,e){var c=this._getLineLeftOffset(h),o;return e>0&&(o=this.__charBounds[h][e-1],c+=o.left+o.width),c},getDownCursorOffset:function(h,e){var c=this._getSelectionForOffset(h,e),o=this.get2DCursorLocation(c),n=o.lineIndex;if(n===this._textLines.length-1||h.metaKey||h.keyCode===34)return this._text.length-c;var r=o.charIndex,i=this._getWidthBeforeCursor(n,r),a=this._getIndexOnLine(n+1,i),u=this._textLines[n].slice(r);return u.length+a+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(h,e){return h.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(h,e){var c=this._getSelectionForOffset(h,e),o=this.get2DCursorLocation(c),n=o.lineIndex;if(n===0||h.metaKey||h.keyCode===33)return-c;var r=o.charIndex,i=this._getWidthBeforeCursor(n,r),a=this._getIndexOnLine(n-1,i),u=this._textLines[n].slice(0,r),s=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+a-u.length+(1-s)},_getIndexOnLine:function(h,e){for(var c=this._textLines[h],o=this._getLineLeftOffset(h),n=o,r=0,i,a,u=0,s=c.length;u<s;u++)if(i=this.__charBounds[h][u].width,n+=i,n>e){a=!0;var d=n-i,g=n,p=Math.abs(d-e),_=Math.abs(g-e);r=_<p?u:u-1;break}return a||(r=c.length-1),r},moveCursorDown:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",h)},moveCursorUp:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",h)},_moveCursorUpOrDown:function(h,e){var c="get"+h+"CursorOffset",o=this[c](e,this._selectionDirection==="right");e.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(h){var e=this._selectionDirection==="left"?this.selectionStart+h:this.selectionEnd+h;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),h!==0},moveCursorWithoutShift:function(h){return h<0?(this.selectionStart+=h,this.selectionEnd=this.selectionStart):(this.selectionEnd+=h,this.selectionStart=this.selectionEnd),h!==0},moveCursorLeft:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",h)},_move:function(h,e,c){var o;if(h.altKey)o=this["findWordBoundary"+c](this[e]);else if(h.metaKey||h.keyCode===35||h.keyCode===36)o=this["findLineBoundary"+c](this[e]);else return this[e]+=c==="Left"?-1:1,!0;if(typeof o<"u"&&this[e]!==o)return this[e]=o,!0},_moveLeft:function(h,e){return this._move(h,e,"Left")},_moveRight:function(h,e){return this._move(h,e,"Right")},moveCursorLeftWithoutShift:function(h){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(h,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(h){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(h,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(h,"selectionStart")},moveCursorRight:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",h)},_moveCursorLeftOrRight:function(h,e){var c="moveCursor"+h+"With";this._currentCursorOpacity=1,e.shiftKey?c+="Shift":c+="outShift",this[c](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(h){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(h,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(h,"selectionEnd")},moveCursorRightWithoutShift:function(h){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(h,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(h,e){typeof e>"u"&&(e=h+1),this.removeStyleFromTo(h,e),this._text.splice(h,e-h),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(h,e,c,o){typeof o>"u"&&(o=c),o>c&&this.removeStyleFromTo(c,o);var n=t.util.string.graphemeSplit(h);this.insertNewStyleBlock(n,c,e),this._text=[].concat(this._text.slice(0,c),n,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var h=t.util.toFixed,e=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var c=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(c.textTop,c.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(),{reviver:c,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(c){var o=!0,n=this.getSvgTextDecoration(this);return[c.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",c.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(c,o){var n=[],r=[],i=c,a;this._setSVGBg(r);for(var u=0,s=this._textLines.length;u<s;u++)a=this._getLineLeftOffset(u),(this.textBackgroundColor||this.styleHas("textBackgroundColor",u))&&this._setSVGTextLineBg(r,u,o+a,i),this._setSVGTextLineText(n,u,o+a,i),i+=this.getHeightOfLine(u);return{textSpans:n,textBgRects:r}},_createTextCharSpan:function(c,o,n,r){var i=c!==c.trim()||c.match(e),a=this.getSvgSpanStyles(o,i),u=a?'style="'+a+'"':"",s=o.deltaY,d="",g=t.Object.NUM_FRACTION_DIGITS;return s&&(d=' dy="'+h(s,g)+'" '),['<tspan x="',h(n,g),'" y="',h(r,g),'" ',d,u,">",t.util.string.escapeXml(c),"</tspan>"].join("")},_setSVGTextLineText:function(c,o,n,r){var i=this.getHeightOfLine(o),a=this.textAlign.indexOf("justify")!==-1,u,s,d="",g,p,_=0,C=this._textLines[o],w;r+=i*(1-this._fontSizeFraction)/this.lineHeight;for(var S=0,O=C.length-1;S<=O;S++)w=S===O||this.charSpacing,d+=C[S],g=this.__charBounds[o][S],_===0?(n+=g.kernedWidth-g.width,_+=g.width):_+=g.kernedWidth,a&&!w&&this._reSpaceAndTab.test(C[S])&&(w=!0),w||(u=u||this.getCompleteStyleDeclaration(o,S),s=this.getCompleteStyleDeclaration(o,S+1),w=t.util.hasStyleChanged(u,s,!0)),w&&(p=this._getStyleDeclaration(o,S)||{},c.push(this._createTextCharSpan(d,p,n,r)),d="",u=s,n+=_,_=0)},_pushTextBgRect:function(c,o,n,r,i,a){var u=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(o),' x="',h(n,u),'" y="',h(r,u),'" width="',h(i,u),'" height="',h(a,u),`"></rect>
`)},_setSVGTextLineBg:function(c,o,n,r){for(var i=this._textLines[o],a=this.getHeightOfLine(o)/this.lineHeight,u=0,s=0,d,g,p=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),_=0,C=i.length;_<C;_++)d=this.__charBounds[o][_],g=this.getValueOfPropertyAt(o,_,"textBackgroundColor"),g!==p?(p&&this._pushTextBgRect(c,p,n+s,r,u,a),s=d.left,u=d.width,p=g):u+=d.kernedWidth;g&&this._pushTextBgRect(c,g,n+s,r,u,a)},_getFillAttributes:function(c){var o=c&&typeof c=="string"?new t.Color(c):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+c+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(c){for(var o=0,n=0,r=0;r<c;r++)o+=this.getHeightOfLine(r);return n=this.getHeightOfLine(r),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(c){var o=t.Object.prototype.getSvgStyles.call(this,c);return o+" white-space: pre;"}})}(),function(h){var e=h.fabric||(h.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var o=0,n=0,r=0,i={},a=0;a<c.graphemeLines.length;a++)c.graphemeText[r]===`
`&&a>0?(n=0,r++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[r])&&a>0&&(n++,r++),i[a]={line:o,offset:n},r+=c.graphemeLines[a].length,n+=c.graphemeLines[a].length;return i},styleHas:function(c,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[o];n&&(o=n.line)}return e.Text.prototype.styleHas.call(this,c,o)},isEmptyStyles:function(c){if(!this.styles)return!0;var o=0,n=c+1,r,i,a=!1,u=this._styleMap[c],s=this._styleMap[c+1];u&&(c=u.line,o=u.offset),s&&(n=s.line,a=n===c,r=s.offset),i=typeof c>"u"?this.styles:{line:this.styles[c]};for(var d in i)for(var g in i[d])if(g>=o&&(!a||g<r))for(var p in i[d][g])return!1;return!0},_getStyleDeclaration:function(c,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[c];if(!n)return null;c=n.line,o=n.offset+o}return this.callSuper("_getStyleDeclaration",c,o)},_setStyleDeclaration:function(c,o,n){var r=this._styleMap[c];c=r.line,o=r.offset+o,this.styles[c][o]=n},_deleteStyleDeclaration:function(c,o){var n=this._styleMap[c];c=n.line,o=n.offset+o,delete this.styles[c][o]},_getLineStyle:function(c){var o=this._styleMap[c];return!!this.styles[o.line]},_setLineStyle:function(c){var o=this._styleMap[c];this.styles[o.line]={}},_wrapText:function(c,o){var n=[],r;for(this.isWrapping=!0,r=0;r<c.length;r++)n=n.concat(this._wrapLine(c[r],r,o));return this.isWrapping=!1,n},_measureWord:function(c,o,n){var r=0,i,a=!0;n=n||0;for(var u=0,s=c.length;u<s;u++){var d=this._getGraphemeBox(c[u],o,u+n,i,a);r+=d.kernedWidth,i=c[u]}return r},_wrapLine:function(c,o,n,X){var i=0,a=this.splitByGrapheme,u=[],s=[],d=a?e.util.string.graphemeSplit(c):c.split(this._wordJoiners),g="",p=0,_=a?"":" ",C=0,w=0,S=0,O=!0,I=this._getWidthOfCharSpacing(),X=X||0;d.length===0&&d.push([]),n-=X;for(var Q=0;Q<d.length;Q++)g=a?d[Q]:e.util.string.graphemeSplit(d[Q]),C=this._measureWord(g,o,p),p+=g.length,i+=w+C-I,i>n&&!O?(u.push(s),s=[],i=C,O=!0):i+=I,!O&&!a&&s.push(_),s=s.concat(g),w=a?0:this._measureWord([_],o,p),p++,O=!1,C>S&&(S=C);return Q&&u.push(s),S+X>this.dynamicMinWidth&&(this.dynamicMinWidth=S-I+X),u},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c){return this.splitByGrapheme?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var o=e.Text.prototype._splitTextIntoLines.call(this,c),n=this._wrapText(o.lines,this.width),r=new Array(n.length),i=0;i<n.length;i++)r[i]=n[i].join("");return o.lines=r,o.graphemeLines=n,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var o in this._styleMap)this._textLines[o]&&(c[this._styleMap[o].line]=1);for(var o in this.styles)c[o]||delete this.styles[o]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),e.Textbox.fromObject=function(c,o){var n=e.util.stylesFromArray(c.styles,c.text),r=Object.assign({},c,{styles:n});return e.Object._fromObject("Textbox",r,o,"text")}}(l),function(){var h=t.controlsUtils,e=h.scaleSkewCursorStyleHandler,c=h.scaleCursorStyleHandler,o=h.scalingEqually,n=h.scalingYOrSkewingX,r=h.scalingXOrSkewingY,i=h.scaleOrSkewActionName,a=t.Object.prototype.controls;if(a.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:r,getActionName:i}),a.mr=new t.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:r,getActionName:i}),a.mb=new t.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:n,getActionName:i}),a.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:n,getActionName:i}),a.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:o}),a.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:o}),a.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:o}),a.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:o}),a.mtr=new t.Control({x:0,y:-.5,actionHandler:h.rotationWithSnapping,cursorStyleHandler:h.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var u=t.Textbox.prototype.controls={};u.mtr=a.mtr,u.tr=a.tr,u.br=a.br,u.tl=a.tl,u.bl=a.bl,u.mt=a.mt,u.mb=a.mb,u.mr=new t.Control({x:.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),u.ml=new t.Control({x:-.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}}()})(oe);const fe={Decorate:1,Background:2,Photo:3,Save:4,Drawing:5};var Qs={grad:.9,turn:360,rad:360/(2*Math.PI)},$t=function(l){return typeof l=="string"?l.length>0:typeof l=="number"},Rt=function(l,t,f){return t===void 0&&(t=0),f===void 0&&(f=Math.pow(10,t)),Math.round(f*l)/f+0},Gt=function(l,t,f){return t===void 0&&(t=0),f===void 0&&(f=1),l>f?f:l>t?l:t},dr=function(l){return(l=isFinite(l)?l%360:0)>0?l:l+360},tn=function(l){return{r:Gt(l.r,0,255),g:Gt(l.g,0,255),b:Gt(l.b,0,255),a:Gt(l.a)}},si=function(l){return{r:Rt(l.r),g:Rt(l.g),b:Rt(l.b),a:Rt(l.a,3)}},Zs=/^#([0-9a-f]{3,8})$/i,Xe=function(l){var t=l.toString(16);return t.length<2?"0"+t:t},gr=function(l){var t=l.r,f=l.g,m=l.b,v=l.a,b=Math.max(t,f,m),y=b-Math.min(t,f,m),h=y?b===t?(f-m)/y:b===f?2+(m-t)/y:4+(t-f)/y:0;return{h:60*(h<0?h+6:h),s:b?y/b*100:0,v:b/255*100,a:v}},mr=function(l){var t=l.h,f=l.s,m=l.v,v=l.a;t=t/360*6,f/=100,m/=100;var b=Math.floor(t),y=m*(1-f),h=m*(1-(t-b)*f),e=m*(1-(1-t+b)*f),c=b%6;return{r:255*[m,h,y,y,e,m][c],g:255*[e,m,m,h,y,y][c],b:255*[y,y,e,m,m,h][c],a:v}},en=function(l){return{h:dr(l.h),s:Gt(l.s,0,100),l:Gt(l.l,0,100),a:Gt(l.a)}},nn=function(l){return{h:Rt(l.h),s:Rt(l.s),l:Rt(l.l),a:Rt(l.a,3)}},rn=function(l){return mr((f=(t=l).s,{h:t.h,s:(f*=((m=t.l)<50?m:100-m)/100)>0?2*f/(m+f)*100:0,v:m+f,a:t.a}));var t,f,m},Me=function(l){return{h:(t=gr(l)).h,s:(v=(200-(f=t.s))*(m=t.v)/100)>0&&v<200?f*m/100/(v<=100?v:200-v)*100:0,l:v/2,a:t.a};var t,f,m,v},$s=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ta=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ea=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ia=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Si={string:[[function(l){var t=Zs.exec(l);return t?(l=t[1]).length<=4?{r:parseInt(l[0]+l[0],16),g:parseInt(l[1]+l[1],16),b:parseInt(l[2]+l[2],16),a:l.length===4?Rt(parseInt(l[3]+l[3],16)/255,2):1}:l.length===6||l.length===8?{r:parseInt(l.substr(0,2),16),g:parseInt(l.substr(2,2),16),b:parseInt(l.substr(4,2),16),a:l.length===8?Rt(parseInt(l.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(l){var t=ea.exec(l)||ia.exec(l);return t?t[2]!==t[4]||t[4]!==t[6]?null:tn({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(l){var t=$s.exec(l)||ta.exec(l);if(!t)return null;var f,m,v=en({h:(f=t[1],m=t[2],m===void 0&&(m="deg"),Number(f)*(Qs[m]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return rn(v)},"hsl"]],object:[[function(l){var t=l.r,f=l.g,m=l.b,v=l.a,b=v===void 0?1:v;return $t(t)&&$t(f)&&$t(m)?tn({r:Number(t),g:Number(f),b:Number(m),a:Number(b)}):null},"rgb"],[function(l){var t=l.h,f=l.s,m=l.l,v=l.a,b=v===void 0?1:v;if(!$t(t)||!$t(f)||!$t(m))return null;var y=en({h:Number(t),s:Number(f),l:Number(m),a:Number(b)});return rn(y)},"hsl"],[function(l){var t=l.h,f=l.s,m=l.v,v=l.a,b=v===void 0?1:v;if(!$t(t)||!$t(f)||!$t(m))return null;var y=function(h){return{h:dr(h.h),s:Gt(h.s,0,100),v:Gt(h.v,0,100),a:Gt(h.a)}}({h:Number(t),s:Number(f),v:Number(m),a:Number(b)});return mr(y)},"hsv"]]},sn=function(l,t){for(var f=0;f<t.length;f++){var m=t[f][0](l);if(m)return[m,t[f][1]]}return[null,void 0]},na=function(l){return typeof l=="string"?sn(l.trim(),Si.string):typeof l=="object"&&l!==null?sn(l,Si.object):[null,void 0]},ai=function(l,t){var f=Me(l);return{h:f.h,s:Gt(f.s+100*t,0,100),l:f.l,a:f.a}},oi=function(l){return(299*l.r+587*l.g+114*l.b)/1e3/255},an=function(l,t){var f=Me(l);return{h:f.h,s:f.s,l:Gt(f.l+100*t,0,100),a:f.a}},Ti=function(){function l(t){this.parsed=na(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return l.prototype.isValid=function(){return this.parsed!==null},l.prototype.brightness=function(){return Rt(oi(this.rgba),2)},l.prototype.isDark=function(){return oi(this.rgba)<.5},l.prototype.isLight=function(){return oi(this.rgba)>=.5},l.prototype.toHex=function(){return t=si(this.rgba),f=t.r,m=t.g,v=t.b,y=(b=t.a)<1?Xe(Rt(255*b)):"","#"+Xe(f)+Xe(m)+Xe(v)+y;var t,f,m,v,b,y},l.prototype.toRgb=function(){return si(this.rgba)},l.prototype.toRgbString=function(){return t=si(this.rgba),f=t.r,m=t.g,v=t.b,(b=t.a)<1?"rgba("+f+", "+m+", "+v+", "+b+")":"rgb("+f+", "+m+", "+v+")";var t,f,m,v,b},l.prototype.toHsl=function(){return nn(Me(this.rgba))},l.prototype.toHslString=function(){return t=nn(Me(this.rgba)),f=t.h,m=t.s,v=t.l,(b=t.a)<1?"hsla("+f+", "+m+"%, "+v+"%, "+b+")":"hsl("+f+", "+m+"%, "+v+"%)";var t,f,m,v,b},l.prototype.toHsv=function(){return t=gr(this.rgba),{h:Rt(t.h),s:Rt(t.s),v:Rt(t.v),a:Rt(t.a,3)};var t},l.prototype.invert=function(){return Nt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},l.prototype.saturate=function(t){return t===void 0&&(t=.1),Nt(ai(this.rgba,t))},l.prototype.desaturate=function(t){return t===void 0&&(t=.1),Nt(ai(this.rgba,-t))},l.prototype.grayscale=function(){return Nt(ai(this.rgba,-1))},l.prototype.lighten=function(t){return t===void 0&&(t=.1),Nt(an(this.rgba,t))},l.prototype.darken=function(t){return t===void 0&&(t=.1),Nt(an(this.rgba,-t))},l.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},l.prototype.alpha=function(t){return typeof t=="number"?Nt({r:(f=this.rgba).r,g:f.g,b:f.b,a:t}):Rt(this.rgba.a,3);var f},l.prototype.hue=function(t){var f=Me(this.rgba);return typeof t=="number"?Nt({h:t,s:f.s,l:f.l,a:f.a}):Rt(f.h)},l.prototype.isEqual=function(t){return this.toHex()===Nt(t).toHex()},l}(),Nt=function(l){return l instanceof Ti?l:new Ti(l)},on=[],ra=function(l){l.forEach(function(t){on.indexOf(t)<0&&(t(Ti,Si),on.push(t))})},li=function(l){var t=l/255;return t<.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},ci=function(l){return .2126*li(l.r)+.7152*li(l.g)+.0722*li(l.b)};function sa(l){l.prototype.luminance=function(){return t=ci(this.rgba),(f=2)===void 0&&(f=0),m===void 0&&(m=Math.pow(10,f)),Math.round(m*t)/m+0;var t,f,m},l.prototype.contrast=function(t){t===void 0&&(t="#FFF");var f,m,v,b,y,h,e,c=t instanceof l?t:new l(t);return b=this.rgba,y=c.toRgb(),h=ci(b),e=ci(y),f=h>e?(h+.05)/(e+.05):(e+.05)/(h+.05),(m=2)===void 0&&(m=0),v===void 0&&(v=Math.pow(10,m)),Math.floor(v*f)/v+0},l.prototype.isReadable=function(t,f){return t===void 0&&(t="#FFF"),f===void 0&&(f={}),this.contrast(t)>=(h=(y=(m=f).size)===void 0?"normal":y,(b=(v=m.level)===void 0?"AA":v)==="AAA"&&h==="normal"?7:b==="AA"&&h==="large"?3:4.5);var m,v,b,y,h}}const we=[];function aa(l,t){return{subscribe:ce(l,t).subscribe}}function ce(l,t=vt){let f;const m=new Set;function v(h){if(xt(l,h)&&(l=h,f)){const e=!we.length;for(const c of m)c[1](),we.push(c,l);if(e){for(let c=0;c<we.length;c+=2)we[c][0](we[c+1]);we.length=0}}}function b(h){v(h(l))}function y(h,e=vt){const c=[h,e];return m.add(c),m.size===1&&(f=t(v)||vt),h(l),()=>{m.delete(c),m.size===0&&f&&(f(),f=null)}}return{set:v,update:b,subscribe:y}}function oa(l,t,f){const m=!Array.isArray(l),v=m?[l]:l,b=t.length<2;return aa(f,y=>{let h=!1;const e=[];let c=0,o=vt;const n=()=>{if(c)return;o();const i=t(m?e[0]:e,y);b?y(i):o=Ze(i)?i:vt},r=v.map((i,a)=>Wi(i,u=>{e[a]=u,c&=~(1<<a),h&&n()},()=>{c|=1<<a}));return h=!0,n(),function(){Pt(r),o(),h=!1}})}const te=ce({ArrowLeft:0,ArrowUp:0,ArrowRight:0,ArrowDown:0}),Hi=oa(te,l=>({...l,ArrowV:l.ArrowUp+l.ArrowDown,ArrowH:l.ArrowLeft+l.ArrowRight,ArrowVH:l.ArrowUp+l.ArrowDown+l.ArrowLeft+l.ArrowRight}));function Xi(l,t=.001,f=.01){const b=Math.min(1,Math.max(1,l-50)/50);return t+(f-t)/2*(1-Math.cos(Math.PI*b))}const{window:De}=zi;function la(l){let t,f,m,v,b,y;var h=l[2].pickerIndicator;function e(c){return{props:{pos:c[9],isDark:c[5],hex:Nt({h:c[3],s:c[0],v:c[1],a:1}).toHex()}}}return h&&(f=St(h,e(l))),{c(){var c,o;t=V("div"),f&&bt(f.$$.fragment),k(t,"class","picker svelte-uiwgvv"),k(t,"tabindex","0"),Dt(t,"--color-bg",l[8]),k(t,"aria-label","saturation and brightness picker (arrow keyboard navigation)"),k(t,"aria-valuemin",0),k(t,"aria-valuemax",100),k(t,"aria-valuetext",m="saturation "+((c=l[9].x)==null?void 0:c.toFixed())+"%, brightness "+((o=l[9].y)==null?void 0:o.toFixed())+"%")},m(c,o){ht(c,t,o),f&&_t(f,t,null),l[18](t),v=!0,b||(y=[rt(t,"mousedown",me(Qt(l[10]))),rt(t,"touchstart",l[16]),rt(t,"touchmove",me(Qt(l[16]))),rt(t,"touchend",l[16])],b=!0)},p(c,o){var r,i;const n={};if(o&512&&(n.pos=c[9]),o&32&&(n.isDark=c[5]),o&11&&(n.hex=Nt({h:c[3],s:c[0],v:c[1],a:1}).toHex()),o&4&&h!==(h=c[2].pickerIndicator)){if(f){Ft();const a=f;gt(a.$$.fragment,1,0,()=>{yt(a,1)}),Bt()}h?(f=St(h,e(c)),bt(f.$$.fragment),dt(f.$$.fragment,1),_t(f,t,null)):f=null}else h&&f.$set(n);(!v||o&256)&&Dt(t,"--color-bg",c[8]),(!v||o&512&&m!==(m="saturation "+((r=c[9].x)==null?void 0:r.toFixed())+"%, brightness "+((i=c[9].y)==null?void 0:i.toFixed())+"%"))&&k(t,"aria-valuetext",m)},i(c){v||(f&&dt(f.$$.fragment,c),v=!0)},o(c){f&&gt(f.$$.fragment,c),v=!1},d(c){c&&lt(t),f&&yt(f),l[18](null),b=!1,Pt(y)}}}function ca(l){let t,f,m,v,b;var y=l[2].pickerWrapper;function h(e){return{props:{focused:e[7],toRight:e[4],$$slots:{default:[la]},$$scope:{ctx:e}}}}return y&&(t=St(y,h(l))),{c(){t&&bt(t.$$.fragment),f=Zt()},m(e,c){t&&_t(t,e,c),ht(e,f,c),m=!0,v||(b=[rt(De,"mouseup",l[11]),rt(De,"mousedown",l[13]),rt(De,"mousemove",l[12]),rt(De,"keyup",l[14]),rt(De,"keydown",l[15])],v=!0)},p(e,[c]){const o={};if(c&128&&(o.focused=e[7]),c&16&&(o.toRight=e[4]),c&67109743&&(o.$$scope={dirty:c,ctx:e}),c&4&&y!==(y=e[2].pickerWrapper)){if(t){Ft();const n=t;gt(n.$$.fragment,1,0,()=>{yt(n,1)}),Bt()}y?(t=St(y,h(e)),bt(t.$$.fragment),dt(t.$$.fragment,1),_t(t,f.parentNode,f)):t=null}else y&&t.$set(o)},i(e){m||(t&&dt(t.$$.fragment,e),m=!0)},o(e){t&&gt(t.$$.fragment,e),m=!1},d(e){e&&lt(f),t&&yt(t,e),v=!1,Pt(b)}}}function ln(l,t,f){return Math.min(Math.max(t,l),f)}function ha(l,t,f){let m,v;kt(l,te,Y=>f(22,m=Y)),kt(l,Hi,Y=>f(23,v=Y));let{components:b}=t,{h:y}=t,{s:h}=t,{v:e}=t,{isOpen:c}=t,{toRight:o}=t,{isDark:n}=t,r,i=!1,a=!1,u,s,d,g={x:100,y:0};function p(Y){let U={x:Y.offsetX,y:Y.offsetY},et=r.getBoundingClientRect().width,st=r.getBoundingClientRect().height;f(0,h=ln(U.x/et,0,1)*100),f(1,e=ln((st-U.y)/st,0,1)*100)}function _(Y){Y.button===0&&(i=!0,p(Y))}function C(){i=!1}function w(Y){i&&p({offsetX:Math.max(0,Math.min(r.getBoundingClientRect().width,Y.clientX-r.getBoundingClientRect().left)),offsetY:Math.max(0,Math.min(r.getBoundingClientRect().height,Y.clientY-r.getBoundingClientRect().top))})}function S(Y){Y.target.isSameNode(r)||f(7,a=!1)}function O(Y){var U;Y.key==="Tab"&&f(7,a=!!((U=document.activeElement)!=null&&U.isSameNode(r))),!Y.repeat&&a&&X()}function I(Y){a&&v.ArrowVH&&(Y.preventDefault(),Y.repeat||X())}function X(){v.ArrowVH?u||(s=0,u=window.setInterval(()=>{let Y=Xi(++s);f(0,h=Math.min(100,Math.max(0,h+(m.ArrowRight-m.ArrowLeft)*Y*100))),f(1,e=Math.min(100,Math.max(0,e+(m.ArrowUp-m.ArrowDown)*Y*100)))},10)):u&&(clearInterval(u),u=void 0)}function Q(Y){Y.preventDefault(),p({offsetX:Y.changedTouches[0].clientX-r.getBoundingClientRect().left,offsetY:Y.changedTouches[0].clientY-r.getBoundingClientRect().top})}function tt(Y){Ct[Y?"unshift":"push"](()=>{r=Y,f(6,r)})}return l.$$set=Y=>{"components"in Y&&f(2,b=Y.components),"h"in Y&&f(3,y=Y.h),"s"in Y&&f(0,h=Y.s),"v"in Y&&f(1,e=Y.v),"isOpen"in Y&&f(17,c=Y.isOpen),"toRight"in Y&&f(4,o=Y.toRight),"isDark"in Y&&f(5,n=Y.isDark)},l.$$.update=()=>{l.$$.dirty&8&&typeof y=="number"&&f(8,d=Nt({h:y,s:100,v:100,a:1}).toHex()),l.$$.dirty&67&&typeof h=="number"&&typeof e=="number"&&r&&f(9,g={x:h,y:100-e})},[h,e,b,y,o,n,r,a,d,g,_,C,w,S,O,I,Q,c,tt]}class ua extends At{constructor(t){super(),Et(this,t,ha,ca,xt,{components:2,h:3,s:0,v:1,isOpen:17,toRight:4,isDark:5})}}const{window:Ye}=zi;function fa(l){let t,f,m,v,b,y;var h=l[1].sliderIndicator;function e(c){return{props:{pos:c[4],toRight:c[2]}}}return h&&(f=St(h,e(l))),{c(){t=V("div"),f&&bt(f.$$.fragment),k(t,"class","slider svelte-14nweqy"),k(t,"tabindex","0"),k(t,"aria-label","hue picker (arrow keyboard navigation)"),k(t,"aria-valuemin",0),k(t,"aria-valuemax",360),k(t,"aria-valuenow",m=Math.round(l[0])),Lt(t,"to-right",l[2])},m(c,o){ht(c,t,o),f&&_t(f,t,null),l[12](t),v=!0,b||(y=[rt(t,"mousedown",me(Qt(l[6]))),rt(t,"touchstart",l[11]),rt(t,"touchmove",me(Qt(l[11]))),rt(t,"touchend",l[11])],b=!0)},p(c,o){const n={};if(o&16&&(n.pos=c[4]),o&4&&(n.toRight=c[2]),o&2&&h!==(h=c[1].sliderIndicator)){if(f){Ft();const r=f;gt(r.$$.fragment,1,0,()=>{yt(r,1)}),Bt()}h?(f=St(h,e(c)),bt(f.$$.fragment),dt(f.$$.fragment,1),_t(f,t,null)):f=null}else h&&f.$set(n);(!v||o&1&&m!==(m=Math.round(c[0])))&&k(t,"aria-valuenow",m),(!v||o&4)&&Lt(t,"to-right",c[2])},i(c){v||(f&&dt(f.$$.fragment,c),v=!0)},o(c){f&&gt(f.$$.fragment,c),v=!1},d(c){c&&lt(t),f&&yt(f),l[12](null),b=!1,Pt(y)}}}function da(l){let t,f,m,v,b;var y=l[1].sliderWrapper;function h(e){return{props:{focused:e[5],toRight:e[2],$$slots:{default:[fa]},$$scope:{ctx:e}}}}return y&&(t=St(y,h(l))),{c(){t&&bt(t.$$.fragment),f=Zt()},m(e,c){t&&_t(t,e,c),ht(e,f,c),m=!0,v||(b=[rt(Ye,"mouseup",l[7]),rt(Ye,"mousemove",l[8]),rt(Ye,"keyup",l[9]),rt(Ye,"keydown",l[10])],v=!0)},p(e,[c]){const o={};if(c&32&&(o.focused=e[5]),c&4&&(o.toRight=e[2]),c&1048607&&(o.$$scope={dirty:c,ctx:e}),c&2&&y!==(y=e[1].sliderWrapper)){if(t){Ft();const n=t;gt(n.$$.fragment,1,0,()=>{yt(n,1)}),Bt()}y?(t=St(y,h(e)),bt(t.$$.fragment),dt(t.$$.fragment,1),_t(t,f.parentNode,f)):t=null}else y&&t.$set(o)},i(e){m||(t&&dt(t.$$.fragment,e),m=!0)},o(e){t&&gt(t.$$.fragment,e),m=!1},d(e){e&&lt(f),t&&yt(t,e),v=!1,Pt(b)}}}function ga(l,t,f){let m,v;kt(l,te,S=>f(16,m=S)),kt(l,Hi,S=>f(17,v=S));let{components:b}=t,{toRight:y}=t,h,e=!1,{h:c}=t,o=0,n=!1,r,i;function a(S){const O=y?h.getBoundingClientRect().width:h.getBoundingClientRect().height,I=Math.max(0,Math.min(O,S));f(0,c=I/O*360)}function u(S){S.button===0&&(e=!0,a(y?S.offsetX:S.offsetY))}function s(){e=!1}function d(S){e&&a(y?S.clientX-h.getBoundingClientRect().left:S.clientY-h.getBoundingClientRect().top)}function g(S){var O;S.key==="Tab"&&f(5,n=!!((O=document.activeElement)!=null&&O.isSameNode(h))),!S.repeat&&n&&_()}function p(S){n&&v.ArrowVH&&(S.preventDefault(),S.repeat||_())}function _(){v.ArrowVH?r||(i=0,r=window.setInterval(()=>{const S=Xi(++i),O=y?m.ArrowRight-m.ArrowLeft:m.ArrowDown-m.ArrowUp;f(0,c=Math.min(360,Math.max(0,c+O*360*S)))},10)):r&&(clearInterval(r),r=void 0)}function C(S){S.preventDefault(),a(y?S.changedTouches[0].clientX-h.getBoundingClientRect().left:S.changedTouches[0].clientY-h.getBoundingClientRect().top)}function w(S){Ct[S?"unshift":"push"](()=>{h=S,f(3,h)})}return l.$$set=S=>{"components"in S&&f(1,b=S.components),"toRight"in S&&f(2,y=S.toRight),"h"in S&&f(0,c=S.h)},l.$$.update=()=>{l.$$.dirty&9&&typeof c=="number"&&h&&f(4,o=100*c/360)},[c,b,y,h,o,n,u,s,d,g,p,C,w]}class ma extends At{constructor(t){super(),Et(this,t,ga,da,xt,{components:1,toRight:2,h:0})}}const{window:Ue}=zi;function pa(l){let t,f,m,v,b,y,h;var e=l[0].alphaIndicator;function c(o){return{props:{pos:o[5],toRight:o[2]}}}return e&&(f=St(e,c(l))),{c(){var o,n;t=V("div"),f&&bt(f.$$.fragment),k(t,"class","alpha svelte-f2vq53"),k(t,"tabindex","0"),Dt(t,"--alpha-color",(o=l[1])==null?void 0:o.substring(0,7)),k(t,"aria-label","transparency picker (arrow keyboard navigation)"),k(t,"aria-valuemin",0),k(t,"aria-valuemax",100),k(t,"aria-valuenow",m=Math.round(l[5])),k(t,"aria-valuetext",v=((n=l[5])==null?void 0:n.toFixed())+"%"),Lt(t,"to-right",l[2])},m(o,n){ht(o,t,n),f&&_t(f,t,null),l[14](t),b=!0,y||(h=[rt(t,"mousedown",me(Qt(l[6]))),rt(t,"touchstart",l[11]),rt(t,"touchmove",me(Qt(l[11]))),rt(t,"touchend",l[11])],y=!0)},p(o,n){var i,a;const r={};if(n&32&&(r.pos=o[5]),n&4&&(r.toRight=o[2]),n&1&&e!==(e=o[0].alphaIndicator)){if(f){Ft();const u=f;gt(u.$$.fragment,1,0,()=>{yt(u,1)}),Bt()}e?(f=St(e,c(o)),bt(f.$$.fragment),dt(f.$$.fragment,1),_t(f,t,null)):f=null}else e&&f.$set(r);(!b||n&2)&&Dt(t,"--alpha-color",(i=o[1])==null?void 0:i.substring(0,7)),(!b||n&32&&m!==(m=Math.round(o[5])))&&k(t,"aria-valuenow",m),(!b||n&32&&v!==(v=((a=o[5])==null?void 0:a.toFixed())+"%"))&&k(t,"aria-valuetext",v),(!b||n&4)&&Lt(t,"to-right",o[2])},i(o){b||(f&&dt(f.$$.fragment,o),b=!0)},o(o){f&&gt(f.$$.fragment,o),b=!1},d(o){o&&lt(t),f&&yt(f),l[14](null),y=!1,Pt(h)}}}function va(l){let t,f,m,v,b;var y=l[0].alphaWrapper;function h(e){return{props:{focused:e[4],toRight:e[2],$$slots:{default:[pa]},$$scope:{ctx:e}}}}return y&&(t=St(y,h(l))),{c(){t&&bt(t.$$.fragment),f=Zt()},m(e,c){t&&_t(t,e,c),ht(e,f,c),m=!0,v||(b=[rt(Ue,"mouseup",l[7]),rt(Ue,"mousemove",l[8]),rt(Ue,"keyup",l[9]),rt(Ue,"keydown",l[10])],v=!0)},p(e,[c]){const o={};if(c&16&&(o.focused=e[4]),c&4&&(o.toRight=e[2]),c&4194351&&(o.$$scope={dirty:c,ctx:e}),c&1&&y!==(y=e[0].alphaWrapper)){if(t){Ft();const n=t;gt(n.$$.fragment,1,0,()=>{yt(n,1)}),Bt()}y?(t=St(y,h(e)),bt(t.$$.fragment),dt(t.$$.fragment,1),_t(t,f.parentNode,f)):t=null}else y&&t.$set(o)},i(e){m||(t&&dt(t.$$.fragment,e),m=!0)},o(e){t&&gt(t.$$.fragment,e),m=!1},d(e){e&&lt(f),t&&yt(t,e),v=!1,Pt(b)}}}function _a(l,t,f){let m,v;kt(l,te,I=>f(18,m=I)),kt(l,Hi,I=>f(19,v=I));let{components:b}=t,{isOpen:y}=t,{a:h=1}=t,{hex:e}=t,{toRight:c}=t,o,n=!1,r=!1,i,a,u;function s(I){const X=c?o.getBoundingClientRect().width:o.getBoundingClientRect().height,Q=Math.max(0,Math.min(X,I));f(12,h=Q/X)}function d(I){I.button===0&&(n=!0,s(c?I.offsetX:I.offsetY))}function g(){n=!1}function p(I){n&&s(c?I.clientX-o.getBoundingClientRect().left:I.clientY-o.getBoundingClientRect().top)}function _(I){var X;I.key==="Tab"&&f(4,r=!!((X=document.activeElement)!=null&&X.isSameNode(o))),!I.repeat&&r&&w()}function C(I){r&&v.ArrowVH&&(I.preventDefault(),I.repeat||w())}function w(){v.ArrowVH?i||(a=0,i=window.setInterval(()=>{const I=Xi(++a),X=c?m.ArrowRight-m.ArrowLeft:m.ArrowDown-m.ArrowUp;f(12,h=Math.min(1,Math.max(0,h+X*I)))},10)):i&&(clearInterval(i),i=void 0)}function S(I){I.preventDefault(),s(c?I.changedTouches[0].clientX-o.getBoundingClientRect().left:I.changedTouches[0].clientY-o.getBoundingClientRect().top)}function O(I){Ct[I?"unshift":"push"](()=>{o=I,f(3,o)})}return l.$$set=I=>{"components"in I&&f(0,b=I.components),"isOpen"in I&&f(13,y=I.isOpen),"a"in I&&f(12,h=I.a),"hex"in I&&f(1,e=I.hex),"toRight"in I&&f(2,c=I.toRight)},l.$$.update=()=>{l.$$.dirty&4104&&typeof h=="number"&&o&&f(5,u=100*h)},[b,e,c,o,r,u,d,g,p,_,C,S,h,y,O]}class ya extends At{constructor(t){super(),Et(this,t,_a,va,xt,{components:0,isOpen:13,a:12,hex:1,toRight:2})}}function ba(l){let t,f,m,v,b,y,h,e,c,o=l[2]&&cn(l);return{c(){t=V("div"),f=V("input"),m=ot(),v=V("input"),b=ot(),y=V("input"),h=ot(),o&&o.c(),k(f,"aria-label","hue chanel color"),f.value=l[8],k(f,"type","number"),k(f,"min","0"),k(f,"max","360"),k(f,"class","svelte-11z4jba"),k(v,"aria-label","saturation chanel color"),v.value=l[7],k(v,"type","number"),k(v,"min","0"),k(v,"max","100"),k(v,"class","svelte-11z4jba"),k(y,"aria-label","brightness chanel color"),y.value=l[6],k(y,"type","number"),k(y,"min","0"),k(y,"max","100"),k(y,"class","svelte-11z4jba"),k(t,"class","input-container svelte-11z4jba")},m(n,r){ht(n,t,r),j(t,f),j(t,m),j(t,v),j(t,b),j(t,y),j(t,h),o&&o.m(t,null),e||(c=[rt(f,"input",l[12]("h")),rt(v,"input",l[12]("s")),rt(y,"input",l[12]("v"))],e=!0)},p(n,r){r&256&&f.value!==n[8]&&(f.value=n[8]),r&128&&v.value!==n[7]&&(v.value=n[7]),r&64&&y.value!==n[6]&&(y.value=n[6]),n[2]?o?o.p(n,r):(o=cn(n),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(n){n&&lt(t),o&&o.d(),e=!1,Pt(c)}}}function Ca(l){let t,f,m,v,b,y,h,e,c,o,n,r,i=l[2]&&hn(l);return{c(){t=V("div"),f=V("input"),v=ot(),b=V("input"),h=ot(),e=V("input"),o=ot(),i&&i.c(),k(f,"aria-label","red chanel color"),f.value=m=l[0].r,k(f,"type","number"),k(f,"min","0"),k(f,"max","255"),k(f,"class","svelte-11z4jba"),k(b,"aria-label","green chanel color"),b.value=y=l[0].g,k(b,"type","number"),k(b,"min","0"),k(b,"max","255"),k(b,"class","svelte-11z4jba"),k(e,"aria-label","blue chanel color"),e.value=c=l[0].b,k(e,"type","number"),k(e,"min","0"),k(e,"max","255"),k(e,"class","svelte-11z4jba"),k(t,"class","input-container svelte-11z4jba")},m(a,u){ht(a,t,u),j(t,f),j(t,v),j(t,b),j(t,h),j(t,e),j(t,o),i&&i.m(t,null),n||(r=[rt(f,"input",l[11]("r")),rt(b,"input",l[11]("g")),rt(e,"input",l[11]("b"))],n=!0)},p(a,u){u&1&&m!==(m=a[0].r)&&f.value!==m&&(f.value=m),u&1&&y!==(y=a[0].g)&&b.value!==y&&(b.value=y),u&1&&c!==(c=a[0].b)&&e.value!==c&&(e.value=c),a[2]?i?i.p(a,u):(i=hn(a),i.c(),i.m(t,null)):i&&(i.d(1),i=null)},d(a){a&&lt(t),i&&i.d(),n=!1,Pt(r)}}}function wa(l){let t,f,m,v,b,y=l[2]&&un(l);return{c(){t=V("div"),f=V("input"),m=ot(),y&&y.c(),f.value=l[1],Dt(f,"flex","3"),k(f,"class","svelte-11z4jba"),k(t,"class","input-container svelte-11z4jba")},m(h,e){ht(h,t,e),j(t,f),j(t,m),y&&y.m(t,null),v||(b=rt(f,"input",l[10]),v=!0)},p(h,e){e&2&&f.value!==h[1]&&(f.value=h[1]),h[2]?y?y.p(h,e):(y=un(h),y.c(),y.m(t,null)):y&&(y.d(1),y=null)},d(h){h&&lt(t),y&&y.d(),v=!1,b()}}}function cn(l){let t,f,m;return{c(){t=V("input"),k(t,"aria-label","transparency chanel color"),t.value=l[5],k(t,"type","number"),k(t,"min","0"),k(t,"max","1"),k(t,"step","0.01"),k(t,"class","svelte-11z4jba")},m(v,b){ht(v,t,b),f||(m=rt(t,"input",l[12]("a")),f=!0)},p(v,b){b&32&&t.value!==v[5]&&(t.value=v[5])},d(v){v&&lt(t),f=!1,m()}}}function hn(l){let t,f,m;return{c(){t=V("input"),k(t,"aria-label","transparency chanel color"),t.value=l[5],k(t,"type","number"),k(t,"min","0"),k(t,"max","1"),k(t,"step","0.01"),k(t,"class","svelte-11z4jba")},m(v,b){ht(v,t,b),f||(m=rt(t,"input",l[11]("a")),f=!0)},p(v,b){b&32&&t.value!==v[5]&&(t.value=v[5])},d(v){v&&lt(t),f=!1,m()}}}function un(l){let t,f,m;return{c(){t=V("input"),k(t,"aria-label","hexadecimal color"),t.value=l[5],k(t,"type","number"),k(t,"min","0"),k(t,"max","1"),k(t,"step","0.01"),k(t,"class","svelte-11z4jba")},m(v,b){ht(v,t,b),f||(m=rt(t,"input",l[11]("a")),f=!0)},p(v,b){b&32&&t.value!==v[5]&&(t.value=v[5])},d(v){v&&lt(t),f=!1,m()}}}function fn(l){let t,f=l[9][l[4]]+"",m,v,b,y;return{c(){t=V("button"),m=zt(f),k(t,"aria-label",v="change inputs to "+l[9][(l[4]+1)%3]),k(t,"class","svelte-11z4jba")},m(h,e){ht(h,t,e),j(t,m),b||(y=rt(t,"click",l[14]),b=!0)},p(h,e){e&16&&f!==(f=h[9][h[4]]+"")&&Oe(m,f),e&16&&v!==(v="change inputs to "+h[9][(h[4]+1)%3])&&k(t,"aria-label",v)},d(h){h&&lt(t),b=!1,y()}}}function Sa(l){let t,f;function m(h,e){return h[4]===0?wa:h[4]===1?Ca:ba}let v=m(l),b=v(l),y=l[3]&&fn(l);return{c(){t=V("div"),b.c(),f=ot(),y&&y.c(),k(t,"class","text-input svelte-11z4jba")},m(h,e){ht(h,t,e),b.m(t,null),j(t,f),y&&y.m(t,null)},p(h,[e]){v===(v=m(h))&&b?b.p(h,e):(b.d(1),b=v(h),b&&(b.c(),b.m(t,f))),h[3]?y?y.p(h,e):(y=fn(h),y.c(),y.m(t,null)):y&&(y.d(1),y=null)},i:vt,o:vt,d(h){h&&lt(t),b.d(),y&&y.d()}}}const Ta=/^#?([A-F0-9]{6}|[A-F0-9]{8})$/i;function xa(l,t,f){let m,v,b,y,{isAlpha:h}=t,{rgb:e}=t,{hsv:c}=t,{hex:o}=t,{canChangeMode:n}=t;const r=["HEX","RGB","HSV"];let i=0;function a(g){const p=g.target;Ta.test(p.value)&&f(1,o=p.value)}function u(g){return function(p){f(0,e={...e,[g]:parseFloat(p.target.value)})}}function s(g){return function(p){f(13,c={...c,[g]:parseFloat(p.target.value)})}}const d=()=>f(4,i=(i+1)%3);return l.$$set=g=>{"isAlpha"in g&&f(2,h=g.isAlpha),"rgb"in g&&f(0,e=g.rgb),"hsv"in g&&f(13,c=g.hsv),"hex"in g&&f(1,o=g.hex),"canChangeMode"in g&&f(3,n=g.canChangeMode)},l.$$.update=()=>{l.$$.dirty&8192&&f(8,m=Math.round(c.h)),l.$$.dirty&8192&&f(7,v=Math.round(c.s)),l.$$.dirty&8192&&f(6,b=Math.round(c.v)),l.$$.dirty&8192&&f(5,y=c.a===void 0?1:Math.round(c.a*100)/100)},[e,o,h,n,i,y,b,v,m,r,a,u,s,c,d]}class Oa extends At{constructor(t){super(),Et(this,t,xa,Sa,xt,{isAlpha:2,rgb:0,hsv:13,hex:1,canChangeMode:3})}}function ka(l){let t,f;return{c(){t=V("div"),k(t,"class","slider-indicator svelte-htgglv"),k(t,"style",f=`top: calc(${l[0]/200*186}% + 2px);`)},m(m,v){ht(m,t,v)},p(m,[v]){v&1&&f!==(f=`top: calc(${m[0]/200*186}% + 2px);`)&&k(t,"style",f)},i:vt,o:vt,d(m){m&&lt(t)}}}function Ea(l,t,f){let{pos:m}=t,{toRight:v}=t;return l.$$set=b=>{"pos"in b&&f(0,m=b.pos),"toRight"in b&&f(1,v=b.toRight)},[m,v]}class dn extends At{constructor(t){super(),Et(this,t,Ea,ka,xt,{pos:0,toRight:1})}}function Aa(l){let t,f;return{c(){t=V("div"),k(t,"class","picker-indicator svelte-1nw247x"),k(t,"style",f=`left: calc(${l[0].x/200*186}% + 2px); top: calc(${l[0].y/200*186}% + 2px); box-shadow: 0 0 4px ${l[1]?"white":"black"};`)},m(m,v){ht(m,t,v)},p(m,[v]){v&3&&f!==(f=`left: calc(${m[0].x/200*186}% + 2px); top: calc(${m[0].y/200*186}% + 2px); box-shadow: 0 0 4px ${m[1]?"white":"black"};`)&&k(t,"style",f)},i:vt,o:vt,d(m){m&&lt(t)}}}function Da(l,t,f){let{pos:m}=t,{hex:v}=t,{isDark:b}=t;return l.$$set=y=>{"pos"in y&&f(0,m=y.pos),"hex"in y&&f(2,v=y.hex),"isDark"in y&&f(1,b=y.isDark)},[m,b,v]}class Pa extends At{constructor(t){super(),Et(this,t,Da,Aa,xt,{pos:0,hex:2,isDark:1})}}function Ia(l){let t,f;return{c:vt,m(m,v){t||(f=[rt(window,"keyup",l[0]),rt(window,"keydown",l[1])],t=!0)},p:vt,i:vt,o:vt,d(m){t=!1,Pt(f)}}}function Ma(l,t,f){let m;kt(l,te,y=>f(2,m=y));function v(y){["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(y.key)&&(Ht(te,m[y.key]=0,m),te.set(m))}function b(y){["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(y.key)&&(y.repeat||(Ht(te,m[y.key]=1,m),te.set(m)))}return[v,b]}class Fa extends At{constructor(t){super(),Et(this,t,Ma,Ia,xt,{})}}function Ba(l){let t,f;const m=l[3].default,v=Re(m,l,l[2],null);return{c(){t=V("div"),v&&v.c(),k(t,"class","picker-wrapper svelte-1isc651"),Lt(t,"focused",l[0])},m(b,y){ht(b,t,y),v&&v.m(t,null),f=!0},p(b,[y]){v&&v.p&&(!f||y&4)&&je(v,m,b,b[2],f?Le(m,b[2],y,null):We(b[2]),null),(!f||y&1)&&Lt(t,"focused",b[0])},i(b){f||(dt(v,b),f=!0)},o(b){gt(v,b),f=!1},d(b){b&&lt(t),v&&v.d(b)}}}function Ra(l,t,f){let{$$slots:m={},$$scope:v}=t,{focused:b}=t,{toRight:y}=t;return l.$$set=h=>{"focused"in h&&f(0,b=h.focused),"toRight"in h&&f(1,y=h.toRight),"$$scope"in h&&f(2,v=h.$$scope)},[b,y,v,m]}class La extends At{constructor(t){super(),Et(this,t,Ra,Ba,xt,{focused:0,toRight:1})}}function ja(l){let t,f;const m=l[3].default,v=Re(m,l,l[2],null);return{c(){t=V("div"),v&&v.c(),k(t,"class","slider-wrapper svelte-1udewng"),Lt(t,"focused",l[0])},m(b,y){ht(b,t,y),v&&v.m(t,null),f=!0},p(b,[y]){v&&v.p&&(!f||y&4)&&je(v,m,b,b[2],f?Le(m,b[2],y,null):We(b[2]),null),(!f||y&1)&&Lt(t,"focused",b[0])},i(b){f||(dt(v,b),f=!0)},o(b){gt(v,b),f=!1},d(b){b&&lt(t),v&&v.d(b)}}}function Wa(l,t,f){let{$$slots:m={},$$scope:v}=t,{focused:b}=t,{toRight:y}=t;return l.$$set=h=>{"focused"in h&&f(0,b=h.focused),"toRight"in h&&f(1,y=h.toRight),"$$scope"in h&&f(2,v=h.$$scope)},[b,y,v,m]}class gn extends At{constructor(t){super(),Et(this,t,Wa,ja,xt,{focused:0,toRight:1})}}function Na(l){let t,f,m,v,b,y,h,e,c,o,n;return{c(){t=V("label"),f=V("div"),m=V("input"),v=ot(),b=V("div"),y=ot(),h=V("div"),e=ot(),c=zt(l[2]),k(m,"type","color"),m.value=l[1],k(m,"aria-haspopup","dialog"),k(m,"class","svelte-2ybi8r"),k(b,"class","alpha svelte-2ybi8r"),k(h,"class","color svelte-2ybi8r"),Dt(h,"background",l[1]),k(f,"class","container svelte-2ybi8r"),k(t,"class","svelte-2ybi8r")},m(r,i){ht(r,t,i),j(t,f),j(f,m),j(f,v),j(f,b),j(f,y),j(f,h),j(t,e),j(t,c),l[4](t),o||(n=[rt(m,"click",Qt(za)),rt(m,"mousedown",Qt(Ha)),rt(t,"click",Qt(Xa)),rt(t,"mousedown",Qt(Ya))],o=!0)},p(r,[i]){i&2&&(m.value=r[1]),i&2&&Dt(h,"background",r[1]),i&4&&Oe(c,r[2])},i:vt,o:vt,d(r){r&&lt(t),l[4](null),o=!1,Pt(n)}}}const za=()=>{},Ha=()=>{},Xa=()=>{},Ya=()=>{};function Ua(l,t,f){let{labelWrapper:m}=t,{hex:v}=t,{label:b}=t,{isOpen:y}=t;function h(e){Ct[e?"unshift":"push"](()=>{m=e,f(0,m)})}return l.$$set=e=>{"labelWrapper"in e&&f(0,m=e.labelWrapper),"hex"in e&&f(1,v=e.hex),"label"in e&&f(2,b=e.label),"isOpen"in e&&f(3,y=e.isOpen)},[m,v,b,y,h]}class Va extends At{constructor(t){super(),Et(this,t,Ua,Na,xt,{labelWrapper:0,hex:1,label:2,isOpen:3})}}function Ga(l){let t,f,m;const v=l[5].default,b=Re(v,l,l[4],null);return{c(){t=V("div"),b&&b.c(),k(t,"class","wrapper svelte-160vdtq"),k(t,"role",f=l[2]?"dialog":void 0),k(t,"aria-label","color picker"),Lt(t,"isOpen",l[1]),Lt(t,"isPopup",l[2])},m(y,h){ht(y,t,h),b&&b.m(t,null),l[6](t),m=!0},p(y,[h]){b&&b.p&&(!m||h&16)&&je(b,v,y,y[4],m?Le(v,y[4],h,null):We(y[4]),null),(!m||h&4&&f!==(f=y[2]?"dialog":void 0))&&k(t,"role",f),(!m||h&2)&&Lt(t,"isOpen",y[1]),(!m||h&4)&&Lt(t,"isPopup",y[2])},i(y){m||(dt(b,y),m=!0)},o(y){gt(b,y),m=!1},d(y){y&&lt(t),b&&b.d(y),l[6](null)}}}function qa(l,t,f){let{$$slots:m={},$$scope:v}=t,{wrapper:b}=t,{isOpen:y}=t,{isPopup:h}=t,{toRight:e}=t;function c(o){Ct[o?"unshift":"push"](()=>{b=o,f(0,b)})}return l.$$set=o=>{"wrapper"in o&&f(0,b=o.wrapper),"isOpen"in o&&f(1,y=o.isOpen),"isPopup"in o&&f(2,h=o.isPopup),"toRight"in o&&f(3,e=o.toRight),"$$scope"in o&&f(4,v=o.$$scope)},[b,y,h,e,v,m,c]}class Ka extends At{constructor(t){super(),Et(this,t,qa,Ga,xt,{wrapper:0,isOpen:1,isPopup:2,toRight:3})}}function mn(l,t,f){const m=l.slice();return m[9]=t[f].contrast,m[10]=t[f].hex,m[11]=t[f].placeholder,m[12]=t[f].reverse,m[13]=t[f].size,m}function pn(l){let t,f,m;var v=l[0].a11ySingleNotice;function b(y){return{props:{contrast:y[9],textColor:y[12]?y[10]:y[1],bgColor:y[12]?y[1]:y[10],placeholder:y[11],size:y[13]}}}return v&&(t=St(v,b(l))),{c(){t&&bt(t.$$.fragment),f=Zt()},m(y,h){t&&_t(t,y,h),ht(y,f,h),m=!0},p(y,h){const e={};if(h&16&&(e.contrast=y[9]),h&18&&(e.textColor=y[12]?y[10]:y[1]),h&18&&(e.bgColor=y[12]?y[1]:y[10]),h&16&&(e.placeholder=y[11]),h&16&&(e.size=y[13]),h&1&&v!==(v=y[0].a11ySingleNotice)){if(t){Ft();const c=t;gt(c.$$.fragment,1,0,()=>{yt(c,1)}),Bt()}v?(t=St(v,b(y)),bt(t.$$.fragment),dt(t.$$.fragment,1),_t(t,f.parentNode,f)):t=null}else v&&t.$set(e)},i(y){m||(t&&dt(t.$$.fragment,y),m=!0)},o(y){t&&gt(t.$$.fragment,y),m=!1},d(y){y&&lt(f),t&&yt(t,y)}}}function vn(l){let t;return{c(){t=V("span"),k(t,"class","svelte-1s4dluu")},m(f,m){ht(f,t,m),t.innerHTML=l[2]},p(f,m){m&4&&(t.innerHTML=f[2])},d(f){f&&lt(t)}}}function Ja(l){let t,f,m,v,b,y,h,e,c;var o=l[0].a11ySummary;function n(s){return{props:{a11yColors:s[4],hex:s[1]}}}o&&(m=St(o,n(l)));let r=l[4],i=[];for(let s=0;s<r.length;s+=1)i[s]=pn(mn(l,r,s));const a=s=>gt(i[s],1,1,()=>{i[s]=null});let u=l[2]&&vn(l);return{c(){t=V("details"),f=V("summary"),m&&bt(m.$$.fragment),b=ot(),y=V("div");for(let s=0;s<i.length;s+=1)i[s].c();h=ot(),u&&u.c(),k(f,"tabindex",v=l[5]?-1:void 0),k(f,"class","svelte-1s4dluu"),k(y,"class","svelte-1s4dluu"),k(t,"class",e="a11y-notice "+(l[5]?"not-closable":"")+" svelte-1s4dluu"),t.open=l[3]},m(s,d){ht(s,t,d),j(t,f),m&&_t(m,f,null),j(t,b),j(t,y);for(let g=0;g<i.length;g+=1)i[g]&&i[g].m(y,null);j(y,h),u&&u.m(y,null),c=!0},p(s,[d]){const g={};if(d&16&&(g.a11yColors=s[4]),d&2&&(g.hex=s[1]),d&1&&o!==(o=s[0].a11ySummary)){if(m){Ft();const p=m;gt(p.$$.fragment,1,0,()=>{yt(p,1)}),Bt()}o?(m=St(o,n(s)),bt(m.$$.fragment),dt(m.$$.fragment,1),_t(m,f,null)):m=null}else o&&m.$set(g);if((!c||d&32&&v!==(v=s[5]?-1:void 0))&&k(f,"tabindex",v),d&19){r=s[4];let p;for(p=0;p<r.length;p+=1){const _=mn(s,r,p);i[p]?(i[p].p(_,d),dt(i[p],1)):(i[p]=pn(_),i[p].c(),dt(i[p],1),i[p].m(y,h))}for(Ft(),p=r.length;p<i.length;p+=1)a(p);Bt()}s[2]?u?u.p(s,d):(u=vn(s),u.c(),u.m(y,null)):u&&(u.d(1),u=null),(!c||d&32&&e!==(e="a11y-notice "+(s[5]?"not-closable":"")+" svelte-1s4dluu"))&&k(t,"class",e),(!c||d&8)&&(t.open=s[3])},i(s){if(!c){m&&dt(m.$$.fragment,s);for(let d=0;d<r.length;d+=1)dt(i[d]);c=!0}},o(s){m&&gt(m.$$.fragment,s),i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)gt(i[d]);c=!1},d(s){s&&lt(t),m&&yt(m),Jt(i,s),u&&u.d()}}}function Qa(l,t,f){let m,v,{components:b}=t,{a11yColors:y}=t,{hex:h}=t,{color:e}=t,{a11yGuidelines:c}=t,{isA11yOpen:o}=t,{isA11yClosable:n}=t;return l.$$set=r=>{"components"in r&&f(0,b=r.components),"a11yColors"in r&&f(6,y=r.a11yColors),"hex"in r&&f(1,h=r.hex),"color"in r&&f(7,e=r.color),"a11yGuidelines"in r&&f(2,c=r.a11yGuidelines),"isA11yOpen"in r&&f(3,o=r.isA11yOpen),"isA11yClosable"in r&&f(8,n=r.isA11yClosable)},l.$$.update=()=>{l.$$.dirty&264&&f(5,m=o&&!n),l.$$.dirty&192&&f(4,v=y.map(r=>({...r,contrast:e==null?void 0:e.contrast(r.hex)})))},[b,h,c,o,v,m,y,e,n]}class Za extends At{constructor(t){super(),Et(this,t,Qa,Ja,xt,{components:0,a11yColors:6,hex:1,color:7,a11yGuidelines:2,isA11yOpen:3,isA11yClosable:8})}}function $a(l){let t,f,m=(l[2]||"Lorem Ipsum")+"",v,b,y,h,e,c,o=(l[3]>=10?l[3].toFixed(1):l[3])+"",n,r,i,a,u;return{c(){t=V("div"),f=V("p"),v=zt(m),y=ot(),h=V("div"),e=V("p"),c=zt("contrast: "),n=zt(o),r=ot(),i=V("span"),i.textContent="AA",a=ot(),u=V("span"),u.textContent="AAA",k(f,"class",b="lorem "+(l[4]==="large"&&"large")+" svelte-obnxge"),Dt(f,"color",l[0]),Dt(f,"background-color",l[1]),k(e,"class","svelte-obnxge"),k(i,"class","grade svelte-obnxge"),Lt(i,"grade-ok",l[3]>(l[4]==="large"?3:4.5)),k(u,"class","grade svelte-obnxge"),Lt(u,"grade-ok",l[3]>(l[4]==="large"?4.5:7)),k(h,"class","score svelte-obnxge"),k(t,"class","a11y-single-notice svelte-obnxge")},m(s,d){ht(s,t,d),j(t,f),j(f,v),j(t,y),j(t,h),j(h,e),j(e,c),j(e,n),j(h,r),j(h,i),j(h,a),j(h,u)},p(s,[d]){d&4&&m!==(m=(s[2]||"Lorem Ipsum")+"")&&Oe(v,m),d&16&&b!==(b="lorem "+(s[4]==="large"&&"large")+" svelte-obnxge")&&k(f,"class",b),d&1&&Dt(f,"color",s[0]),d&2&&Dt(f,"background-color",s[1]),d&8&&o!==(o=(s[3]>=10?s[3].toFixed(1):s[3])+"")&&Oe(n,o),d&24&&Lt(i,"grade-ok",s[3]>(s[4]==="large"?3:4.5)),d&24&&Lt(u,"grade-ok",s[3]>(s[4]==="large"?4.5:7))},i:vt,o:vt,d(s){s&&lt(t)}}}function to(l,t,f){let{textColor:m}=t,{bgColor:v}=t,{placeholder:b=void 0}=t,{contrast:y=1}=t,{size:h=void 0}=t;return l.$$set=e=>{"textColor"in e&&f(0,m=e.textColor),"bgColor"in e&&f(1,v=e.bgColor),"placeholder"in e&&f(2,b=e.placeholder),"contrast"in e&&f(3,y=e.contrast),"size"in e&&f(4,h=e.size)},[m,v,b,y,h]}class eo extends At{constructor(t){super(),Et(this,t,to,$a,xt,{textColor:0,bgColor:1,placeholder:2,contrast:3,size:4})}}function io(l){let t;return{c(){t=zt(l[0])},m(f,m){ht(f,t,m)},p(f,[m]){m&1&&Oe(t,f[0])},i:vt,o:vt,d(f){f&&lt(t)}}}function no({contrast:l,size:t}){return l?t==="large"?l<3?2:l<4.5?1:0:l<4.5?2:l<7?1:0:1}function ro(l,t,f){let m,v,{a11yColors:b}=t,{hex:y}=t;return l.$$set=h=>{"a11yColors"in h&&f(1,b=h.a11yColors),"hex"in h&&f(2,y=h.hex)},l.$$.update=()=>{l.$$.dirty&2&&f(3,m=b.map(no).reduce((h,e)=>h+e)),l.$$.dirty&8&&f(0,v=m?`⚠️ ${m} contrast grade${m&&"s"} fail`:"Contrast grade information")},[v,b,y,m]}class so extends At{constructor(t){super(),Et(this,t,ro,io,xt,{a11yColors:1,hex:2})}}function ao(l){let t;return{c(){t=V("input"),k(t,"type","hidden"),t.value=l[2]},m(f,m){ht(f,t,m)},p(f,m){m[0]&4&&(t.value=f[2])},i:vt,o:vt,d(f){f&&lt(t)}}}function oo(l){let t,f,m,v,b;function y(o){l[25](o)}function h(o){l[26](o)}var e=l[21]().input;function c(o){let n={hex:o[2],label:o[6]};return o[19]!==void 0&&(n.labelWrapper=o[19]),o[3]!==void 0&&(n.isOpen=o[3]),{props:n}}return e&&(t=St(e,c(l)),Ct.push(()=>Mt(t,"labelWrapper",y)),Ct.push(()=>Mt(t,"isOpen",h))),{c(){t&&bt(t.$$.fragment),v=Zt()},m(o,n){t&&_t(t,o,n),ht(o,v,n),b=!0},p(o,n){const r={};if(n[0]&4&&(r.hex=o[2]),n[0]&64&&(r.label=o[6]),!f&&n[0]&524288&&(f=!0,r.labelWrapper=o[19],Xt(()=>f=!1)),!m&&n[0]&8&&(m=!0,r.isOpen=o[3],Xt(()=>m=!1)),e!==(e=o[21]().input)){if(t){Ft();const i=t;gt(i.$$.fragment,1,0,()=>{yt(i,1)}),Bt()}e?(t=St(e,c(o)),Ct.push(()=>Mt(t,"labelWrapper",y)),Ct.push(()=>Mt(t,"isOpen",h)),bt(t.$$.fragment),dt(t.$$.fragment,1),_t(t,v.parentNode,v)):t=null}else e&&t.$set(r)},i(o){b||(t&&dt(t.$$.fragment,o),b=!0)},o(o){t&&gt(t.$$.fragment,o),b=!1},d(o){o&&lt(v),t&&yt(t,o)}}}function _n(l){let t,f,m,v;function b(e){l[31](e)}function y(e){l[32](e)}let h={components:l[21](),hex:l[2],toRight:l[17]};return l[1].a!==void 0&&(h.a=l[1].a),l[3]!==void 0&&(h.isOpen=l[3]),t=new ya({props:h}),Ct.push(()=>Mt(t,"a",b)),Ct.push(()=>Mt(t,"isOpen",y)),{c(){bt(t.$$.fragment)},m(e,c){_t(t,e,c),v=!0},p(e,c){const o={};c[0]&4&&(o.hex=e[2]),c[0]&131072&&(o.toRight=e[17]),!f&&c[0]&2&&(f=!0,o.a=e[1].a,Xt(()=>f=!1)),!m&&c[0]&8&&(m=!0,o.isOpen=e[3],Xt(()=>m=!1)),t.$set(o)},i(e){v||(dt(t.$$.fragment,e),v=!0)},o(e){gt(t.$$.fragment,e),v=!1},d(e){yt(t,e)}}}function yn(l){let t,f,m,v,b,y;function h(r){l[33](r)}function e(r){l[34](r)}function c(r){l[35](r)}var o=l[21]().textInput;function n(r){let i={isAlpha:r[7],canChangeMode:r[10]};return r[2]!==void 0&&(i.hex=r[2]),r[0]!==void 0&&(i.rgb=r[0]),r[1]!==void 0&&(i.hsv=r[1]),{props:i}}return o&&(t=St(o,n(l)),Ct.push(()=>Mt(t,"hex",h)),Ct.push(()=>Mt(t,"rgb",e)),Ct.push(()=>Mt(t,"hsv",c))),{c(){t&&bt(t.$$.fragment),b=Zt()},m(r,i){t&&_t(t,r,i),ht(r,b,i),y=!0},p(r,i){const a={};if(i[0]&128&&(a.isAlpha=r[7]),i[0]&1024&&(a.canChangeMode=r[10]),!f&&i[0]&4&&(f=!0,a.hex=r[2],Xt(()=>f=!1)),!m&&i[0]&1&&(m=!0,a.rgb=r[0],Xt(()=>m=!1)),!v&&i[0]&2&&(v=!0,a.hsv=r[1],Xt(()=>v=!1)),o!==(o=r[21]().textInput)){if(t){Ft();const u=t;gt(u.$$.fragment,1,0,()=>{yt(u,1)}),Bt()}o?(t=St(o,n(r)),Ct.push(()=>Mt(t,"hex",h)),Ct.push(()=>Mt(t,"rgb",e)),Ct.push(()=>Mt(t,"hsv",c)),bt(t.$$.fragment),dt(t.$$.fragment,1),_t(t,b.parentNode,b)):t=null}else o&&t.$set(a)},i(r){y||(t&&dt(t.$$.fragment,r),y=!0)},o(r){t&&gt(t.$$.fragment,r),y=!1},d(r){r&&lt(b),t&&yt(t,r)}}}function bn(l){let t,f,m;var v=l[21]().a11yNotice;function b(y){return{props:{components:y[21](),a11yColors:y[12],color:y[4],hex:y[2],a11yGuidelines:y[13],isA11yOpen:y[14],isA11yClosable:y[15]}}}return v&&(t=St(v,b(l))),{c(){t&&bt(t.$$.fragment),f=Zt()},m(y,h){t&&_t(t,y,h),ht(y,f,h),m=!0},p(y,h){const e={};if(h[0]&4096&&(e.a11yColors=y[12]),h[0]&16&&(e.color=y[4]),h[0]&4&&(e.hex=y[2]),h[0]&8192&&(e.a11yGuidelines=y[13]),h[0]&16384&&(e.isA11yOpen=y[14]),h[0]&32768&&(e.isA11yClosable=y[15]),v!==(v=y[21]().a11yNotice)){if(t){Ft();const c=t;gt(c.$$.fragment,1,0,()=>{yt(c,1)}),Bt()}v?(t=St(v,b(y)),bt(t.$$.fragment),dt(t.$$.fragment,1),_t(t,f.parentNode,f)):t=null}else v&&t.$set(e)},i(y){m||(t&&dt(t.$$.fragment,y),m=!0)},o(y){t&&gt(t.$$.fragment,y),m=!1},d(y){y&&lt(f),t&&yt(t,y)}}}function lo(l){let t,f,m,v,b,y,h,e,c,o,n,r;function i(w){l[27](w)}function a(w){l[28](w)}function u(w){l[29](w)}let s={components:l[21](),h:l[1].h,toRight:l[17],isDark:l[5]};l[1].s!==void 0&&(s.s=l[1].s),l[1].v!==void 0&&(s.v=l[1].v),l[3]!==void 0&&(s.isOpen=l[3]),t=new ua({props:s}),Ct.push(()=>Mt(t,"s",i)),Ct.push(()=>Mt(t,"v",a)),Ct.push(()=>Mt(t,"isOpen",u));function d(w){l[30](w)}let g={components:l[21](),toRight:l[17]};l[1].h!==void 0&&(g.h=l[1].h),y=new ma({props:g}),Ct.push(()=>Mt(y,"h",d));let p=l[7]&&_n(l),_=l[9]&&yn(l),C=l[11]&&bn(l);return{c(){bt(t.$$.fragment),b=ot(),bt(y.$$.fragment),e=ot(),p&&p.c(),c=ot(),_&&_.c(),o=ot(),C&&C.c(),n=Zt()},m(w,S){_t(t,w,S),ht(w,b,S),_t(y,w,S),ht(w,e,S),p&&p.m(w,S),ht(w,c,S),_&&_.m(w,S),ht(w,o,S),C&&C.m(w,S),ht(w,n,S),r=!0},p(w,S){const O={};S[0]&2&&(O.h=w[1].h),S[0]&131072&&(O.toRight=w[17]),S[0]&32&&(O.isDark=w[5]),!f&&S[0]&2&&(f=!0,O.s=w[1].s,Xt(()=>f=!1)),!m&&S[0]&2&&(m=!0,O.v=w[1].v,Xt(()=>m=!1)),!v&&S[0]&8&&(v=!0,O.isOpen=w[3],Xt(()=>v=!1)),t.$set(O);const I={};S[0]&131072&&(I.toRight=w[17]),!h&&S[0]&2&&(h=!0,I.h=w[1].h,Xt(()=>h=!1)),y.$set(I),w[7]?p?(p.p(w,S),S[0]&128&&dt(p,1)):(p=_n(w),p.c(),dt(p,1),p.m(c.parentNode,c)):p&&(Ft(),gt(p,1,1,()=>{p=null}),Bt()),w[9]?_?(_.p(w,S),S[0]&512&&dt(_,1)):(_=yn(w),_.c(),dt(_,1),_.m(o.parentNode,o)):_&&(Ft(),gt(_,1,1,()=>{_=null}),Bt()),w[11]?C?(C.p(w,S),S[0]&2048&&dt(C,1)):(C=bn(w),C.c(),dt(C,1),C.m(n.parentNode,n)):C&&(Ft(),gt(C,1,1,()=>{C=null}),Bt())},i(w){r||(dt(t.$$.fragment,w),dt(y.$$.fragment,w),dt(p),dt(_),dt(C),r=!0)},o(w){gt(t.$$.fragment,w),gt(y.$$.fragment,w),gt(p),gt(_),gt(C),r=!1},d(w){yt(t,w),w&&lt(b),yt(y,w),w&&lt(e),p&&p.d(w),w&&lt(c),_&&_.d(w),w&&lt(o),C&&C.d(w),w&&lt(n)}}}function co(l){let t,f,m,v,b,y,h,e,c,o,n;t=new Fa({});const r=[oo,ao],i=[];function a(g,p){return g[8]?0:1}v=a(l),b=i[v]=r[v](l);function u(g){l[36](g)}var s=l[21]().wrapper;function d(g){let p={isOpen:g[3],isPopup:g[16],toRight:g[17],$$slots:{default:[lo]},$$scope:{ctx:g}};return g[20]!==void 0&&(p.wrapper=g[20]),{props:p}}return s&&(h=St(s,d(l)),Ct.push(()=>Mt(h,"wrapper",u))),{c(){bt(t.$$.fragment),f=ot(),m=V("span"),b.c(),y=ot(),h&&bt(h.$$.fragment),k(m,"class","color-picker svelte-7ntk55")},m(g,p){_t(t,g,p),ht(g,f,p),ht(g,m,p),i[v].m(m,null),j(m,y),h&&_t(h,m,null),l[37](m),c=!0,o||(n=[rt(window,"mousedown",l[22]),rt(window,"keyup",l[23])],o=!0)},p(g,p){let _=v;v=a(g),v===_?i[v].p(g,p):(Ft(),gt(i[_],1,1,()=>{i[_]=null}),Bt(),b=i[v],b?b.p(g,p):(b=i[v]=r[v](g),b.c()),dt(b,1),b.m(m,y));const C={};if(p[0]&8&&(C.isOpen=g[3]),p[0]&65536&&(C.isPopup=g[16]),p[0]&131072&&(C.toRight=g[17]),p[0]&196287|p[1]&8192&&(C.$$scope={dirty:p,ctx:g}),!e&&p[0]&1048576&&(e=!0,C.wrapper=g[20],Xt(()=>e=!1)),s!==(s=g[21]().wrapper)){if(h){Ft();const w=h;gt(w.$$.fragment,1,0,()=>{yt(w,1)}),Bt()}s?(h=St(s,d(g)),Ct.push(()=>Mt(h,"wrapper",u)),bt(h.$$.fragment),dt(h.$$.fragment,1),_t(h,m,null)):h=null}else s&&h.$set(C)},i(g){c||(dt(t.$$.fragment,g),dt(b),h&&dt(h.$$.fragment,g),c=!0)},o(g){gt(t.$$.fragment,g),gt(b),h&&gt(h.$$.fragment,g),c=!1},d(g){yt(t,g),g&&lt(f),g&&lt(m),i[v].d(),h&&yt(h),l[37](null),o=!1,Pt(n)}}}function ho(l,t,f){ra([sa]);let{components:m={}}=t;const v=Ns();let{label:b="Choose a color"}=t,{isAlpha:y=!0}=t,{isInput:h=!0}=t,{isTextInput:e=!0}=t,{canChangeMode:c=!0}=t,{isA11y:o=!1}=t,{a11yColors:n=[{hex:"#ffffff"}]}=t,{a11yGuidelines:r='<p style="margin: 0; font-size: 12px;">Learn more at <a href="https://webaim.org/articles/contrast/" target="_blank">WebAIM contrast guide</a></p>'}=t,{isA11yOpen:i=!1}=t,{isA11yClosable:a=!0}=t,{isPopup:u=h}=t,{isOpen:s=!h}=t,{toRight:d=!1}=t,{rgb:g={r:255,g:0,b:0,a:1}}=t,{hsv:p={h:0,s:100,v:100,a:1}}=t,{hex:_="#ff0000"}=t,{color:C=void 0}=t,{isDark:w=!1}=t,S={r:255,g:0,b:0,a:1},O={h:0,s:100,v:100,a:1},I="#ff0000",X;const Q={sliderIndicator:dn,pickerIndicator:Pa,alphaIndicator:dn,pickerWrapper:La,sliderWrapper:gn,alphaWrapper:gn,textInput:Oa,a11yNotice:Za,a11ySingleNotice:eo,a11ySummary:so,input:Va,wrapper:Ka};function tt(){return{...Q,...m}}let Y,U;function et({target:B}){h&&(Y.contains(B)||Y.isSameNode(B)?f(3,s=!s):s&&!U.contains(B)&&f(3,s=!1))}function st(B){B.key==="Tab"&&f(3,s=X==null?void 0:X.contains(document.activeElement))}function ft(){p.h===O.h&&p.s===O.s&&p.v===O.v&&p.a===O.a&&g.r===S.r&&g.g===S.g&&g.b===S.b&&g.a===S.a&&_===I||(p.a===void 0&&f(1,p.a=1,p),O.a===void 0&&(O.a=1),g.a===void 0&&f(0,g.a=1,g),S.a===void 0&&(S.a=1),(_==null?void 0:_.substring(7))==="ff"&&f(2,_=_.substring(0,7)),(_==null?void 0:_.substring(7))==="ff"&&f(2,_=_.substring(0,7)),p.h!==O.h||p.s!==O.s||p.v!==O.v||p.a!==O.a?(f(4,C=Nt(p)),f(0,g=C.toRgb()),f(2,_=C.toHex())):g.r!==S.r||g.g!==S.g||g.b!==S.b||g.a!==S.a?(f(4,C=Nt(g)),f(2,_=C.toHex()),f(1,p=C.toHsv())):_!==I&&(f(4,C=Nt(_)),f(0,g=C.toRgb()),f(1,p=C.toHsv())),C&&f(5,w=C.isDark()),O=Object.assign({},p),S=Object.assign({},g),I=_,v("input",{color:C,hsv:p,rgb:g,hex:_}))}function ut(B){Y=B,f(19,Y)}function T(B){s=B,f(3,s)}function A(B){l.$$.not_equal(p.s,B)&&(p.s=B,f(1,p))}function P(B){l.$$.not_equal(p.v,B)&&(p.v=B,f(1,p))}function D(B){s=B,f(3,s)}function z(B){l.$$.not_equal(p.h,B)&&(p.h=B,f(1,p))}function E(B){l.$$.not_equal(p.a,B)&&(p.a=B,f(1,p))}function x(B){s=B,f(3,s)}function M(B){_=B,f(2,_)}function L(B){g=B,f(0,g)}function K(B){p=B,f(1,p)}function H(B){U=B,f(20,U)}function Z(B){Ct[B?"unshift":"push"](()=>{X=B,f(18,X)})}return l.$$set=B=>{"components"in B&&f(24,m=B.components),"label"in B&&f(6,b=B.label),"isAlpha"in B&&f(7,y=B.isAlpha),"isInput"in B&&f(8,h=B.isInput),"isTextInput"in B&&f(9,e=B.isTextInput),"canChangeMode"in B&&f(10,c=B.canChangeMode),"isA11y"in B&&f(11,o=B.isA11y),"a11yColors"in B&&f(12,n=B.a11yColors),"a11yGuidelines"in B&&f(13,r=B.a11yGuidelines),"isA11yOpen"in B&&f(14,i=B.isA11yOpen),"isA11yClosable"in B&&f(15,a=B.isA11yClosable),"isPopup"in B&&f(16,u=B.isPopup),"isOpen"in B&&f(3,s=B.isOpen),"toRight"in B&&f(17,d=B.toRight),"rgb"in B&&f(0,g=B.rgb),"hsv"in B&&f(1,p=B.hsv),"hex"in B&&f(2,_=B.hex),"color"in B&&f(4,C=B.color),"isDark"in B&&f(5,w=B.isDark)},l.$$.update=()=>{l.$$.dirty[0]&7&&(p||g||_)&&ft()},[g,p,_,s,C,w,b,y,h,e,c,o,n,r,i,a,u,d,X,Y,U,tt,et,st,m,ut,T,A,P,D,z,E,x,M,L,K,H,Z]}class uo extends At{constructor(t){super(),Et(this,t,ho,co,xt,{components:24,label:6,isAlpha:7,isInput:8,isTextInput:9,canChangeMode:10,isA11y:11,a11yColors:12,a11yGuidelines:13,isA11yOpen:14,isA11yClosable:15,isPopup:16,isOpen:3,toRight:17,rgb:0,hsv:1,hex:2,color:4,isDark:5},null,[-1,-1])}}const fo=(l,t)=>Math.floor(Math.random()*(t-l+1))+l,Cn=["#ff595e","#ff924c","#ffca3a","#8ac926","#1982c4","#6a4c93","#ff99b6","#ffb7b2"],xi=["#1A1A1A","#ffffff","#ff595e","#ff924c","#ffca3a","#8ac926","#1982c4","#6a4c93","#ff99b6"],pr="/assets/강아지-8dc8fe35.png",vr="/assets/고글-bce7667d.png",_r="/assets/군모_그림자ver-7809c832.png",yr="/assets/다크서클-9bc893f3.png",br="/assets/로카티-f0132cf1.png",Cr="/assets/맥_스그-e9ec11a5.png",wr="/assets/맥_실버-26d8a8f8.png",Sr="/assets/미대_앞치마-37475593.png",Tr="/assets/백색가운-40e4ec4a.png",xr="/assets/비커-99a5efb6.png",Or="/assets/삿갓-c4dd9b40.png",kr="/assets/선글라스_테x-ef739efb.png",Er="/assets/아디다스_상-f1518384.png",Ar="/assets/안경1-83a0d23a.png",Dr="/assets/안경2-3a856db7.png",Pr="/assets/안경3-c24270fd.png",Ir="/assets/애플워치-914f9df0.png",Mr="/assets/에어팟-3a9dcbd3.png",Fr="/assets/연지곤지1-80f97cbf.png",Br="/assets/연지곤지2-4016fc09.png",Rr="/assets/연지곤지3-1d848644.png",Lr="/assets/왕붓-d9272073.png",jr="/assets/우유-bad8f90d.png",Wr="/assets/체크남방-00571185.png",Nr="/assets/초롱초롱눈-dfb02c27.png",zr="/assets/커피-c795ccf8.png",Hr="/assets/토끼귀-f9e361a0.png",Xr="/assets/토끼입-8666b238.png",Yr="/assets/학사모-53016ed3.png",Ur="/assets/학위복-8d5c5590.png",Vr="/assets/회계원리-b6091e88.png",Ge=ce(Cn[fo(0,Cn.length-1)]),Ut=ce(),ke=ce(600),Gr={bambooHat:!1,armyCap:!1,imnotku:!1,airpod:!1,graduationHat:!1,blush:!1,brightEyes:!1,ahamed:!1,happy:!1,goggles:!1,notku:!1,sunglasses:!1,darkCircles:!1,glasses:!1,roundGlasses:!1,weirdGlasses:!1,apron:!1,roka:!1,whiteCoat:!1,plaid:!1,sweatSuit:!1,graduationSuit:!1,macSpacegray:!1,macSilver:!1,beaker:!1,appleWatch:!1,bigBrush:!1,milk:!1,coffee:!1,book:!1,dog:!1},xe={bambooHat:{title:"삿갓",src:Or},armyCap:{title:"군모",src:_r},imnotku:{title:"나 쿠 아니다",src:Hr},airpod:{title:"에어팟",src:Mr},graduationHat:{title:"학사모",src:Yr},blush:{title:"연지곤지",src:Fr},brightEyes:{title:"초롱초롱",src:Nr},ahamed:{title:"뽀옹",src:Br},happy:{title:"발그레",src:Rr},goggles:{title:"고글",src:vr},notku:{title:"뽕주디",src:Xr},sunglasses:{title:"선글라스",src:kr},darkCircles:{title:"다크서클",src:yr},glasses:{title:"안경",src:Ar},roundGlasses:{title:"동글안경",src:Dr},weirdGlasses:{title:"어지럽다쿠",src:Pr},apron:{title:"앞치마",src:Sr},roka:{title:"로카티",src:br},whiteCoat:{title:"백색 가운",src:Tr},plaid:{title:"체크남방",src:Wr},sweatSuit:{title:"트레이닝복",src:Er},graduationSuit:{title:"학위복",src:Ur},macSpacegray:{title:"맥북A",src:Cr},macSilver:{title:"맥북B",src:wr},beaker:{title:"비커",src:xr},appleWatch:{title:"애플워치",src:Ir},bigBrush:{title:"왕붓",src:Lr},milk:{title:"우유",src:jr},coffee:{title:"커피",src:zr},book:{title:"회계원리",src:Vr},dog:{title:"강아지",src:pr}},Oi={bambooHat:{title:"삿갓",src:Or},armyCap:{title:"군모",src:_r},imnotku:{title:"나 쿠 아니다",src:Hr},airpod:{title:"에어팟",src:Mr},graduationHat:{title:"학사모",src:Yr}},ki={blush:{title:"연지곤지",src:Fr},brightEyes:{title:"초롱초롱",src:Nr},ahamed:{title:"뽀옹",src:Br},happy:{title:"발그레",src:Rr},goggles:{title:"고글",src:vr},notku:{title:"뽕주디",src:Xr},sunglasses:{title:"선글라스",src:kr},darkCircles:{title:"다크서클",src:yr},glasses:{title:"안경",src:Ar},roundGlasses:{title:"동글안경",src:Dr},weirdGlasses:{title:"어지럽다쿠",src:Pr}},Ei={apron:{title:"앞치마",src:Sr},roka:{title:"로카티",src:br},whiteCoat:{title:"백색 가운",src:Tr},plaid:{title:"체크남방",src:Wr},sweatSuit:{title:"트레이닝복",src:Er},graduationSuit:{title:"학위복",src:Ur}},Ai={macSpacegray:{title:"맥북A",src:Cr},macSilver:{title:"맥북B",src:wr},beaker:{title:"비커",src:xr},appleWatch:{title:"애플워치",src:Ir},bigBrush:{title:"왕붓",src:Lr},milk:{title:"우유",src:jr},coffee:{title:"커피",src:zr},book:{title:"회계원리",src:Vr},dog:{title:"강아지",src:pr}},Yi=ce(Gr),go=l=>{Yi.update(t=>({...t,[l]:!t[l]}))},mo=()=>{Yi.set(Gr)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr=function(l){const t=[];let f=0;for(let m=0;m<l.length;m++){let v=l.charCodeAt(m);v<128?t[f++]=v:v<2048?(t[f++]=v>>6|192,t[f++]=v&63|128):(v&64512)===55296&&m+1<l.length&&(l.charCodeAt(m+1)&64512)===56320?(v=65536+((v&1023)<<10)+(l.charCodeAt(++m)&1023),t[f++]=v>>18|240,t[f++]=v>>12&63|128,t[f++]=v>>6&63|128,t[f++]=v&63|128):(t[f++]=v>>12|224,t[f++]=v>>6&63|128,t[f++]=v&63|128)}return t},po=function(l){const t=[];let f=0,m=0;for(;f<l.length;){const v=l[f++];if(v<128)t[m++]=String.fromCharCode(v);else if(v>191&&v<224){const b=l[f++];t[m++]=String.fromCharCode((v&31)<<6|b&63)}else if(v>239&&v<365){const b=l[f++],y=l[f++],h=l[f++],e=((v&7)<<18|(b&63)<<12|(y&63)<<6|h&63)-65536;t[m++]=String.fromCharCode(55296+(e>>10)),t[m++]=String.fromCharCode(56320+(e&1023))}else{const b=l[f++],y=l[f++];t[m++]=String.fromCharCode((v&15)<<12|(b&63)<<6|y&63)}}return t.join("")},Kr={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(l,t){if(!Array.isArray(l))throw Error("encodeByteArray takes an array as a parameter");this.init_();const f=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,m=[];for(let v=0;v<l.length;v+=3){const b=l[v],y=v+1<l.length,h=y?l[v+1]:0,e=v+2<l.length,c=e?l[v+2]:0,o=b>>2,n=(b&3)<<4|h>>4;let r=(h&15)<<2|c>>6,i=c&63;e||(i=64,y||(r=64)),m.push(f[o],f[n],f[r],f[i])}return m.join("")},encodeString(l,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(l):this.encodeByteArray(qr(l),t)},decodeString(l,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(l):po(this.decodeStringToByteArray(l,t))},decodeStringToByteArray(l,t){this.init_();const f=t?this.charToByteMapWebSafe_:this.charToByteMap_,m=[];for(let v=0;v<l.length;){const b=f[l.charAt(v++)],h=v<l.length?f[l.charAt(v)]:0;++v;const c=v<l.length?f[l.charAt(v)]:64;++v;const n=v<l.length?f[l.charAt(v)]:64;if(++v,b==null||h==null||c==null||n==null)throw new vo;const r=b<<2|h>>4;if(m.push(r),c!==64){const i=h<<4&240|c>>2;if(m.push(i),n!==64){const a=c<<6&192|n;m.push(a)}}}return m},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let l=0;l<this.ENCODED_VALS.length;l++)this.byteToCharMap_[l]=this.ENCODED_VALS.charAt(l),this.charToByteMap_[this.byteToCharMap_[l]]=l,this.byteToCharMapWebSafe_[l]=this.ENCODED_VALS_WEBSAFE.charAt(l),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[l]]=l,l>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(l)]=l,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(l)]=l)}}};class vo extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _o=function(l){const t=qr(l);return Kr.encodeByteArray(t,!0)},Jr=function(l){return _o(l).replace(/\./g,"")},yo=function(l){try{return Kr.decodeString(l,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=()=>bo().__FIREBASE_DEFAULTS__,wo=()=>{if(typeof process>"u"||typeof process.env>"u")return;const l={}.__FIREBASE_DEFAULTS__;if(l)return JSON.parse(l)},So=()=>{if(typeof document>"u")return;let l;try{l=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=l&&yo(l[1]);return t&&JSON.parse(t)},To=()=>{try{return Co()||wo()||So()}catch(l){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${l}`);return}},Qr=()=>{var l;return(l=To())===null||l===void 0?void 0:l.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,f)=>{this.resolve=t,this.reject=f})}wrapCallback(t){return(f,m)=>{f?this.reject(f):this.resolve(m),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(f):t(f,m))}}}function Oo(){const l=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof l=="object"&&l.id!==void 0}function Zr(){try{return typeof indexedDB=="object"}catch{return!1}}function $r(){return new Promise((l,t)=>{try{let f=!0;const m="validate-browser-context-for-indexeddb-analytics-module",v=self.indexedDB.open(m);v.onsuccess=()=>{v.result.close(),f||self.indexedDB.deleteDatabase(m),l(!0)},v.onupgradeneeded=()=>{f=!1},v.onerror=()=>{var b;t(((b=v.error)===null||b===void 0?void 0:b.message)||"")}}catch(f){t(f)}})}function ko(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo="FirebaseError";class be extends Error{constructor(t,f,m){super(f),this.code=t,this.customData=m,this.name=Eo,Object.setPrototypeOf(this,be.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$e.prototype.create)}}class $e{constructor(t,f,m){this.service=t,this.serviceName=f,this.errors=m}create(t,...f){const m=f[0]||{},v=`${this.service}/${t}`,b=this.errors[t],y=b?Ao(b,m):"Error",h=`${this.serviceName}: ${y} (${v}).`;return new be(v,h,m)}}function Ao(l,t){return l.replace(Do,(f,m)=>{const v=t[m];return v!=null?String(v):`<${m}?>`})}const Do=/\{\$([^}]+)}/g;function qe(l,t){if(l===t)return!0;const f=Object.keys(l),m=Object.keys(t);for(const v of f){if(!m.includes(v))return!1;const b=l[v],y=t[v];if(wn(b)&&wn(y)){if(!qe(b,y))return!1}else if(b!==y)return!1}for(const v of m)if(!f.includes(v))return!1;return!0}function wn(l){return l!==null&&typeof l=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=1e3,Io=2,Mo=4*60*60*1e3,Fo=.5;function Sn(l,t=Po,f=Io){const m=t*Math.pow(f,l),v=Math.round(Fo*m*(Math.random()-.5)*2);return Math.min(Mo,m+v)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(l){return l&&l._delegate?l._delegate:l}class le{constructor(t,f,m){this.name=t,this.instanceFactory=f,this.type=m,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(t,f){this.name=t,this.container=f,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const f=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(f)){const m=new xo;if(this.instancesDeferred.set(f,m),this.isInitialized(f)||this.shouldAutoInitialize())try{const v=this.getOrInitializeService({instanceIdentifier:f});v&&m.resolve(v)}catch{}}return this.instancesDeferred.get(f).promise}getImmediate(t){var f;const m=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),v=(f=t==null?void 0:t.optional)!==null&&f!==void 0?f:!1;if(this.isInitialized(m)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:m})}catch(b){if(v)return null;throw b}else{if(v)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Lo(t))try{this.getOrInitializeService({instanceIdentifier:ue})}catch{}for(const[f,m]of this.instancesDeferred.entries()){const v=this.normalizeInstanceIdentifier(f);try{const b=this.getOrInitializeService({instanceIdentifier:v});m.resolve(b)}catch{}}}}clearInstance(t=ue){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(f=>"INTERNAL"in f).map(f=>f.INTERNAL.delete()),...t.filter(f=>"_delete"in f).map(f=>f._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ue){return this.instances.has(t)}getOptions(t=ue){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:f={}}=t,m=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(m))throw Error(`${this.name}(${m}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const v=this.getOrInitializeService({instanceIdentifier:m,options:f});for(const[b,y]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(b);m===h&&y.resolve(v)}return v}onInit(t,f){var m;const v=this.normalizeInstanceIdentifier(f),b=(m=this.onInitCallbacks.get(v))!==null&&m!==void 0?m:new Set;b.add(t),this.onInitCallbacks.set(v,b);const y=this.instances.get(v);return y&&t(y,v),()=>{b.delete(t)}}invokeOnInitCallbacks(t,f){const m=this.onInitCallbacks.get(f);if(m)for(const v of m)try{v(t,f)}catch{}}getOrInitializeService({instanceIdentifier:t,options:f={}}){let m=this.instances.get(t);if(!m&&this.component&&(m=this.component.instanceFactory(this.container,{instanceIdentifier:Ro(t),options:f}),this.instances.set(t,m),this.instancesOptions.set(t,f),this.invokeOnInitCallbacks(m,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,m)}catch{}return m||null}normalizeInstanceIdentifier(t=ue){return this.component?this.component.multipleInstances?t:ue:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ro(l){return l===ue?void 0:l}function Lo(l){return l.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const f=this.getProvider(t.name);if(f.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);f.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const f=new Bo(t,this);return this.providers.set(t,f),f}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt;(function(l){l[l.DEBUG=0]="DEBUG",l[l.VERBOSE=1]="VERBOSE",l[l.INFO=2]="INFO",l[l.WARN=3]="WARN",l[l.ERROR=4]="ERROR",l[l.SILENT=5]="SILENT"})(Tt||(Tt={}));const Wo={debug:Tt.DEBUG,verbose:Tt.VERBOSE,info:Tt.INFO,warn:Tt.WARN,error:Tt.ERROR,silent:Tt.SILENT},No=Tt.INFO,zo={[Tt.DEBUG]:"log",[Tt.VERBOSE]:"log",[Tt.INFO]:"info",[Tt.WARN]:"warn",[Tt.ERROR]:"error"},Ho=(l,t,...f)=>{if(t<l.logLevel)return;const m=new Date().toISOString(),v=zo[t];if(v)console[v](`[${m}]  ${l.name}:`,...f);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class es{constructor(t){this.name=t,this._logLevel=No,this._logHandler=Ho,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Tt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Wo[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Tt.DEBUG,...t),this._logHandler(this,Tt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Tt.VERBOSE,...t),this._logHandler(this,Tt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Tt.INFO,...t),this._logHandler(this,Tt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Tt.WARN,...t),this._logHandler(this,Tt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Tt.ERROR,...t),this._logHandler(this,Tt.ERROR,...t)}}const Xo=(l,t)=>t.some(f=>l instanceof f);let Tn,xn;function Yo(){return Tn||(Tn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Uo(){return xn||(xn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const is=new WeakMap,Di=new WeakMap,ns=new WeakMap,hi=new WeakMap,Ui=new WeakMap;function Vo(l){const t=new Promise((f,m)=>{const v=()=>{l.removeEventListener("success",b),l.removeEventListener("error",y)},b=()=>{f(ne(l.result)),v()},y=()=>{m(l.error),v()};l.addEventListener("success",b),l.addEventListener("error",y)});return t.then(f=>{f instanceof IDBCursor&&is.set(f,l)}).catch(()=>{}),Ui.set(t,l),t}function Go(l){if(Di.has(l))return;const t=new Promise((f,m)=>{const v=()=>{l.removeEventListener("complete",b),l.removeEventListener("error",y),l.removeEventListener("abort",y)},b=()=>{f(),v()},y=()=>{m(l.error||new DOMException("AbortError","AbortError")),v()};l.addEventListener("complete",b),l.addEventListener("error",y),l.addEventListener("abort",y)});Di.set(l,t)}let Pi={get(l,t,f){if(l instanceof IDBTransaction){if(t==="done")return Di.get(l);if(t==="objectStoreNames")return l.objectStoreNames||ns.get(l);if(t==="store")return f.objectStoreNames[1]?void 0:f.objectStore(f.objectStoreNames[0])}return ne(l[t])},set(l,t,f){return l[t]=f,!0},has(l,t){return l instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in l}};function qo(l){Pi=l(Pi)}function Ko(l){return l===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...f){const m=l.call(ui(this),t,...f);return ns.set(m,t.sort?t.sort():[t]),ne(m)}:Uo().includes(l)?function(...t){return l.apply(ui(this),t),ne(is.get(this))}:function(...t){return ne(l.apply(ui(this),t))}}function Jo(l){return typeof l=="function"?Ko(l):(l instanceof IDBTransaction&&Go(l),Xo(l,Yo())?new Proxy(l,Pi):l)}function ne(l){if(l instanceof IDBRequest)return Vo(l);if(hi.has(l))return hi.get(l);const t=Jo(l);return t!==l&&(hi.set(l,t),Ui.set(t,l)),t}const ui=l=>Ui.get(l);function Qo(l,t,{blocked:f,upgrade:m,blocking:v,terminated:b}={}){const y=indexedDB.open(l,t),h=ne(y);return m&&y.addEventListener("upgradeneeded",e=>{m(ne(y.result),e.oldVersion,e.newVersion,ne(y.transaction),e)}),f&&y.addEventListener("blocked",e=>f(e.oldVersion,e.newVersion,e)),h.then(e=>{b&&e.addEventListener("close",()=>b()),v&&e.addEventListener("versionchange",c=>v(c.oldVersion,c.newVersion,c))}).catch(()=>{}),h}const Zo=["get","getKey","getAll","getAllKeys","count"],$o=["put","add","delete","clear"],fi=new Map;function On(l,t){if(!(l instanceof IDBDatabase&&!(t in l)&&typeof t=="string"))return;if(fi.get(t))return fi.get(t);const f=t.replace(/FromIndex$/,""),m=t!==f,v=$o.includes(f);if(!(f in(m?IDBIndex:IDBObjectStore).prototype)||!(v||Zo.includes(f)))return;const b=async function(y,...h){const e=this.transaction(y,v?"readwrite":"readonly");let c=e.store;return m&&(c=c.index(h.shift())),(await Promise.all([c[f](...h),v&&e.done]))[0]};return fi.set(t,b),b}qo(l=>({...l,get:(t,f,m)=>On(t,f)||l.get(t,f,m),has:(t,f)=>!!On(t,f)||l.has(t,f)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(f=>{if(el(f)){const m=f.getImmediate();return`${m.library}/${m.version}`}else return null}).filter(f=>f).join(" ")}}function el(l){const t=l.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Ii="@firebase/app",kn="0.9.10";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pe=new es("@firebase/app"),il="@firebase/app-compat",nl="@firebase/analytics-compat",rl="@firebase/analytics",sl="@firebase/app-check-compat",al="@firebase/app-check",ol="@firebase/auth",ll="@firebase/auth-compat",cl="@firebase/database",hl="@firebase/database-compat",ul="@firebase/functions",fl="@firebase/functions-compat",dl="@firebase/installations",gl="@firebase/installations-compat",ml="@firebase/messaging",pl="@firebase/messaging-compat",vl="@firebase/performance",_l="@firebase/performance-compat",yl="@firebase/remote-config",bl="@firebase/remote-config-compat",Cl="@firebase/storage",wl="@firebase/storage-compat",Sl="@firebase/firestore",Tl="@firebase/firestore-compat",xl="firebase";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi="[DEFAULT]",Ol={[Ii]:"fire-core",[il]:"fire-core-compat",[rl]:"fire-analytics",[nl]:"fire-analytics-compat",[al]:"fire-app-check",[sl]:"fire-app-check-compat",[ol]:"fire-auth",[ll]:"fire-auth-compat",[cl]:"fire-rtdb",[hl]:"fire-rtdb-compat",[ul]:"fire-fn",[fl]:"fire-fn-compat",[dl]:"fire-iid",[gl]:"fire-iid-compat",[ml]:"fire-fcm",[pl]:"fire-fcm-compat",[vl]:"fire-perf",[_l]:"fire-perf-compat",[yl]:"fire-rc",[bl]:"fire-rc-compat",[Cl]:"fire-gcs",[wl]:"fire-gcs-compat",[Sl]:"fire-fst",[Tl]:"fire-fst-compat","fire-js":"fire-js",[xl]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ke=new Map,Fi=new Map;function kl(l,t){try{l.container.addComponent(t)}catch(f){pe.debug(`Component ${t.name} failed to register with FirebaseApp ${l.name}`,f)}}function ve(l){const t=l.name;if(Fi.has(t))return pe.debug(`There were multiple attempts to register component ${t}.`),!1;Fi.set(t,l);for(const f of Ke.values())kl(f,l);return!0}function ti(l,t){const f=l.container.getProvider("heartbeat").getImmediate({optional:!0});return f&&f.triggerHeartbeat(),l.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const El={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},re=new $e("app","Firebase",El);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(t,f,m){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},f),this._name=f.name,this._automaticDataCollectionEnabled=f.automaticDataCollectionEnabled,this._container=m,this.container.addComponent(new le("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw re.create("app-deleted",{appName:this._name})}}function rs(l,t={}){let f=l;typeof t!="object"&&(t={name:t});const m=Object.assign({name:Mi,automaticDataCollectionEnabled:!1},t),v=m.name;if(typeof v!="string"||!v)throw re.create("bad-app-name",{appName:String(v)});if(f||(f=Qr()),!f)throw re.create("no-options");const b=Ke.get(v);if(b){if(qe(f,b.options)&&qe(m,b.config))return b;throw re.create("duplicate-app",{appName:v})}const y=new jo(v);for(const e of Fi.values())y.addComponent(e);const h=new Al(f,m,y);return Ke.set(v,h),h}function Dl(l=Mi){const t=Ke.get(l);if(!t&&l===Mi&&Qr())return rs();if(!t)throw re.create("no-app",{appName:l});return t}function se(l,t,f){var m;let v=(m=Ol[l])!==null&&m!==void 0?m:l;f&&(v+=`-${f}`);const b=v.match(/\s|\//),y=t.match(/\s|\//);if(b||y){const h=[`Unable to register library "${v}" with version "${t}":`];b&&h.push(`library name "${v}" contains illegal characters (whitespace or "/")`),b&&y&&h.push("and"),y&&h.push(`version name "${t}" contains illegal characters (whitespace or "/")`),pe.warn(h.join(" "));return}ve(new le(`${v}-version`,()=>({library:v,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl="firebase-heartbeat-database",Il=1,ze="firebase-heartbeat-store";let di=null;function ss(){return di||(di=Qo(Pl,Il,{upgrade:(l,t)=>{switch(t){case 0:l.createObjectStore(ze)}}}).catch(l=>{throw re.create("idb-open",{originalErrorMessage:l.message})})),di}async function Ml(l){try{return await(await ss()).transaction(ze).objectStore(ze).get(as(l))}catch(t){if(t instanceof be)pe.warn(t.message);else{const f=re.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});pe.warn(f.message)}}}async function En(l,t){try{const m=(await ss()).transaction(ze,"readwrite");await m.objectStore(ze).put(t,as(l)),await m.done}catch(f){if(f instanceof be)pe.warn(f.message);else{const m=re.create("idb-set",{originalErrorMessage:f==null?void 0:f.message});pe.warn(m.message)}}}function as(l){return`${l.name}!${l.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=1024,Bl=30*24*60*60*1e3;class Rl{constructor(t){this.container=t,this._heartbeatsCache=null;const f=this.container.getProvider("app").getImmediate();this._storage=new jl(f),this._heartbeatsCachePromise=this._storage.read().then(m=>(this._heartbeatsCache=m,m))}async triggerHeartbeat(){const f=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),m=An();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===m||this._heartbeatsCache.heartbeats.some(v=>v.date===m)))return this._heartbeatsCache.heartbeats.push({date:m,agent:f}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(v=>{const b=new Date(v.date).valueOf();return Date.now()-b<=Bl}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const t=An(),{heartbeatsToSend:f,unsentEntries:m}=Ll(this._heartbeatsCache.heartbeats),v=Jr(JSON.stringify({version:2,heartbeats:f}));return this._heartbeatsCache.lastSentHeartbeatDate=t,m.length>0?(this._heartbeatsCache.heartbeats=m,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),v}}function An(){return new Date().toISOString().substring(0,10)}function Ll(l,t=Fl){const f=[];let m=l.slice();for(const v of l){const b=f.find(y=>y.agent===v.agent);if(b){if(b.dates.push(v.date),Dn(f)>t){b.dates.pop();break}}else if(f.push({agent:v.agent,dates:[v.date]}),Dn(f)>t){f.pop();break}m=m.slice(1)}return{heartbeatsToSend:f,unsentEntries:m}}class jl{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Zr()?$r().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Ml(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(t){var f;if(await this._canUseIndexedDBPromise){const v=await this.read();return En(this.app,{lastSentHeartbeatDate:(f=t.lastSentHeartbeatDate)!==null&&f!==void 0?f:v.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var f;if(await this._canUseIndexedDBPromise){const v=await this.read();return En(this.app,{lastSentHeartbeatDate:(f=t.lastSentHeartbeatDate)!==null&&f!==void 0?f:v.lastSentHeartbeatDate,heartbeats:[...v.heartbeats,...t.heartbeats]})}else return}}function Dn(l){return Jr(JSON.stringify({version:2,heartbeats:l})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(l){ve(new le("platform-logger",t=>new tl(t),"PRIVATE")),ve(new le("heartbeat",t=>new Rl(t),"PRIVATE")),se(Ii,kn,l),se(Ii,kn,"esm2017"),se("fire-js","")}Wl("");const Nl=(l,t)=>t.some(f=>l instanceof f);let Pn,In;function zl(){return Pn||(Pn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hl(){return In||(In=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const os=new WeakMap,Bi=new WeakMap,ls=new WeakMap,gi=new WeakMap,Vi=new WeakMap;function Xl(l){const t=new Promise((f,m)=>{const v=()=>{l.removeEventListener("success",b),l.removeEventListener("error",y)},b=()=>{f(ae(l.result)),v()},y=()=>{m(l.error),v()};l.addEventListener("success",b),l.addEventListener("error",y)});return t.then(f=>{f instanceof IDBCursor&&os.set(f,l)}).catch(()=>{}),Vi.set(t,l),t}function Yl(l){if(Bi.has(l))return;const t=new Promise((f,m)=>{const v=()=>{l.removeEventListener("complete",b),l.removeEventListener("error",y),l.removeEventListener("abort",y)},b=()=>{f(),v()},y=()=>{m(l.error||new DOMException("AbortError","AbortError")),v()};l.addEventListener("complete",b),l.addEventListener("error",y),l.addEventListener("abort",y)});Bi.set(l,t)}let Ri={get(l,t,f){if(l instanceof IDBTransaction){if(t==="done")return Bi.get(l);if(t==="objectStoreNames")return l.objectStoreNames||ls.get(l);if(t==="store")return f.objectStoreNames[1]?void 0:f.objectStore(f.objectStoreNames[0])}return ae(l[t])},set(l,t,f){return l[t]=f,!0},has(l,t){return l instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in l}};function Ul(l){Ri=l(Ri)}function Vl(l){return l===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...f){const m=l.call(mi(this),t,...f);return ls.set(m,t.sort?t.sort():[t]),ae(m)}:Hl().includes(l)?function(...t){return l.apply(mi(this),t),ae(os.get(this))}:function(...t){return ae(l.apply(mi(this),t))}}function Gl(l){return typeof l=="function"?Vl(l):(l instanceof IDBTransaction&&Yl(l),Nl(l,zl())?new Proxy(l,Ri):l)}function ae(l){if(l instanceof IDBRequest)return Xl(l);if(gi.has(l))return gi.get(l);const t=Gl(l);return t!==l&&(gi.set(l,t),Vi.set(t,l)),t}const mi=l=>Vi.get(l);function ql(l,t,{blocked:f,upgrade:m,blocking:v,terminated:b}={}){const y=indexedDB.open(l,t),h=ae(y);return m&&y.addEventListener("upgradeneeded",e=>{m(ae(y.result),e.oldVersion,e.newVersion,ae(y.transaction))}),f&&y.addEventListener("blocked",()=>f()),h.then(e=>{b&&e.addEventListener("close",()=>b()),v&&e.addEventListener("versionchange",()=>v())}).catch(()=>{}),h}const Kl=["get","getKey","getAll","getAllKeys","count"],Jl=["put","add","delete","clear"],pi=new Map;function Mn(l,t){if(!(l instanceof IDBDatabase&&!(t in l)&&typeof t=="string"))return;if(pi.get(t))return pi.get(t);const f=t.replace(/FromIndex$/,""),m=t!==f,v=Jl.includes(f);if(!(f in(m?IDBIndex:IDBObjectStore).prototype)||!(v||Kl.includes(f)))return;const b=async function(y,...h){const e=this.transaction(y,v?"readwrite":"readonly");let c=e.store;return m&&(c=c.index(h.shift())),(await Promise.all([c[f](...h),v&&e.done]))[0]};return pi.set(t,b),b}Ul(l=>({...l,get:(t,f,m)=>Mn(t,f)||l.get(t,f,m),has:(t,f)=>!!Mn(t,f)||l.has(t,f)}));const cs="@firebase/installations",Gi="0.6.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs=1e4,us=`w:${Gi}`,fs="FIS_v2",Ql="https://firebaseinstallations.googleapis.com/v1",Zl=60*60*1e3,$l="installations",tc="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},_e=new $e($l,tc,ec);function ds(l){return l instanceof be&&l.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs({projectId:l}){return`${Ql}/projects/${l}/installations`}function ms(l){return{token:l.token,requestStatus:2,expiresIn:nc(l.expiresIn),creationTime:Date.now()}}async function ps(l,t){const m=(await t.json()).error;return _e.create("request-failed",{requestName:l,serverCode:m.code,serverMessage:m.message,serverStatus:m.status})}function vs({apiKey:l}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":l})}function ic(l,{refreshToken:t}){const f=vs(l);return f.append("Authorization",rc(t)),f}async function _s(l){const t=await l();return t.status>=500&&t.status<600?l():t}function nc(l){return Number(l.replace("s","000"))}function rc(l){return`${fs} ${l}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sc({appConfig:l,heartbeatServiceProvider:t},{fid:f}){const m=gs(l),v=vs(l),b=t.getImmediate({optional:!0});if(b){const c=await b.getHeartbeatsHeader();c&&v.append("x-firebase-client",c)}const y={fid:f,authVersion:fs,appId:l.appId,sdkVersion:us},h={method:"POST",headers:v,body:JSON.stringify(y)},e=await _s(()=>fetch(m,h));if(e.ok){const c=await e.json();return{fid:c.fid||f,registrationStatus:2,refreshToken:c.refreshToken,authToken:ms(c.authToken)}}else throw await ps("Create Installation",e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(l){return new Promise(t=>{setTimeout(t,l)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ac(l){return btoa(String.fromCharCode(...l)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oc=/^[cdef][\w-]{21}$/,Li="";function lc(){try{const l=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(l),l[0]=112+l[0]%16;const f=cc(l);return oc.test(f)?f:Li}catch{return Li}}function cc(l){return ac(l).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(l){return`${l.appName}!${l.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs=new Map;function Cs(l,t){const f=ei(l);ws(f,t),hc(f,t)}function ws(l,t){const f=bs.get(l);if(f)for(const m of f)m(t)}function hc(l,t){const f=uc();f&&f.postMessage({key:l,fid:t}),fc()}let ge=null;function uc(){return!ge&&"BroadcastChannel"in self&&(ge=new BroadcastChannel("[Firebase] FID Change"),ge.onmessage=l=>{ws(l.data.key,l.data.fid)}),ge}function fc(){bs.size===0&&ge&&(ge.close(),ge=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc="firebase-installations-database",gc=1,ye="firebase-installations-store";let vi=null;function qi(){return vi||(vi=ql(dc,gc,{upgrade:(l,t)=>{switch(t){case 0:l.createObjectStore(ye)}}})),vi}async function Je(l,t){const f=ei(l),v=(await qi()).transaction(ye,"readwrite"),b=v.objectStore(ye),y=await b.get(f);return await b.put(t,f),await v.done,(!y||y.fid!==t.fid)&&Cs(l,t.fid),t}async function Ss(l){const t=ei(l),m=(await qi()).transaction(ye,"readwrite");await m.objectStore(ye).delete(t),await m.done}async function ii(l,t){const f=ei(l),v=(await qi()).transaction(ye,"readwrite"),b=v.objectStore(ye),y=await b.get(f),h=t(y);return h===void 0?await b.delete(f):await b.put(h,f),await v.done,h&&(!y||y.fid!==h.fid)&&Cs(l,h.fid),h}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ki(l){let t;const f=await ii(l.appConfig,m=>{const v=mc(m),b=pc(l,v);return t=b.registrationPromise,b.installationEntry});return f.fid===Li?{installationEntry:await t}:{installationEntry:f,registrationPromise:t}}function mc(l){const t=l||{fid:lc(),registrationStatus:0};return Ts(t)}function pc(l,t){if(t.registrationStatus===0){if(!navigator.onLine){const v=Promise.reject(_e.create("app-offline"));return{installationEntry:t,registrationPromise:v}}const f={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},m=vc(l,f);return{installationEntry:f,registrationPromise:m}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:_c(l)}:{installationEntry:t}}async function vc(l,t){try{const f=await sc(l,t);return Je(l.appConfig,f)}catch(f){throw ds(f)&&f.customData.serverCode===409?await Ss(l.appConfig):await Je(l.appConfig,{fid:t.fid,registrationStatus:0}),f}}async function _c(l){let t=await Fn(l.appConfig);for(;t.registrationStatus===1;)await ys(100),t=await Fn(l.appConfig);if(t.registrationStatus===0){const{installationEntry:f,registrationPromise:m}=await Ki(l);return m||f}return t}function Fn(l){return ii(l,t=>{if(!t)throw _e.create("installation-not-found");return Ts(t)})}function Ts(l){return yc(l)?{fid:l.fid,registrationStatus:0}:l}function yc(l){return l.registrationStatus===1&&l.registrationTime+hs<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bc({appConfig:l,heartbeatServiceProvider:t},f){const m=Cc(l,f),v=ic(l,f),b=t.getImmediate({optional:!0});if(b){const c=await b.getHeartbeatsHeader();c&&v.append("x-firebase-client",c)}const y={installation:{sdkVersion:us,appId:l.appId}},h={method:"POST",headers:v,body:JSON.stringify(y)},e=await _s(()=>fetch(m,h));if(e.ok){const c=await e.json();return ms(c)}else throw await ps("Generate Auth Token",e)}function Cc(l,{fid:t}){return`${gs(l)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ji(l,t=!1){let f;const m=await ii(l.appConfig,b=>{if(!xs(b))throw _e.create("not-registered");const y=b.authToken;if(!t&&Tc(y))return b;if(y.requestStatus===1)return f=wc(l,t),b;{if(!navigator.onLine)throw _e.create("app-offline");const h=Oc(b);return f=Sc(l,h),h}});return f?await f:m.authToken}async function wc(l,t){let f=await Bn(l.appConfig);for(;f.authToken.requestStatus===1;)await ys(100),f=await Bn(l.appConfig);const m=f.authToken;return m.requestStatus===0?Ji(l,t):m}function Bn(l){return ii(l,t=>{if(!xs(t))throw _e.create("not-registered");const f=t.authToken;return kc(f)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}async function Sc(l,t){try{const f=await bc(l,t),m=Object.assign(Object.assign({},t),{authToken:f});return await Je(l.appConfig,m),f}catch(f){if(ds(f)&&(f.customData.serverCode===401||f.customData.serverCode===404))await Ss(l.appConfig);else{const m=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Je(l.appConfig,m)}throw f}}function xs(l){return l!==void 0&&l.registrationStatus===2}function Tc(l){return l.requestStatus===2&&!xc(l)}function xc(l){const t=Date.now();return t<l.creationTime||l.creationTime+l.expiresIn<t+Zl}function Oc(l){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},l),{authToken:t})}function kc(l){return l.requestStatus===1&&l.requestTime+hs<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ec(l){const t=l,{installationEntry:f,registrationPromise:m}=await Ki(t);return m?m.catch(console.error):Ji(t).catch(console.error),f.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ac(l,t=!1){const f=l;return await Dc(f),(await Ji(f,t)).token}async function Dc(l){const{registrationPromise:t}=await Ki(l);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(l){if(!l||!l.options)throw _i("App Configuration");if(!l.name)throw _i("App Name");const t=["projectId","apiKey","appId"];for(const f of t)if(!l.options[f])throw _i(f);return{appName:l.name,projectId:l.options.projectId,apiKey:l.options.apiKey,appId:l.options.appId}}function _i(l){return _e.create("missing-app-config-values",{valueName:l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os="installations",Ic="installations-internal",Mc=l=>{const t=l.getProvider("app").getImmediate(),f=Pc(t),m=ti(t,"heartbeat");return{app:t,appConfig:f,heartbeatServiceProvider:m,_delete:()=>Promise.resolve()}},Fc=l=>{const t=l.getProvider("app").getImmediate(),f=ti(t,Os).getImmediate();return{getId:()=>Ec(f),getToken:v=>Ac(f,v)}};function Bc(){ve(new le(Os,Mc,"PUBLIC")),ve(new le(Ic,Fc,"PRIVATE"))}Bc();se(cs,Gi);se(cs,Gi,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qe="analytics",Rc="firebase_id",Lc="origin",jc=60*1e3,Wc="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Qi="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt=new es("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',["no-client-id"]:'The "client_id" field is empty.',["invalid-gtag-resource"]:"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Vt=new $e("analytics","Analytics",Nc);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(l){if(!l.startsWith(Qi)){const t=Vt.create("invalid-gtag-resource",{gtagURL:l});return Yt.warn(t.message),""}return l}function ks(l){return Promise.all(l.map(t=>t.catch(f=>f)))}function Hc(l,t){let f;return window.trustedTypes&&(f=window.trustedTypes.createPolicy(l,t)),f}function Xc(l,t){const f=Hc("firebase-js-sdk-policy",{createScriptURL:zc}),m=document.createElement("script"),v=`${Qi}?l=${l}&id=${t}`;m.src=f?f==null?void 0:f.createScriptURL(v):v,m.async=!0,document.head.appendChild(m)}function Yc(l){let t=[];return Array.isArray(window[l])?t=window[l]:window[l]=t,t}async function Uc(l,t,f,m,v,b){const y=m[v];try{if(y)await t[y];else{const e=(await ks(f)).find(c=>c.measurementId===v);e&&await t[e.appId]}}catch(h){Yt.error(h)}l("config",v,b)}async function Vc(l,t,f,m,v){try{let b=[];if(v&&v.send_to){let y=v.send_to;Array.isArray(y)||(y=[y]);const h=await ks(f);for(const e of y){const c=h.find(n=>n.measurementId===e),o=c&&t[c.appId];if(o)b.push(o);else{b=[];break}}}b.length===0&&(b=Object.values(t)),await Promise.all(b),l("event",m,v||{})}catch(b){Yt.error(b)}}function Gc(l,t,f,m){async function v(b,...y){try{if(b==="event"){const[h,e]=y;await Vc(l,t,f,h,e)}else if(b==="config"){const[h,e]=y;await Uc(l,t,f,m,h,e)}else if(b==="consent"){const[h]=y;l("consent","update",h)}else if(b==="get"){const[h,e,c]=y;l("get",h,e,c)}else if(b==="set"){const[h]=y;l("set",h)}else l(b,...y)}catch(h){Yt.error(h)}}return v}function qc(l,t,f,m,v){let b=function(...y){window[m].push(arguments)};return window[v]&&typeof window[v]=="function"&&(b=window[v]),window[v]=Gc(b,l,t,f),{gtagCore:b,wrappedGtag:window[v]}}function Kc(l){const t=window.document.getElementsByTagName("script");for(const f of Object.values(t))if(f.src&&f.src.includes(Qi)&&f.src.includes(l))return f;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=30,Qc=1e3;class Zc{constructor(t={},f=Qc){this.throttleMetadata=t,this.intervalMillis=f}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,f){this.throttleMetadata[t]=f}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const Es=new Zc;function $c(l){return new Headers({Accept:"application/json","x-goog-api-key":l})}async function th(l){var t;const{appId:f,apiKey:m}=l,v={method:"GET",headers:$c(m)},b=Wc.replace("{app-id}",f),y=await fetch(b,v);if(y.status!==200&&y.status!==304){let h="";try{const e=await y.json();!((t=e.error)===null||t===void 0)&&t.message&&(h=e.error.message)}catch{}throw Vt.create("config-fetch-failed",{httpStatus:y.status,responseMessage:h})}return y.json()}async function eh(l,t=Es,f){const{appId:m,apiKey:v,measurementId:b}=l.options;if(!m)throw Vt.create("no-app-id");if(!v){if(b)return{measurementId:b,appId:m};throw Vt.create("no-api-key")}const y=t.getThrottleMetadata(m)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new rh;return setTimeout(async()=>{h.abort()},f!==void 0?f:jc),As({appId:m,apiKey:v,measurementId:b},y,h,t)}async function As(l,{throttleEndTimeMillis:t,backoffCount:f},m,v=Es){var b;const{appId:y,measurementId:h}=l;try{await ih(m,t)}catch(e){if(h)return Yt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${e==null?void 0:e.message}]`),{appId:y,measurementId:h};throw e}try{const e=await th(l);return v.deleteThrottleMetadata(y),e}catch(e){const c=e;if(!nh(c)){if(v.deleteThrottleMetadata(y),h)return Yt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:y,measurementId:h};throw e}const o=Number((b=c==null?void 0:c.customData)===null||b===void 0?void 0:b.httpStatus)===503?Sn(f,v.intervalMillis,Jc):Sn(f,v.intervalMillis),n={throttleEndTimeMillis:Date.now()+o,backoffCount:f+1};return v.setThrottleMetadata(y,n),Yt.debug(`Calling attemptFetch again in ${o} millis`),As(l,n,m,v)}}function ih(l,t){return new Promise((f,m)=>{const v=Math.max(t-Date.now(),0),b=setTimeout(f,v);l.addEventListener(()=>{clearTimeout(b),m(Vt.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function nh(l){if(!(l instanceof be)||!l.customData)return!1;const t=Number(l.customData.httpStatus);return t===429||t===500||t===503||t===504}class rh{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function sh(l,t,f,m,v){if(v&&v.global){l("event",f,m);return}else{const b=await t,y=Object.assign(Object.assign({},m),{send_to:b});l("event",f,y)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ah(){if(Zr())try{await $r()}catch(l){return Yt.warn(Vt.create("indexeddb-unavailable",{errorInfo:l==null?void 0:l.toString()}).message),!1}else return Yt.warn(Vt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function oh(l,t,f,m,v,b,y){var h;const e=eh(l);e.then(i=>{f[i.measurementId]=i.appId,l.options.measurementId&&i.measurementId!==l.options.measurementId&&Yt.warn(`The measurement ID in the local Firebase config (${l.options.measurementId}) does not match the measurement ID fetched from the server (${i.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(i=>Yt.error(i)),t.push(e);const c=ah().then(i=>{if(i)return m.getId()}),[o,n]=await Promise.all([e,c]);Kc(b)||Xc(b,o.measurementId),v("js",new Date);const r=(h=y==null?void 0:y.config)!==null&&h!==void 0?h:{};return r[Lc]="firebase",r.update=!0,n!=null&&(r[Rc]=n),v("config",o.measurementId,r),o.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(t){this.app=t}_delete(){return delete Fe[this.app.options.appId],Promise.resolve()}}let Fe={},Rn=[];const Ln={};let yi="dataLayer",ch="gtag",jn,Ds,Wn=!1;function hh(){const l=[];if(Oo()&&l.push("This is a browser extension environment."),ko()||l.push("Cookies are not available."),l.length>0){const t=l.map((m,v)=>`(${v+1}) ${m}`).join(" "),f=Vt.create("invalid-analytics-context",{errorInfo:t});Yt.warn(f.message)}}function uh(l,t,f){hh();const m=l.options.appId;if(!m)throw Vt.create("no-app-id");if(!l.options.apiKey)if(l.options.measurementId)Yt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${l.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Vt.create("no-api-key");if(Fe[m]!=null)throw Vt.create("already-exists",{id:m});if(!Wn){Yc(yi);const{wrappedGtag:b,gtagCore:y}=qc(Fe,Rn,Ln,yi,ch);Ds=b,jn=y,Wn=!0}return Fe[m]=oh(l,Rn,Ln,t,jn,yi,f),new lh(l)}function fh(l=Dl()){l=ts(l);const t=ti(l,Qe);return t.isInitialized()?t.getImmediate():dh(l)}function dh(l,t={}){const f=ti(l,Qe);if(f.isInitialized()){const v=f.getImmediate();if(qe(t,f.getOptions()))return v;throw Vt.create("already-initialized")}return f.initialize({options:t})}function ee(l,t,f,m){l=ts(l),sh(Ds,Fe[l.app.options.appId],t,f,m).catch(v=>Yt.error(v))}const Nn="@firebase/analytics",zn="0.10.0";function gh(){ve(new le(Qe,(t,{options:f})=>{const m=t.getProvider("app").getImmediate(),v=t.getProvider("installations-internal").getImmediate();return uh(m,v,f)},"PUBLIC")),ve(new le("analytics-internal",l,"PRIVATE")),se(Nn,zn),se(Nn,zn,"esm2017");function l(t){try{const f=t.getProvider(Qe).getImmediate();return{logEvent:(m,v,b)=>ee(f,m,v,b)}}catch(f){throw Vt.create("interop-component-reg-failed",{reason:f})}}}gh();var mh="firebase",ph="9.22.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */se(mh,ph,"app");const vh={apiKey:"AIzaSyC4utIPO1vPQhCN9KWCZRR5PBUbxFV16Nk",authDomain:"dev-ku.firebaseapp.com",projectId:"dev-ku",storageBucket:"dev-ku.appspot.com",messagingSenderId:"956838118297",appId:"1:956838118297:web:369ff0b8a1c059095d8908",measurementId:"G-VDQY8X7BTY"},_h=rs(vh),ie=fh(_h);function yh(l){let t,f,m,v,b,y,h,e,c,o,n,r,i,a,u,s,d,g,p,_,C,w;function S(I){l[5](I)}let O={isA11yClosable:!1,label:"선택하기"};return l[0]!==void 0&&(O.hex=l[0]),e=new uo({props:O}),Ct.push(()=>Mt(e,"hex",S)),{c(){t=V("div"),f=V("h2"),f.textContent="배경을 꾸며보세요!",m=ot(),v=V("ul"),b=V("li"),y=V("h3"),y.textContent="배경색",h=ot(),bt(e.$$.fragment),o=ot(),n=V("li"),r=V("h3"),r.textContent="배경이미지",i=ot(),a=V("div"),u=V("button"),u.textContent="이미지",s=ot(),d=V("button"),d.textContent="제거",g=ot(),p=V("input"),k(f,"class","svelte-1sm4ylp"),k(y,"class","svelte-1sm4ylp"),k(b,"class","svelte-1sm4ylp"),k(r,"class","svelte-1sm4ylp"),k(u,"class","svelte-1sm4ylp"),k(d,"class","svelte-1sm4ylp"),k(a,"class","buttonWrapper svelte-1sm4ylp"),k(n,"class","svelte-1sm4ylp"),k(v,"class","svelte-1sm4ylp"),k(t,"class","container svelte-1sm4ylp"),k(p,"type","file"),k(p,"accept","image/*"),Dt(p,"display","none")},m(I,X){ht(I,t,X),j(t,f),j(t,m),j(t,v),j(v,b),j(b,y),j(b,h),_t(e,b,null),j(v,o),j(v,n),j(n,r),j(n,i),j(n,a),j(a,u),j(a,s),j(a,d),ht(I,g,X),ht(I,p,X),l[7](p),_=!0,C||(w=[rt(u,"click",l[6]),rt(d,"click",l[3]),rt(p,"change",l[2])],C=!0)},p(I,[X]){const Q={};!c&&X&1&&(c=!0,Q.hex=I[0],Xt(()=>c=!1)),e.$set(Q)},i(I){_||(dt(e.$$.fragment,I),_=!0)},o(I){gt(e.$$.fragment,I),_=!1},d(I){I&&lt(t),yt(e),I&&lt(g),I&&lt(p),l[7](null),C=!1,Pt(w)}}}function bh(l,t,f){let m,v;kt(l,Ut,n=>f(4,m=n)),kt(l,Ge,n=>f(0,v=n));let b;Ee(()=>{ee(ie,"배경 탭 진입")});const y=n=>{const r=n.currentTarget.files;if(!r)return;const i=r[0];if(!i)return;h();const a=URL.createObjectURL(i);oe.fabric.Image.fromURL(a,function(u){u.set("itemType","background"),m.setBackgroundImage(u,m.renderAll.bind(m),{scaleX:m.width/u.width,scaleY:m.height/u.height,selectable:!0})})},h=()=>{m.setBackgroundImage(null,m.renderAll.bind(m))};function e(n){v=n,Ge.set(v)}const c=()=>{b.click()};function o(n){Ct[n?"unshift":"push"](()=>{b=n,f(1,b)})}return l.$$.update=()=>{l.$$.dirty&17&&m&&m.setBackgroundColor(v,()=>{m.renderAll()})},[v,b,y,h,m,e,c,o]}class Ch extends At{constructor(t){super(),Et(this,t,bh,yh,xt,{})}}function wh(l){let t,f,m,v,b,y,h,e,c,o,n,r,i;return{c(){t=V("div"),f=V("h2"),f.textContent="사진을 추가해보세요!",m=ot(),v=V("div"),v.innerHTML=`<p>사진을 이동하고 크기를 조절해보세요.</p> 
    <p>삭제하고 싶은 사진은 선택 후 제거 버튼을 클릭하세요.</p>`,b=ot(),y=V("div"),h=V("button"),h.textContent="추가",e=ot(),c=V("button"),c.textContent="제거",o=ot(),n=V("input"),k(f,"class","svelte-x4lqyk"),k(v,"class","detail svelte-x4lqyk"),k(h,"class","svelte-x4lqyk"),k(c,"class","svelte-x4lqyk"),Lt(c,"hasActiveObject",l[1]),k(y,"class","photo-buttons svelte-x4lqyk"),k(n,"type","file"),k(n,"accept","image/*"),Dt(n,"display","none"),k(t,"class","container svelte-x4lqyk")},m(a,u){ht(a,t,u),j(t,f),j(t,m),j(t,v),j(t,b),j(t,y),j(y,h),j(y,e),j(y,c),j(t,o),j(t,n),l[7](n),r||(i=[rt(h,"click",l[6]),rt(c,"click",l[3]),rt(n,"change",l[2])],r=!0)},p(a,[u]){u&2&&Lt(c,"hasActiveObject",a[1])},i:vt,o:vt,d(a){a&&lt(t),l[7](null),r=!1,Pt(i)}}}function Sh(l,t,f){let m,v,b;kt(l,Ut,s=>f(4,m=s)),kt(l,ke,s=>f(10,v=s)),kt(l,Ge,s=>f(5,b=s));let y,h=0,e=null,c=!1;Ee(()=>{ee(ie,"사진 탭 진입"),m.on("selection:created",r),m.on("selection:cleared",i)}),ur(()=>{m.off("selection:created",r),m.off("selection:cleared",i)});const o=s=>{const d=s.currentTarget.files;if(!d)return;const g=d[0];if(!g)return;const p=URL.createObjectURL(g);h+=1,oe.fabric.Image.fromURL(p,function(_){_.set({left:h*10,top:h*10}),_.set("itemType","photo"),_.scaleToWidth(v/6),m.add(_),m.setActiveObject(_)}),m.renderAll()},n=()=>{const s=m.getActiveObjects();s&&(s.forEach(d=>{m.remove(d),h-=1}),f(1,c=!1)),m.discardActiveObject()},r=s=>{e=m.getActiveObjects(),f(1,c=e.length>0)},i=s=>{f(1,c=!1)},a=()=>{y.click()};function u(s){Ct[s?"unshift":"push"](()=>{y=s,f(0,y)})}return l.$$.update=()=>{l.$$.dirty&48&&m&&m.setBackgroundColor(b,()=>{m.renderAll()})},[y,c,o,n,m,b,a,u]}class Th extends At{constructor(t){super(),Et(this,t,Sh,wh,xt,{})}}function Hn(l,t,f){const m=l.slice();return m[12]=t[f],m}function Xn(l,t,f){const m=l.slice();return m[12]=t[f],m}function Yn(l,t,f){const m=l.slice();return m[12]=t[f],m}function Un(l,t,f){const m=l.slice();return m[12]=t[f],m}function Vn(l,t,f){const m=l.slice();return m[12]=t[f],m}function Gn(l){let t,f,m=xe[l[12]].title+"",v,b,y,h,e;return{c(){t=V("li"),f=V("button"),v=zt(m),y=ot(),k(f,"class",b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8"),k(t,"class","svelte-2zqww8")},m(c,o){ht(c,t,o),j(t,f),j(f,v),j(t,y),h||(e=rt(f,"click",l[1](l[12])),h=!0)},p(c,o){l=c,o&1&&b!==(b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8")&&k(f,"class",b)},d(c){c&&lt(t),h=!1,e()}}}function qn(l){let t,f,m=Oi[l[12]].title+"",v,b,y,h,e;return{c(){t=V("li"),f=V("button"),v=zt(m),y=ot(),k(f,"class",b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8"),k(t,"class","svelte-2zqww8")},m(c,o){ht(c,t,o),j(t,f),j(f,v),j(t,y),h||(e=rt(f,"click",l[1](l[12])),h=!0)},p(c,o){l=c,o&1&&b!==(b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8")&&k(f,"class",b)},d(c){c&&lt(t),h=!1,e()}}}function Kn(l){let t,f,m=ki[l[12]].title+"",v,b,y,h,e;return{c(){t=V("li"),f=V("button"),v=zt(m),y=ot(),k(f,"class",b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8"),k(t,"class","svelte-2zqww8")},m(c,o){ht(c,t,o),j(t,f),j(f,v),j(t,y),h||(e=rt(f,"click",l[1](l[12])),h=!0)},p(c,o){l=c,o&1&&b!==(b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8")&&k(f,"class",b)},d(c){c&&lt(t),h=!1,e()}}}function Jn(l){let t,f,m=Ei[l[12]].title+"",v,b,y,h,e;return{c(){t=V("li"),f=V("button"),v=zt(m),y=ot(),k(f,"class",b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8"),k(t,"class","svelte-2zqww8")},m(c,o){ht(c,t,o),j(t,f),j(f,v),j(t,y),h||(e=rt(f,"click",l[1](l[12])),h=!0)},p(c,o){l=c,o&1&&b!==(b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8")&&k(f,"class",b)},d(c){c&&lt(t),h=!1,e()}}}function Qn(l){let t,f,m=Ai[l[12]].title+"",v,b,y,h,e;return{c(){t=V("li"),f=V("button"),v=zt(m),y=ot(),k(f,"class",b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8"),k(t,"class","svelte-2zqww8")},m(c,o){ht(c,t,o),j(t,f),j(f,v),j(t,y),h||(e=rt(f,"click",l[1](l[12])),h=!0)},p(c,o){l=c,o&1&&b!==(b=jt(l[0][l[12]]?"active":"")+" svelte-2zqww8")&&k(f,"class",b)},d(c){c&&lt(t),h=!1,e()}}}function xh(l){let t,f,m,v,b,y,h,e,c,o,n,r,i,a,u,s,d,g,p,_,C,w,S,O,I,X,Q,tt,Y,U,et,st,ft,ut,T,A,P,D,z,E,x,M,L,K,H,Z,B,nt=Object.keys(xe),W=[];for(let F=0;F<nt.length;F+=1)W[F]=Gn(Vn(l,nt,F));let R=Object.keys(Oi),G=[];for(let F=0;F<R.length;F+=1)G[F]=qn(Un(l,R,F));let J=Object.keys(ki),N=[];for(let F=0;F<J.length;F+=1)N[F]=Kn(Yn(l,J,F));let $=Object.keys(Ei),it=[];for(let F=0;F<$.length;F+=1)it[F]=Jn(Xn(l,$,F));let mt=Object.keys(Ai),at=[];for(let F=0;F<mt.length;F+=1)at[F]=Qn(Hn(l,mt,F));return{c(){t=V("div"),f=V("h2"),f.textContent="아이템을 추가해 꾸며주세요!",m=ot(),v=V("div"),b=V("ul"),y=V("button"),y.textContent="전체",h=ot(),e=V("button"),e.textContent="머리",c=ot(),o=V("button"),o.textContent="얼굴",n=ot(),r=V("button"),r.textContent="몸",i=ot(),a=V("button"),a.textContent="손",u=ot(),s=V("ul"),d=V("div"),g=V("ul"),p=V("li"),_=V("button"),_.textContent="초기화 하기",C=ot();for(let F=0;F<W.length;F+=1)W[F].c();w=ot(),S=V("div"),O=V("ul"),I=V("li"),X=V("button"),X.textContent="초기화 하기",Q=ot();for(let F=0;F<G.length;F+=1)G[F].c();tt=ot(),Y=V("div"),U=V("ul"),et=V("li"),st=V("button"),st.textContent="초기화 하기",ft=ot();for(let F=0;F<N.length;F+=1)N[F].c();ut=ot(),T=V("div"),A=V("ul"),P=V("li"),D=V("button"),D.textContent="초기화 하기",z=ot();for(let F=0;F<it.length;F+=1)it[F].c();E=ot(),x=V("div"),M=V("ul"),L=V("li"),K=V("button"),K.textContent="초기화 하기",H=ot();for(let F=0;F<at.length;F+=1)at[F].c();k(f,"class","svelte-2zqww8"),k(y,"id","category_all_btn"),k(y,"class","category svelte-1j5f1kp svelte-2zqww8"),k(e,"id","category_head_btn"),k(e,"class","category svelte-1j5f1kp svelte-2zqww8"),k(o,"id","category_face_btn"),k(o,"class","category svelte-1j5f1kp svelte-2zqww8"),k(r,"id","category_body_btn"),k(r,"class","category svelte-1j5f1kp svelte-2zqww8"),k(a,"id","category_hand_btn"),k(a,"class","category svelte-1j5f1kp svelte-2zqww8"),k(b,"class","categories svelte-2zqww8"),k(_,"class","reset svelte-2zqww8"),k(p,"class","svelte-2zqww8"),k(g,"class","toolbar svelte-2zqww8"),k(d,"id","all"),Dt(d,"display","flex"),k(d,"class","svelte-2zqww8"),k(X,"class","reset svelte-2zqww8"),k(I,"class","svelte-2zqww8"),k(O,"class","toolbar svelte-2zqww8"),k(S,"id","head"),Dt(S,"display","flex"),Dt(S,"display","none"),k(S,"class","svelte-2zqww8"),k(st,"class","reset svelte-2zqww8"),k(et,"class","svelte-2zqww8"),k(U,"class","toolbar svelte-2zqww8"),k(Y,"id","face"),Dt(Y,"display","flex"),Dt(Y,"display","none"),k(Y,"class","svelte-2zqww8"),k(D,"class","reset svelte-2zqww8"),k(P,"class","svelte-2zqww8"),k(A,"class","toolbar svelte-2zqww8"),k(T,"id","body"),Dt(T,"display","flex"),Dt(T,"display","none"),k(T,"class","svelte-2zqww8"),k(K,"class","reset svelte-2zqww8"),k(L,"class","svelte-2zqww8"),k(M,"class","toolbar svelte-2zqww8"),k(x,"id","hand"),Dt(x,"display","flex"),Dt(x,"display","none"),k(x,"class","svelte-2zqww8"),k(s,"class","toolbar svelte-2zqww8"),k(v,"class","contents svelte-2zqww8"),k(t,"class","container svelte-2zqww8")},m(F,ct){ht(F,t,ct),j(t,f),j(t,m),j(t,v),j(v,b),j(b,y),j(b,h),j(b,e),j(b,c),j(b,o),j(b,n),j(b,r),j(b,i),j(b,a),j(v,u),j(v,s),j(s,d),j(d,g),j(g,p),j(p,_),j(g,C);for(let q=0;q<W.length;q+=1)W[q]&&W[q].m(g,null);j(s,w),j(s,S),j(S,O),j(O,I),j(I,X),j(O,Q);for(let q=0;q<G.length;q+=1)G[q]&&G[q].m(O,null);j(s,tt),j(s,Y),j(Y,U),j(U,et),j(et,st),j(U,ft);for(let q=0;q<N.length;q+=1)N[q]&&N[q].m(U,null);j(s,ut),j(s,T),j(T,A),j(A,P),j(P,D),j(A,z);for(let q=0;q<it.length;q+=1)it[q]&&it[q].m(A,null);j(s,E),j(s,x),j(x,M),j(M,L),j(L,K),j(M,H);for(let q=0;q<at.length;q+=1)at[q]&&at[q].m(M,null);Z||(B=[rt(y,"click",l[3]),rt(e,"click",l[4]),rt(o,"click",l[5]),rt(r,"click",l[6]),rt(a,"click",l[7]),rt(_,"click",l[2]),rt(X,"click",l[2]),rt(st,"click",l[2]),rt(D,"click",l[2]),rt(K,"click",l[2])],Z=!0)},p(F,[ct]){if(ct&3){nt=Object.keys(xe);let q;for(q=0;q<nt.length;q+=1){const pt=Vn(F,nt,q);W[q]?W[q].p(pt,ct):(W[q]=Gn(pt),W[q].c(),W[q].m(g,null))}for(;q<W.length;q+=1)W[q].d(1);W.length=nt.length}if(ct&3){R=Object.keys(Oi);let q;for(q=0;q<R.length;q+=1){const pt=Un(F,R,q);G[q]?G[q].p(pt,ct):(G[q]=qn(pt),G[q].c(),G[q].m(O,null))}for(;q<G.length;q+=1)G[q].d(1);G.length=R.length}if(ct&3){J=Object.keys(ki);let q;for(q=0;q<J.length;q+=1){const pt=Yn(F,J,q);N[q]?N[q].p(pt,ct):(N[q]=Kn(pt),N[q].c(),N[q].m(U,null))}for(;q<N.length;q+=1)N[q].d(1);N.length=J.length}if(ct&3){$=Object.keys(Ei);let q;for(q=0;q<$.length;q+=1){const pt=Xn(F,$,q);it[q]?it[q].p(pt,ct):(it[q]=Jn(pt),it[q].c(),it[q].m(A,null))}for(;q<it.length;q+=1)it[q].d(1);it.length=$.length}if(ct&3){mt=Object.keys(Ai);let q;for(q=0;q<mt.length;q+=1){const pt=Hn(F,mt,q);at[q]?at[q].p(pt,ct):(at[q]=Qn(pt),at[q].c(),at[q].m(M,null))}for(;q<at.length;q+=1)at[q].d(1);at.length=mt.length}},i:vt,o:vt,d(F){F&&lt(t),Jt(W,F),Jt(G,F),Jt(N,F),Jt(it,F),Jt(at,F),Z=!1,Pt(B)}}}function Oh(l,t,f){let m,v,b;kt(l,Yi,u=>f(0,m=u)),kt(l,Ut,u=>f(8,v=u)),kt(l,ke,u=>f(9,b=u)),Ee(()=>{ee(ie,"꾸미기 탭 진입")});const y=u=>{let s=xe[u].src;ee(ie,`${xe[u].title} 추가`),oe.fabric.Image.fromURL(s,function(d){d.scaleToWidth(b),d.scaleToWidth(b),d.selectable=!1,d.set("itemType","costume"),d.set("costume",u),v.add(d),v.getObjects().forEach(g=>{(g.costume==="basketball"||g.costume==="laptop")&&v.moveTo(g,100)}),v.renderAll()})},h=u=>{const s=v.getObjects();ee(ie,`${xe[u].title} 제거`),s.filter(g=>g.costume===u).forEach(g=>v.remove(g))},e=u=>()=>{go(u)},c=()=>{ee(ie,"초기화 버튼 클릭"),mo()},o=()=>{const u=document.getElementById("all"),s=document.getElementById("head"),d=document.getElementById("face"),g=document.getElementById("body"),p=document.getElementById("hand"),_=document.getElementById("category_all_btn"),C=document.getElementById("category_head_btn"),w=document.getElementById("category_face_btn"),S=document.getElementById("category_body_btn"),O=document.getElementById("category_hand_btn");_.style.backgroundColor="#7ea338",C.style.backgroundColor="white",w.style.backgroundColor="white",S.style.backgroundColor="white",O.style.backgroundColor="white",u.style.display="block",s.style.display="none",d.style.display="none",g.style.display="none",p.style.display="none"},n=()=>{const u=document.getElementById("all"),s=document.getElementById("head"),d=document.getElementById("face"),g=document.getElementById("body"),p=document.getElementById("hand"),_=document.getElementById("category_all_btn"),C=document.getElementById("category_head_btn"),w=document.getElementById("category_face_btn"),S=document.getElementById("category_body_btn"),O=document.getElementById("category_hand_btn");_.style.backgroundColor="white",C.style.backgroundColor="#7ea338",w.style.backgroundColor="white",S.style.backgroundColor="white",O.style.backgroundColor="white",u.style.display="none",s.style.display="block",d.style.display="none",g.style.display="none",p.style.display="none"},r=()=>{const u=document.getElementById("all"),s=document.getElementById("head"),d=document.getElementById("face"),g=document.getElementById("body"),p=document.getElementById("hand"),_=document.getElementById("category_all_btn"),C=document.getElementById("category_head_btn"),w=document.getElementById("category_face_btn"),S=document.getElementById("category_body_btn"),O=document.getElementById("category_hand_btn");_.style.backgroundColor="white",C.style.backgroundColor="white",w.style.backgroundColor="#7ea338",S.style.backgroundColor="white",O.style.backgroundColor="white",u.style.display="none",s.style.display="none",d.style.display="block",g.style.display="none",p.style.display="none"},i=()=>{const u=document.getElementById("all"),s=document.getElementById("head"),d=document.getElementById("face"),g=document.getElementById("body"),p=document.getElementById("hand"),_=document.getElementById("category_all_btn"),C=document.getElementById("category_head_btn"),w=document.getElementById("category_face_btn"),S=document.getElementById("category_body_btn"),O=document.getElementById("category_hand_btn");_.style.backgroundColor="white",C.style.backgroundColor="white",w.style.backgroundColor="white",S.style.backgroundColor="#7ea338",O.style.backgroundColor="white",u.style.display="none",s.style.display="none",d.style.display="none",g.style.display="block",p.style.display="none"},a=()=>{const u=document.getElementById("all"),s=document.getElementById("head"),d=document.getElementById("face"),g=document.getElementById("body"),p=document.getElementById("hand"),_=document.getElementById("category_all_btn"),C=document.getElementById("category_head_btn"),w=document.getElementById("category_face_btn"),S=document.getElementById("category_body_btn"),O=document.getElementById("category_hand_btn");_.style.backgroundColor="white",C.style.backgroundColor="white",w.style.backgroundColor="white",S.style.backgroundColor="white",O.style.backgroundColor="#7ea338",u.style.display="none",s.style.display="none",d.style.display="none",g.style.display="none",p.style.display="block"};return l.$$.update=()=>{if(l.$$.dirty&257&&v){const u=v.getObjects();for(const s in m){const d=u.find(g=>g.costume===s);d&&!m[s]&&h(s),!d&&m[s]&&y(s)}}},[m,e,c,o,n,r,i,a,v]}class kh extends At{constructor(t){super(),Et(this,t,Oh,xh,xt,{})}}const Eh="/assets/close-7faef788.svg";const Ah=l=>({}),Zn=l=>({});function Dh(l){let t,f,m,v,b,y,h,e,c,o;const n=l[3].header,r=Re(n,l,l[2],Zn),i=l[3].default,a=Re(i,l,l[2],null);return{c(){t=V("dialog"),f=V("div"),r&&r.c(),m=ot(),a&&a.c(),v=ot(),b=V("button"),y=V("img"),Be(y.src,h=Eh)||k(y,"src",h),k(y,"aria-hidden",""),k(y,"alt","닫기"),k(b,"class","close svelte-ckxgtn"),b.autofocus=!0,k(b,"aria-label","닫기"),k(f,"class","svelte-ckxgtn"),k(t,"class","svelte-ckxgtn")},m(u,s){ht(u,t,s),j(t,f),r&&r.m(f,null),j(f,m),a&&a.m(f,null),j(f,v),j(f,b),j(b,y),l[6](t),e=!0,b.focus(),c||(o=[rt(b,"click",l[5]),rt(f,"click",me(l[4])),rt(t,"close",l[7]),rt(t,"click",Ls(l[8]))],c=!0)},p(u,[s]){r&&r.p&&(!e||s&4)&&je(r,n,u,u[2],e?Le(n,u[2],s,Ah):We(u[2]),Zn),a&&a.p&&(!e||s&4)&&je(a,i,u,u[2],e?Le(i,u[2],s,null):We(u[2]),null)},i(u){e||(dt(r,u),dt(a,u),e=!0)},o(u){gt(r,u),gt(a,u),e=!1},d(u){u&&lt(t),r&&r.d(u),a&&a.d(u),l[6](null),c=!1,Pt(o)}}}function Ph(l,t,f){let{$$slots:m={},$$scope:v}=t,{showModal:b}=t,y;function h(r){zs.call(this,l,r)}const e=()=>y.close();function c(r){Ct[r?"unshift":"push"](()=>{y=r,f(1,y)})}const o=()=>f(0,b=!1),n=()=>y.close();return l.$$set=r=>{"showModal"in r&&f(0,b=r.showModal),"$$scope"in r&&f(2,v=r.$$scope)},l.$$.update=()=>{l.$$.dirty&3&&y&&b&&y.showModal()},[b,y,v,m,h,e,c,o,n]}class Ih extends At{constructor(t){super(),Et(this,t,Ph,Dh,xt,{showModal:0})}}function Mh(l){let t,f,m,v,b,y;return{c(){t=V("img"),m=ot(),v=V("button"),v.textContent="저장하기",Be(t.src,f=l[1])||k(t,"src",f),k(t,"alt","데브진스"),k(v,"class","save svelte-1cdxw3x")},m(h,e){ht(h,t,e),ht(h,m,e),ht(h,v,e),b||(y=rt(v,"click",l[3]),b=!0)},p(h,e){e&2&&!Be(t.src,f=h[1])&&k(t,"src",f)},d(h){h&&lt(t),h&&lt(m),h&&lt(v),b=!1,y()}}}function Fh(l){let t;return{c(){t=V("h2"),t.textContent="짜잔~ 완성된 이미지에요.",k(t,"slot","header"),k(t,"class","svelte-1cdxw3x")},m(f,m){ht(f,t,m)},p:vt,d(f){f&&lt(t)}}}function Bh(l){let t,f,m,v,b,y,h,e,c,o;function n(i){l[4](i)}let r={$$slots:{header:[Fh],default:[Mh]},$$scope:{ctx:l}};return l[0]!==void 0&&(r.showModal=l[0]),t=new Ih({props:r}),Ct.push(()=>Mt(t,"showModal",n)),{c(){bt(t.$$.fragment),m=ot(),v=V("div"),b=V("h2"),b.textContent="최종 결과물이 맘에 드시나요?",y=ot(),h=V("button"),h.textContent="만족해요!",k(b,"class","svelte-1cdxw3x"),k(h,"class","svelte-1cdxw3x"),k(v,"class","container svelte-1cdxw3x")},m(i,a){_t(t,i,a),ht(i,m,a),ht(i,v,a),j(v,b),j(v,y),j(v,h),e=!0,c||(o=rt(h,"click",l[2]),c=!0)},p(i,[a]){const u={};a&130&&(u.$$scope={dirty:a,ctx:i}),!f&&a&1&&(f=!0,u.showModal=i[0],Xt(()=>f=!1)),t.$set(u)},i(i){e||(dt(t.$$.fragment,i),e=!0)},o(i){gt(t.$$.fragment,i),e=!1},d(i){yt(t,i),i&&lt(m),i&&lt(v),c=!1,o()}}}function Rh(l,t,f){let m,v;kt(l,Ut,o=>f(5,m=o)),kt(l,ke,o=>f(6,v=o));let b=!1,y="";Ee(()=>{ee(ie,"저장 탭 진입")});const h=()=>{oe.fabric.Image.fromURL(null,function(o){o.scaleToWidth(v),o.scaleToWidth(v),o.selectable=!1,m.add(o),m.renderAll(),f(1,y=m.toDataURL({format:"png",quality:1,multiplier:4})),m.remove(o),f(0,b=!0)})},e=()=>{const o=document.createElement("a");o.download="dev-ku.png",o.href=y,o.click()};function c(o){b=o,f(0,b)}return[b,y,h,e,c]}class Lh extends At{constructor(t){super(),Et(this,t,Rh,Bh,xt,{})}}const ji=ce(fe.Decorate);function $n(l,t,f){const m=l.slice();return m[3]=t[f],m}function tr(l,t,f){const m=l.slice();return m[3]=t[f],m}function er(l){let t,f,m=l[3].label+"",v,b,y,h,e;return{c(){t=V("li"),f=V("button"),v=zt(m),b=ot(),k(f,"type","button"),k(f,"class","svelte-bzko04"),k(t,"class",y=jt(l[1]===l[3].value?"active":"")+" svelte-bzko04")},m(c,o){ht(c,t,o),j(t,f),j(f,v),j(t,b),h||(e=rt(f,"click",function(){Ze(l[2](l[3].value))&&l[2](l[3].value).apply(this,arguments)}),h=!0)},p(c,o){l=c,o&1&&m!==(m=l[3].label+"")&&Oe(v,m),o&3&&y!==(y=jt(l[1]===l[3].value?"active":"")+" svelte-bzko04")&&k(t,"class",y)},d(c){c&&lt(t),h=!1,e()}}}function ir(l){let t,f,m,v;var b=l[3].component;function y(h){return{}}return b&&(f=St(b,y())),{c(){t=V("div"),f&&bt(f.$$.fragment),m=ot(),k(t,"class","box svelte-bzko04")},m(h,e){ht(h,t,e),f&&_t(f,t,null),j(t,m),v=!0},p(h,e){if(e&1&&b!==(b=h[3].component)){if(f){Ft();const c=f;gt(c.$$.fragment,1,0,()=>{yt(c,1)}),Bt()}b?(f=St(b,y()),bt(f.$$.fragment),dt(f.$$.fragment,1),_t(f,t,m)):f=null}},i(h){v||(f&&dt(f.$$.fragment,h),v=!0)},o(h){f&&gt(f.$$.fragment,h),v=!1},d(h){h&&lt(t),f&&yt(f)}}}function nr(l){let t,f,m=l[1]==l[3].value&&ir(l);return{c(){m&&m.c(),t=Zt()},m(v,b){m&&m.m(v,b),ht(v,t,b),f=!0},p(v,b){v[1]==v[3].value?m?(m.p(v,b),b&3&&dt(m,1)):(m=ir(v),m.c(),dt(m,1),m.m(t.parentNode,t)):m&&(Ft(),gt(m,1,1,()=>{m=null}),Bt())},i(v){f||(dt(m),f=!0)},o(v){gt(m),f=!1},d(v){m&&m.d(v),v&&lt(t)}}}function jh(l){let t,f,m,v,b=l[0],y=[];for(let o=0;o<b.length;o+=1)y[o]=er(tr(l,b,o));let h=l[0],e=[];for(let o=0;o<h.length;o+=1)e[o]=nr($n(l,h,o));const c=o=>gt(e[o],1,1,()=>{e[o]=null});return{c(){t=V("ul");for(let o=0;o<y.length;o+=1)y[o].c();f=ot();for(let o=0;o<e.length;o+=1)e[o].c();m=Zt(),k(t,"class","taps svelte-bzko04")},m(o,n){ht(o,t,n);for(let r=0;r<y.length;r+=1)y[r]&&y[r].m(t,null);ht(o,f,n);for(let r=0;r<e.length;r+=1)e[r]&&e[r].m(o,n);ht(o,m,n),v=!0},p(o,[n]){if(n&7){b=o[0];let r;for(r=0;r<b.length;r+=1){const i=tr(o,b,r);y[r]?y[r].p(i,n):(y[r]=er(i),y[r].c(),y[r].m(t,null))}for(;r<y.length;r+=1)y[r].d(1);y.length=b.length}if(n&3){h=o[0];let r;for(r=0;r<h.length;r+=1){const i=$n(o,h,r);e[r]?(e[r].p(i,n),dt(e[r],1)):(e[r]=nr(i),e[r].c(),dt(e[r],1),e[r].m(m.parentNode,m))}for(Ft(),r=h.length;r<e.length;r+=1)c(r);Bt()}},i(o){if(!v){for(let n=0;n<h.length;n+=1)dt(e[n]);v=!0}},o(o){e=e.filter(Boolean);for(let n=0;n<e.length;n+=1)gt(e[n]);v=!1},d(o){o&&lt(t),Jt(y,o),o&&lt(f),Jt(e,o),o&&lt(m)}}}function Wh(l,t,f){let m;kt(l,ji,y=>f(1,m=y));let{items:v=[]}=t;const b=y=>()=>Ht(ji,m=y,m);return l.$$set=y=>{"items"in y&&f(0,v=y.items)},[v,m,b]}class Nh extends At{constructor(t){super(),Et(this,t,Wh,jh,xt,{items:0})}}const Ps={isDrawingMode:!0,color:xi[0],width:5},qt=ce(Ps),zh=()=>qt.set(Ps),Hh=()=>{const l=Pe(Ut);qt.set({...Pe(qt),isDrawingMode:!0}),l.freeDrawingBrush=new oe.fabric.PencilBrush(l),l.freeDrawingBrush.color=Pe(qt).color,l.freeDrawingBrush.width=Pe(qt).width},Xh=()=>{const l=Pe(Ut);l.isDrawingMode=!1,zh()},Yh="/assets/selection-8a4a36ee.svg",Uh="/assets/eraser-4d1d20f1.svg";function rr(l,t,f){const m=l.slice();return m[7]=t[f],m}function sr(l,t,f){const m=l.slice();return m[10]=t[f],m[12]=f,m}function ar(l){let t,f,m,v=l[10]+"",b,y,h,e,c;function o(){return l[5](l[10])}return{c(){t=V("li"),f=V("button"),m=V("div"),b=zt(v),y=ot(),k(m,"class","pen-width svelte-1sbusi2"),k(m,"style",`
                  width: ${10+(l[12]+1)*8}px; 
                  height: ${10+(l[12]+1)*8}px; 
                  `),k(f,"class","svelte-1sbusi2"),k(t,"class",h=jt(l[0].isDrawingMode&&l[0].width===l[10]?"active round-border":"")+" svelte-1sbusi2")},m(n,r){ht(n,t,r),j(t,f),j(f,m),j(m,b),j(t,y),e||(c=rt(f,"click",o),e=!0)},p(n,r){l=n,r&1&&h!==(h=jt(l[0].isDrawingMode&&l[0].width===l[10]?"active round-border":"")+" svelte-1sbusi2")&&k(t,"class",h)},d(n){n&&lt(t),e=!1,c()}}}function or(l){let t,f,m,v,b,y,h;function e(){return l[6](l[7])}return{c(){t=V("li"),f=V("button"),m=V("div"),v=ot(),k(m,"class","pen-color svelte-1sbusi2"),k(m,"style",`background-color:${l[7]}`),k(f,"class","svelte-1sbusi2"),k(t,"class",b=jt(`pen-color-wrapper ${l[0].isDrawingMode&&l[7]===l[0].color?"active round-border":""} `)+" svelte-1sbusi2")},m(c,o){ht(c,t,o),j(t,f),j(f,m),j(t,v),y||(h=rt(f,"click",e),y=!0)},p(c,o){l=c,o&1&&b!==(b=jt(`pen-color-wrapper ${l[0].isDrawingMode&&l[7]===l[0].color?"active round-border":""} `)+" svelte-1sbusi2")&&k(t,"class",b)},d(c){c&&lt(t),y=!1,h()}}}function Vh(l){let t,f,m,v,b,y,h,e,c,o,n,r,i,a,u,s,d,g,p,_,C,w,S,O=l[2],I=[];for(let tt=0;tt<O.length;tt+=1)I[tt]=ar(sr(l,O,tt));let X=xi,Q=[];for(let tt=0;tt<X.length;tt+=1)Q[tt]=or(rr(l,X,tt));return{c(){t=V("div"),f=V("div"),f.innerHTML=`<h2 class="svelte-1sbusi2">그림을 그려보세요!</h2> 
    <span>펜 색상을 선택해서 그려보세요.</span> 
    <span>지우고 싶은것을 선택후 지우개를 클릭하면 지워집니다.</span>`,m=ot(),v=V("div"),b=V("div"),y=V("div"),h=V("ul"),e=V("li"),c=V("button"),o=V("img"),i=ot(),a=V("li"),u=V("button"),s=V("img"),g=ot();for(let tt=0;tt<I.length;tt+=1)I[tt].c();p=ot(),_=V("div"),C=V("ul");for(let tt=0;tt<Q.length;tt+=1)Q[tt].c();k(f,"class","header svelte-1sbusi2"),Be(o.src,n=Yh)||k(o,"src",n),k(o,"aria-hidden",""),k(o,"alt","선택"),k(o,"width","30"),k(c,"class",r=jt(l[0].isDrawingMode?"":"active")+" svelte-1sbusi2"),k(c,"aria-label","선택 모드"),k(e,"class","svelte-1sbusi2"),Be(s.src,d=Uh)||k(s,"src",d),k(s,"aria-hidden",""),k(s,"alt","삭제"),k(s,"width","25"),k(u,"aria-label","삭제"),k(u,"class","svelte-1sbusi2"),k(a,"class","svelte-1sbusi2"),k(h,"class","option-wrapper svelte-1sbusi2"),k(b,"class","option-container svelte-1sbusi2"),k(C,"class","option-wrapper svelte-1sbusi2"),k(_,"class","pen-container svelte-1sbusi2"),k(v,"class","sub-container svelte-1sbusi2"),k(t,"class","container svelte-1sbusi2")},m(tt,Y){ht(tt,t,Y),j(t,f),j(t,m),j(t,v),j(v,b),j(b,y),j(y,h),j(h,e),j(e,c),j(c,o),j(h,i),j(h,a),j(a,u),j(u,s),j(h,g);for(let U=0;U<I.length;U+=1)I[U]&&I[U].m(h,null);j(v,p),j(v,_),j(_,C);for(let U=0;U<Q.length;U+=1)Q[U]&&Q[U].m(C,null);w||(S=[rt(c,"click",l[3]),rt(u,"click",l[4])],w=!0)},p(tt,[Y]){if(Y&1&&r!==(r=jt(tt[0].isDrawingMode?"":"active")+" svelte-1sbusi2")&&k(c,"class",r),Y&5){O=tt[2];let U;for(U=0;U<O.length;U+=1){const et=sr(tt,O,U);I[U]?I[U].p(et,Y):(I[U]=ar(et),I[U].c(),I[U].m(h,null))}for(;U<I.length;U+=1)I[U].d(1);I.length=O.length}if(Y&1){X=xi;let U;for(U=0;U<X.length;U+=1){const et=rr(tt,X,U);Q[U]?Q[U].p(et,Y):(Q[U]=or(et),Q[U].c(),Q[U].m(C,null))}for(;U<Q.length;U+=1)Q[U].d(1);Q.length=X.length}},i:vt,o:vt,d(tt){tt&&lt(t),Jt(I,tt),Jt(Q,tt),w=!1,Pt(S)}}}function Gh(l,t,f){let m,v;kt(l,qt,o=>f(0,m=o)),kt(l,Ut,o=>f(1,v=o));const b=[5,11,17];Ee(()=>{ee(ie,"그리기 탭 진입"),Hh()}),ur(()=>{Ht(Ut,v.isDrawingMode=!1,v),Xh()});const y=()=>Ht(qt,m.isDrawingMode=!1,m),h=()=>{v.getActiveObjects().forEach(o=>{(!o.itemType||o.itemType==="photo")&&v.remove(o)}),v.discardActiveObject()},e=o=>{Ht(qt,m.isDrawingMode=!0,m),Ht(qt,m.width=o,m)},c=o=>{Ht(qt,m.isDrawingMode=!0,m),Ht(qt,m.color=o,m)};return l.$$.update=()=>{l.$$.dirty&1&&m&&(Ht(Ut,v.freeDrawingBrush.color=m.color,v),Ht(Ut,v.freeDrawingBrush.width=m.width,v),Ht(Ut,v.isDrawingMode=m.isDrawingMode,v))},[m,v,b,y,h,e,c]}class qh extends At{constructor(t){super(),Et(this,t,Gh,Vh,xt,{})}}function Kh(l){let t,f,m;return f=new Nh({props:{items:l[0]}}),{c(){t=V("div"),bt(f.$$.fragment),k(t,"class","container svelte-14gkii")},m(v,b){ht(v,t,b),_t(f,t,null),m=!0},p:vt,i(v){m||(dt(f.$$.fragment,v),m=!0)},o(v){gt(f.$$.fragment,v),m=!1},d(v){v&&lt(t),yt(f)}}}function Jh(l){return[[{label:"꾸미기",value:fe.Decorate,component:kh},{label:"배경",value:fe.Background,component:Ch},{label:"사진",value:fe.Photo,component:Th},{label:"드로잉",value:fe.Drawing,component:qh},{label:"저장",value:fe.Save,component:Lh}]]}class Qh extends At{constructor(t){super(),Et(this,t,Jh,Kh,xt,{})}}function lr(l){let t;return{c(){t=V("a"),t.innerHTML='<img alt="Hits" src="https://hits.sh/devjeans.dev-hee.com.svg?view=today-total&amp;style=for-the-badge&amp;color=f1c164&amp;labelColor=284d8e"/>',k(t,"href","https://hits.sh/devjeans.dev-hee.com/"),k(t,"class","svelte-15k31bi")},m(f,m){ht(f,t,m)},d(f){f&&lt(t)}}}function Zh(l){let t,f,m,v,b,y,h,e,c,o,n,r;y=new Qh({});let i=!l[0]&&lr();return{c(){t=V("main"),f=V("h1"),f.textContent="~데브쿠 짤 만들어 쓰기~",m=ot(),v=V("canvas"),b=ot(),bt(y.$$.fragment),h=ot(),e=V("footer"),c=V("span"),c.innerHTML='Instagram: <a href="https://www.instagram.com/그치만해냈조/" class="svelte-15k31bi">@그치만해냈조</a>',o=ot(),i&&i.c(),k(f,"class","svelte-15k31bi"),k(v,"id","canvas"),k(v,"width","2400"),k(v,"height","2400"),Dt(v,"border","1px solid #ccc"),k(t,"style",`width: ${ke}`),k(t,"class","svelte-15k31bi"),k(e,"style",n=`width: ${l[1]}`),k(e,"class","svelte-15k31bi")},m(a,u){ht(a,t,u),j(t,f),j(t,m),j(t,v),ht(a,b,u),_t(y,a,u),ht(a,h,u),ht(a,e,u),j(e,c),j(e,o),i&&i.m(e,null),r=!0},p(a,[u]){a[0]?i&&(i.d(1),i=null):i||(i=lr(),i.c(),i.m(e,null)),(!r||u&2&&n!==(n=`width: ${a[1]}`))&&k(e,"style",n)},i(a){r||(dt(y.$$.fragment,a),r=!0)},o(a){gt(y.$$.fragment,a),r=!1},d(a){a&&lt(t),a&&lt(b),yt(y,a),a&&lt(h),a&&lt(e),i&&i.d()}}}function $h(l,t,f){let m,v,b,y,h;kt(l,Ut,o=>f(2,v=o)),kt(l,ji,o=>f(3,b=o)),kt(l,Ge,o=>f(4,y=o)),kt(l,ke,o=>f(1,h=o));const e=()=>window.innerWidth<600?window.innerWidth:600;return Ee(()=>{Ht(Ut,v=new oe.fabric.Canvas("canvas"),v),Ht(ke,h=e(),h),v.setWidth(h*v.getZoom()),v.setHeight(h*v.getZoom()),oe.fabric.Image.fromURL(Gs,function(o){o.scaleToWidth(h),o.scaleToWidth(h),o.selectable=!1,o.set("itemType","bunny"),v.add(o),v.renderAll()},{crossOrigin:"anonymous"})}),l.$$.update=()=>{if(l.$$.dirty&20&&v&&v.setBackgroundColor(y,()=>{v.renderAll()}),l.$$.dirty&12&&v&&b){const o=v.getObjects();v.discardActiveObject(),b===fe.Background?o.filter(r=>r.itemType!=="background").forEach(r=>{r.opacity=.5}):o.filter(r=>r.itemType!=="background").forEach(r=>{r.opacity=1}),v.renderAll()}},f(0,m=window.location.hostname==="localhost"),[m,h,v,b,y]}class tu extends At{constructor(t){super(),Et(this,t,$h,Zh,xt,{})}}new tu({target:document.getElementById("app")});
